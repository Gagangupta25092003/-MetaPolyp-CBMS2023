Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 stem_ (ZeroPadding2D)          (None, 260, 260, 3)  0           ['input_1[0][0]']                
                                                                                                  
 stem_conv (Conv2D)             (None, 64, 64, 64)   9472        ['stem_[0][0]']                  
                                                                                                  
 stem_ln (LayerNormalization)   (None, 64, 64, 64)   64          ['stem_conv[0][0]']              
                                                                                                  
 stack1_block1_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stem_ln[0][0]']                
 rmalization)                                                                                     
                                                                                                  
 stack1_block1_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu (TFOpLambda)        (None, 64, 64, 128)  0           ['stack1_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow (TFOpLambda)       (None, 64, 64, 128)  0           ['tf.nn.relu[0][0]']             
                                                                                                  
 stack1_block1_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow[0][0]']            
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block1_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block1_attn_output (Add  (None, 64, 64, 64)  0           ['stem_ln[0][0]',                
 )                                                                'stack1_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack1_block1_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block1_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_1 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_1 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_1[0][0]']           
                                                                                                  
 stack1_block1_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_1[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block1_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block1_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block2_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block2_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_2 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_2 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_2[0][0]']           
                                                                                                  
 stack1_block2_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_2[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block2_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block2_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block1_mlp_output[0][0]'
 )                                                               , 'stack1_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block2_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block2_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_3 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_3 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_3[0][0]']           
                                                                                                  
 stack1_block2_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_3[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block2_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block2_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block3_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block3_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_4 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_4 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_4[0][0]']           
                                                                                                  
 stack1_block3_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_4[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block3_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block3_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block2_mlp_output[0][0]'
 )                                                               , 'stack1_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block3_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block3_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_5 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_5 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_5[0][0]']           
                                                                                                  
 stack1_block3_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_5[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block3_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block3_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_downsample_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack2_downsample_pad (ZeroPad  (None, 66, 66, 64)  0           ['stack2_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack2_downsample_conv (Conv2D  (None, 32, 32, 128)  73856      ['stack2_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack2_block1_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack2_block1_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_6 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_6 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_6[0][0]']           
                                                                                                  
 stack2_block1_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_6[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block1_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block1_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_downsample_conv[0][0]', 
 )                                                                'stack2_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack2_block1_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block1_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_7 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_7 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_7[0][0]']           
                                                                                                  
 stack2_block1_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_7[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block1_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block1_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block2_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block2_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_8 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_8 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_8[0][0]']           
                                                                                                  
 stack2_block2_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_8[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block2_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block2_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block1_mlp_output[0][0]'
 )                                                               , 'stack2_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block2_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block2_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_9 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_9 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_9[0][0]']           
                                                                                                  
 stack2_block2_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_9[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block2_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block2_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block3_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block3_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_10 (TFOpLambda)     (None, 32, 32, 256)  0           ['stack2_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_10 (TFOpLambda)    (None, 32, 32, 256)  0           ['tf.nn.relu_10[0][0]']          
                                                                                                  
 stack2_block3_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_10[0][0]']         
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block3_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block3_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block2_mlp_output[0][0]'
 )                                                               , 'stack2_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block3_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block3_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_11 (TFOpLambda)     (None, 32, 32, 512)  0           ['stack2_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_11 (TFOpLambda)    (None, 32, 32, 512)  0           ['tf.nn.relu_11[0][0]']          
                                                                                                  
 stack2_block3_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_11[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block3_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block3_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_downsample_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack3_downsample_pad (ZeroPad  (None, 34, 34, 128)  0          ['stack3_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack3_downsample_conv (Conv2D  (None, 16, 16, 320)  368960     ['stack3_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack3_block1_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack3_block1_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 256, 960)     0           ['stack3_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split (TFOpLambda)          [(None, 256, 320),   0           ['tf.reshape[0][0]']             
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][0]']               
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][1]']               
                                                                                                  
 tf.compat.v1.transpose (TFOpLa  (None, 10, 256, 32)  0          ['tf.reshape_1[0][0]']           
 mbda)                                                                                            
                                                                                                  
 tf.compat.v1.transpose_1 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_2[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda (Lambda)                (None, 10, 256, 256  0           ['tf.compat.v1.transpose[0][0]', 
                                )                                 'tf.compat.v1.transpose_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 10, 256, 256  0           ['lambda[0][0]']                 
                                )                                                                 
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][2]']               
                                                                                                  
 stack3_block1_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply[0][0]']       
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_2 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_1 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_2[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_3 (TFOp  (None, 256, 10, 32)  0          ['lambda_1[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_3[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block1_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack3_block1_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_4[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block1_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block1_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block1_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block1_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_12 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block1_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_12 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_12[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block1_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_12[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block1_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block1_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block1_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block2_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 256, 960)     0           ['stack3_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_1 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_5[0][0]']           
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][0]']             
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_4 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_6[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_5 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_7[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_2 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_4[0][0]'
                                )                                , 'tf.compat.v1.transpose_5[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_2[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][2]']             
                                                                                                  
 stack3_block2_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_1[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_6 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_8[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_3 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_6[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_7 (TFOp  (None, 256, 10, 32)  0          ['lambda_3[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_7[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block2_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block2_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_9[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block2_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block2_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block2_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_13 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block2_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_13 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_13[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block2_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_13[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block2_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block2_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block2_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block3_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_2 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_10[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][0]']             
                                                                                                  
 tf.reshape_12 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_8 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_11[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_9 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_12[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 lambda_4 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_8[0][0]'
                                )                                , 'tf.compat.v1.transpose_9[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_4[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_13 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][2]']             
                                                                                                  
 stack3_block3_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_2[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_10 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_13[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_5 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_10[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_11 (TFO  (None, 256, 10, 32)  0          ['lambda_5[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_14 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_11[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block3_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_14[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block3_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block3_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block3_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_14 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block3_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_14 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_14[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block3_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_14[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block3_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block3_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block3_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block3_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block4_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block4_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_15 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block4_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_3 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_15[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_16 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][0]']             
                                                                                                  
 tf.reshape_17 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_12 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_16[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_13 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_17[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_6 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_12[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_13[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_3 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_6[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_18 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][2]']             
                                                                                                  
 stack3_block4_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_3[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_14 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_18[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_7 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block4_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_14[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_15 (TFO  (None, 256, 10, 32)  0          ['lambda_7[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_19 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_15[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block4_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_19[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block4_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block4_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block4_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block4_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block4_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_15 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block4_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_15 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_15[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block4_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_15[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block4_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block4_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block4_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block4_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block4_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block4_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block5_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block5_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_20 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block5_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_4 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_20[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_21 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][0]']             
                                                                                                  
 tf.reshape_22 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_16 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_21[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_17 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_22[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_8 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_16[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_17[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_4 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_8[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_23 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][2]']             
                                                                                                  
 stack3_block5_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_4[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_18 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_23[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_9 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block5_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_18[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_19 (TFO  (None, 256, 10, 32)  0          ['lambda_9[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_24 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_19[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block5_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_24[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block5_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block5_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block5_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block5_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block5_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_16 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block5_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_16 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_16[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block5_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_16[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block5_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block5_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block5_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block5_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block5_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block5_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block6_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block6_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_25 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block6_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_5 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_25[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_26 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][0]']             
                                                                                                  
 tf.reshape_27 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_20 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_26[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_21 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_27[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_10 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_20[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_21[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_5 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_10[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_28 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][2]']             
                                                                                                  
 stack3_block6_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_5[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_22 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_28[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_11 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block6_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_22[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_23 (TFO  (None, 256, 10, 32)  0          ['lambda_11[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_29 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_23[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block6_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_29[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block6_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block6_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block6_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block6_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block6_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_17 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block6_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_17 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_17[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block6_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_17[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block6_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block6_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block6_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block6_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block6_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block6_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block7_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block7_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_30 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block7_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_6 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_30[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_31 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][0]']             
                                                                                                  
 tf.reshape_32 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_24 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_31[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_25 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_32[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_12 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_24[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_25[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_6 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_12[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_33 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][2]']             
                                                                                                  
 stack3_block7_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_6[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_26 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_33[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_13 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block7_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_26[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_27 (TFO  (None, 256, 10, 32)  0          ['lambda_13[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_34 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_27[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block7_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_34[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block7_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block7_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block7_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block7_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block7_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_18 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block7_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_18 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_18[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block7_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_18[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block7_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block7_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block7_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block7_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block7_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block7_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block8_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block8_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_35 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block8_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_7 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_35[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_36 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][0]']             
                                                                                                  
 tf.reshape_37 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_28 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_36[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_29 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_37[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_14 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_28[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_29[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_7 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_14[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_38 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][2]']             
                                                                                                  
 stack3_block8_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_7[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_30 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_38[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_15 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block8_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_30[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_31 (TFO  (None, 256, 10, 32)  0          ['lambda_15[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_39 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_31[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block8_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_39[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block8_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block8_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block8_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block8_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block8_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_19 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block8_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_19 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_19[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block8_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_19[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block8_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block8_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block8_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block8_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block8_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block8_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block9_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block9_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_40 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block9_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_8 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_40[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_41 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][0]']             
                                                                                                  
 tf.reshape_42 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_32 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_41[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_33 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_42[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_16 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_32[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_33[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_16[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_43 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][2]']             
                                                                                                  
 stack3_block9_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_8[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_34 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_43[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_17 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block9_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_34[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_35 (TFO  (None, 256, 10, 32)  0          ['lambda_17[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_44 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_35[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block9_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_44[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block9_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block9_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block9_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block9_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block9_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_20 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block9_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_20 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_20[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block9_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_20[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block9_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block9_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block9_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block9_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block9_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_downsample_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack4_downsample_pad (ZeroPad  (None, 18, 18, 320)  0          ['stack4_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack4_downsample_conv (Conv2D  (None, 8, 8, 512)   1475072     ['stack4_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack4_block1_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack4_block1_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_45 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_9 (TFOpLambda)        [(None, 64, 512),    0           ['tf.reshape_45[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_46 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][0]']             
                                                                                                  
 tf.reshape_47 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_36 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_46[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_37 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_47[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_18 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_36[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_37[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 16, 64, 64)  0           ['lambda_18[0][0]']              
 )                                                                                                
                                                                                                  
 tf.reshape_48 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][2]']             
                                                                                                  
 stack4_block1_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_9[0][0]']     
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_38 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_48[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_19 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_38[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_39 (TFO  (None, 64, 16, 32)  0           ['lambda_19[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_49 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_39[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack4_block1_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_49[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block1_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block1_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_21 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_21 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_21[0][0]']          
                                                                                                  
 stack4_block1_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_21[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block1_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block1_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block1_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block2_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_50 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_10 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_50[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_51 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][0]']            
                                                                                                  
 tf.reshape_52 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_40 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_51[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_41 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_52[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_20 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_40[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_41[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_10 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_20[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_53 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][2]']            
                                                                                                  
 stack4_block2_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_10[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_42 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_53[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_21 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_42[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_43 (TFO  (None, 64, 16, 32)  0           ['lambda_21[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_54 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_43[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block2_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_54[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block2_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block2_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_22 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_22 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_22[0][0]']          
                                                                                                  
 stack4_block2_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_22[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block2_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block2_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block2_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block3_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_55 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_11 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_55[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_56 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][0]']            
                                                                                                  
 tf.reshape_57 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_44 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_56[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_45 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_57[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_22 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_44[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_45[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_11 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_22[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_58 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][2]']            
                                                                                                  
 stack4_block3_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_11[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_46 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_58[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_23 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_46[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_47 (TFO  (None, 64, 16, 32)  0           ['lambda_23[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_59 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_47[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block3_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_59[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block3_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block3_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_23 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_23 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_23[0][0]']          
                                                                                                  
 stack4_block3_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_23[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 layer_normalization (LayerNorm  (None, 16, 16, 320)  640        ['stack3_block9_mlp_Dense_1[0][0]
 alization)                                                      ']                               
                                                                                                  
 stack4_block3_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 separable_conv2d (SeparableCon  (None, 16, 16, 320)  105600     ['layer_normalization[0][0]']    
 v2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)              (None, 8, 8, 320)    163840      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_5 (Conv2D)              (None, 8, 8, 320)    1474560     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 attention (Attention)          (None, 16, 16, 320)  0           ['separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]']       
                                                                                                  
 add_2 (Add)                    (None, 8, 8, 320)    0           ['conv2d_4[0][0]',               
                                                                  'conv2d_5[0][0]']               
                                                                                                  
 add_4 (Add)                    (None, 16, 16, 320)  0           ['attention[0][0]',              
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_1 (UpSampling2D)  (None, 16, 16, 320)  0          ['add_2[0][0]']                  
                                                                                                  
 dense (Dense)                  (None, 16, 16, 320)  102720      ['add_4[0][0]']                  
                                                                                                  
 batch_normalization_1 (BatchNo  (None, 16, 16, 320)  1280       ['up_sampling2d_1[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_1 (Dense)                (None, 16, 16, 320)  102720      ['dense[0][0]']                  
                                                                                                  
 activation_1 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_1[0][0]']  
                                                                                                  
 add_5 (Add)                    (None, 16, 16, 320)  0           ['add_4[0][0]',                  
                                                                  'dense_1[0][0]']                
                                                                                                  
 add_6 (Add)                    (None, 16, 16, 320)  0           ['activation_1[0][0]',           
                                                                  'add_5[0][0]']                  
                                                                                                  
 conv2d_8 (Conv2D)              (None, 16, 16, 320)  102720      ['add_6[0][0]']                  
                                                                                                  
 batch_normalization_2 (BatchNo  (None, 16, 16, 320)  1280       ['conv2d_8[0][0]']               
 rmalization)                                                                                     
                                                                                                  
 activation_2 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_2[0][0]']  
                                                                                                  
 conv2d (Conv2D)                (None, 8, 8, 512)    262144      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_1 (Conv2D)              (None, 8, 8, 512)    2359296     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_9 (Conv2D)              (None, 16, 16, 128)  40960       ['activation_2[0][0]']           
                                                                                                  
 conv2d_10 (Conv2D)             (None, 16, 16, 128)  368640      ['activation_2[0][0]']           
                                                                                                  
 add (Add)                      (None, 8, 8, 512)    0           ['conv2d[0][0]',                 
                                                                  'conv2d_1[0][0]']               
                                                                                                  
 layer_normalization_1 (LayerNo  (None, 32, 32, 128)  256        ['stack2_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 add_7 (Add)                    (None, 16, 16, 128)  0           ['conv2d_9[0][0]',               
                                                                  'conv2d_10[0][0]']              
                                                                                                  
 up_sampling2d (UpSampling2D)   (None, 32, 32, 512)  0           ['add[0][0]']                    
                                                                                                  
 separable_conv2d_1 (SeparableC  (None, 32, 32, 128)  17664      ['layer_normalization_1[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 up_sampling2d_2 (UpSampling2D)  (None, 32, 32, 128)  0          ['add_7[0][0]']                  
                                                                                                  
 batch_normalization (BatchNorm  (None, 32, 32, 512)  2048       ['up_sampling2d[0][0]']          
 alization)                                                                                       
                                                                                                  
 attention_1 (Attention)        (None, 32, 32, 128)  0           ['separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]']     
                                                                                                  
 batch_normalization_3 (BatchNo  (None, 32, 32, 128)  512        ['up_sampling2d_2[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 activation (Activation)        (None, 32, 32, 512)  0           ['batch_normalization[0][0]']    
                                                                                                  
 add_9 (Add)                    (None, 32, 32, 128)  0           ['attention_1[0][0]',            
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 activation_3 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_3[0][0]']  
                                                                                                  
 conv2d_13 (Conv2D)             (None, 32, 32, 128)  65664       ['activation[0][0]']             
                                                                                                  
 dense_2 (Dense)                (None, 32, 32, 128)  16512       ['add_9[0][0]']                  
                                                                                                  
 add_11 (Add)                   (None, 32, 32, 128)  0           ['activation_3[0][0]',           
                                                                  'conv2d_13[0][0]']              
                                                                                                  
 dense_3 (Dense)                (None, 32, 32, 128)  16512       ['dense_2[0][0]']                
                                                                                                  
 conv2d_14 (Conv2D)             (None, 32, 32, 128)  16512       ['add_11[0][0]']                 
                                                                                                  
 add_10 (Add)                   (None, 32, 32, 128)  0           ['add_9[0][0]',                  
                                                                  'dense_3[0][0]']                
                                                                                                  
 add_12 (Add)                   (None, 32, 32, 128)  0           ['conv2d_14[0][0]',              
                                                                  'add_10[0][0]']                 
                                                                                                  
 conv2d_15 (Conv2D)             (None, 32, 32, 128)  16512       ['add_12[0][0]']                 
                                                                                                  
 batch_normalization_4 (BatchNo  (None, 32, 32, 128)  512        ['conv2d_15[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 layer_normalization_2 (LayerNo  (None, 64, 64, 64)  128         ['stack1_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 activation_4 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_4[0][0]']  
                                                                                                  
 separable_conv2d_2 (SeparableC  (None, 64, 64, 64)  4736        ['layer_normalization_2[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 conv2d_20 (Conv2D)             (None, 32, 32, 64)   8192        ['activation_4[0][0]']           
                                                                                                  
 conv2d_21 (Conv2D)             (None, 32, 32, 64)   73728       ['activation_4[0][0]']           
                                                                                                  
 attention_2 (Attention)        (None, 64, 64, 64)   0           ['separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]']     
                                                                                                  
 add_15 (Add)                   (None, 32, 32, 64)   0           ['conv2d_20[0][0]',              
                                                                  'conv2d_21[0][0]']              
                                                                                                  
 add_17 (Add)                   (None, 64, 64, 64)   0           ['attention_2[0][0]',            
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_4 (UpSampling2D)  (None, 64, 64, 64)  0           ['add_15[0][0]']                 
                                                                                                  
 dense_4 (Dense)                (None, 64, 64, 64)   4160        ['add_17[0][0]']                 
                                                                                                  
 batch_normalization_6 (BatchNo  (None, 64, 64, 64)  256         ['up_sampling2d_4[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_5 (Dense)                (None, 64, 64, 64)   4160        ['dense_4[0][0]']                
                                                                                                  
 activation_6 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_6[0][0]']  
                                                                                                  
 add_18 (Add)                   (None, 64, 64, 64)   0           ['add_17[0][0]',                 
                                                                  'dense_5[0][0]']                
                                                                                                  
 add_19 (Add)                   (None, 64, 64, 64)   0           ['activation_6[0][0]',           
                                                                  'add_18[0][0]']                 
                                                                                                  
 conv2d_24 (Conv2D)             (None, 64, 64, 64)   4160        ['add_19[0][0]']                 
                                                                                                  
 conv2d_16 (Conv2D)             (None, 32, 32, 128)  16384       ['activation_4[0][0]']           
                                                                                                  
 conv2d_17 (Conv2D)             (None, 32, 32, 128)  147456      ['activation_4[0][0]']           
                                                                                                  
 batch_normalization_7 (BatchNo  (None, 64, 64, 64)  256         ['conv2d_24[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 add_13 (Add)                   (None, 32, 32, 128)  0           ['conv2d_16[0][0]',              
                                                                  'conv2d_17[0][0]']              
                                                                                                  
 activation_7 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_7[0][0]']  
                                                                                                  
 up_sampling2d_3 (UpSampling2D)  (None, 256, 256, 12  0          ['add_13[0][0]']                 
                                8)                                                                
                                                                                                  
 conv2d_26 (Conv2D)             (None, 64, 64, 32)   2048        ['activation_7[0][0]']           
                                                                                                  
 conv2d_27 (Conv2D)             (None, 64, 64, 32)   18432       ['activation_7[0][0]']           
                                                                                                  
 batch_normalization_5 (BatchNo  (None, 256, 256, 12  512        ['up_sampling2d_3[0][0]']        
 rmalization)                   8)                                                                
                                                                                                  
 add_20 (Add)                   (None, 64, 64, 32)   0           ['conv2d_26[0][0]',              
                                                                  'conv2d_27[0][0]']              
                                                                                                  
 activation_5 (Activation)      (None, 256, 256, 12  0           ['batch_normalization_5[0][0]']  
                                8)                                                                
                                                                                                  
 up_sampling2d_5 (UpSampling2D)  (None, 256, 256, 32  0          ['add_20[0][0]']                 
                                )                                                                 
                                                                                                  
 conv2d_25 (Conv2D)             (None, 256, 256, 32  4128        ['activation_5[0][0]']           
                                )                                                                 
                                                                                                  
 batch_normalization_9 (BatchNo  (None, 256, 256, 32  128        ['up_sampling2d_5[0][0]']        
 rmalization)                   )                                                                 
                                                                                                  
 batch_normalization_8 (BatchNo  (None, 256, 256, 32  128        ['conv2d_25[0][0]']              
 rmalization)                   )                                                                 
                                                                                                  
 activation_9 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_9[0][0]']  
                                )                                                                 
                                                                                                  
 activation_8 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_8[0][0]']  
                                )                                                                 
                                                                                                  
 add_22 (Add)                   (None, 256, 256, 32  0           ['activation_9[0][0]',           
                                )                                 'activation_8[0][0]']           
                                                                                                  
 conv2d_30 (Conv2D)             (None, 256, 256, 32  1056        ['add_22[0][0]']                 
                                )                                                                 
                                                                                                  
 batch_normalization_10 (BatchN  (None, 256, 256, 32  128        ['conv2d_30[0][0]']              
 ormalization)                  )                                                                 
                                                                                                  
 activation_10 (Activation)     (None, 256, 256, 32  0           ['batch_normalization_10[0][0]'] 
                                )                                                                 
                                                                                                  
 conv2d_31 (Conv2D)             (None, 256, 256, 1)  33          ['activation_10[0][0]']          
                                                                                                  
==================================================================================================
Total params: 28,765,713
Trainable params: 28,762,193
Non-trainable params: 3,520
__________________________________________________________________________________________________
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 stem_ (ZeroPadding2D)          (None, 260, 260, 3)  0           ['input_1[0][0]']                
                                                                                                  
 stem_conv (Conv2D)             (None, 64, 64, 64)   9472        ['stem_[0][0]']                  
                                                                                                  
 stem_ln (LayerNormalization)   (None, 64, 64, 64)   64          ['stem_conv[0][0]']              
                                                                                                  
 stack1_block1_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stem_ln[0][0]']                
 rmalization)                                                                                     
                                                                                                  
 stack1_block1_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu (TFOpLambda)        (None, 64, 64, 128)  0           ['stack1_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow (TFOpLambda)       (None, 64, 64, 128)  0           ['tf.nn.relu[0][0]']             
                                                                                                  
 stack1_block1_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow[0][0]']            
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block1_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block1_attn_output (Add  (None, 64, 64, 64)  0           ['stem_ln[0][0]',                
 )                                                                'stack1_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack1_block1_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block1_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_1 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_1 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_1[0][0]']           
                                                                                                  
 stack1_block1_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_1[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block1_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block1_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block2_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block2_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_2 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_2 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_2[0][0]']           
                                                                                                  
 stack1_block2_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_2[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block2_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block2_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block1_mlp_output[0][0]'
 )                                                               , 'stack1_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block2_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block2_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_3 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_3 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_3[0][0]']           
                                                                                                  
 stack1_block2_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_3[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block2_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block2_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block3_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block3_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_4 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_4 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_4[0][0]']           
                                                                                                  
 stack1_block3_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_4[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block3_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block3_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block2_mlp_output[0][0]'
 )                                                               , 'stack1_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block3_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block3_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_5 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_5 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_5[0][0]']           
                                                                                                  
 stack1_block3_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_5[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block3_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block3_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_downsample_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack2_downsample_pad (ZeroPad  (None, 66, 66, 64)  0           ['stack2_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack2_downsample_conv (Conv2D  (None, 32, 32, 128)  73856      ['stack2_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack2_block1_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack2_block1_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_6 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_6 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_6[0][0]']           
                                                                                                  
 stack2_block1_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_6[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block1_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block1_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_downsample_conv[0][0]', 
 )                                                                'stack2_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack2_block1_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block1_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_7 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_7 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_7[0][0]']           
                                                                                                  
 stack2_block1_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_7[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block1_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block1_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block2_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block2_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_8 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_8 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_8[0][0]']           
                                                                                                  
 stack2_block2_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_8[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block2_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block2_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block1_mlp_output[0][0]'
 )                                                               , 'stack2_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block2_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block2_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_9 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_9 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_9[0][0]']           
                                                                                                  
 stack2_block2_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_9[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block2_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block2_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block3_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block3_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_10 (TFOpLambda)     (None, 32, 32, 256)  0           ['stack2_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_10 (TFOpLambda)    (None, 32, 32, 256)  0           ['tf.nn.relu_10[0][0]']          
                                                                                                  
 stack2_block3_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_10[0][0]']         
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block3_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block3_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block2_mlp_output[0][0]'
 )                                                               , 'stack2_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block3_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block3_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_11 (TFOpLambda)     (None, 32, 32, 512)  0           ['stack2_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_11 (TFOpLambda)    (None, 32, 32, 512)  0           ['tf.nn.relu_11[0][0]']          
                                                                                                  
 stack2_block3_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_11[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block3_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block3_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_downsample_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack3_downsample_pad (ZeroPad  (None, 34, 34, 128)  0          ['stack3_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack3_downsample_conv (Conv2D  (None, 16, 16, 320)  368960     ['stack3_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack3_block1_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack3_block1_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 256, 960)     0           ['stack3_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split (TFOpLambda)          [(None, 256, 320),   0           ['tf.reshape[0][0]']             
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][0]']               
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][1]']               
                                                                                                  
 tf.compat.v1.transpose (TFOpLa  (None, 10, 256, 32)  0          ['tf.reshape_1[0][0]']           
 mbda)                                                                                            
                                                                                                  
 tf.compat.v1.transpose_1 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_2[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda (Lambda)                (None, 10, 256, 256  0           ['tf.compat.v1.transpose[0][0]', 
                                )                                 'tf.compat.v1.transpose_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 10, 256, 256  0           ['lambda[0][0]']                 
                                )                                                                 
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][2]']               
                                                                                                  
 stack3_block1_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply[0][0]']       
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_2 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_1 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_2[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_3 (TFOp  (None, 256, 10, 32)  0          ['lambda_1[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_3[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block1_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack3_block1_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_4[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block1_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block1_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block1_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block1_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_12 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block1_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_12 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_12[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block1_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_12[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block1_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block1_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block1_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block2_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 256, 960)     0           ['stack3_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_1 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_5[0][0]']           
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][0]']             
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_4 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_6[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_5 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_7[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_2 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_4[0][0]'
                                )                                , 'tf.compat.v1.transpose_5[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_2[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][2]']             
                                                                                                  
 stack3_block2_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_1[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_6 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_8[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_3 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_6[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_7 (TFOp  (None, 256, 10, 32)  0          ['lambda_3[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_7[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block2_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block2_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_9[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block2_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block2_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block2_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_13 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block2_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_13 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_13[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block2_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_13[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block2_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block2_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block2_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block3_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_2 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_10[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][0]']             
                                                                                                  
 tf.reshape_12 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_8 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_11[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_9 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_12[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 lambda_4 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_8[0][0]'
                                )                                , 'tf.compat.v1.transpose_9[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_4[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_13 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][2]']             
                                                                                                  
 stack3_block3_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_2[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_10 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_13[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_5 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_10[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_11 (TFO  (None, 256, 10, 32)  0          ['lambda_5[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_14 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_11[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block3_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_14[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block3_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block3_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block3_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_14 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block3_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_14 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_14[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block3_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_14[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block3_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block3_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block3_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block3_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block4_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block4_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_15 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block4_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_3 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_15[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_16 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][0]']             
                                                                                                  
 tf.reshape_17 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_12 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_16[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_13 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_17[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_6 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_12[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_13[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_3 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_6[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_18 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][2]']             
                                                                                                  
 stack3_block4_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_3[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_14 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_18[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_7 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block4_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_14[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_15 (TFO  (None, 256, 10, 32)  0          ['lambda_7[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_19 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_15[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block4_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_19[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block4_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block4_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block4_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block4_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block4_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_15 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block4_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_15 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_15[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block4_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_15[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block4_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block4_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block4_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block4_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block4_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block4_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block5_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block5_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_20 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block5_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_4 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_20[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_21 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][0]']             
                                                                                                  
 tf.reshape_22 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_16 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_21[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_17 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_22[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_8 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_16[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_17[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_4 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_8[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_23 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][2]']             
                                                                                                  
 stack3_block5_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_4[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_18 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_23[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_9 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block5_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_18[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_19 (TFO  (None, 256, 10, 32)  0          ['lambda_9[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_24 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_19[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block5_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_24[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block5_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block5_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block5_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block5_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block5_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_16 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block5_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_16 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_16[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block5_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_16[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block5_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block5_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block5_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block5_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block5_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block5_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block6_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block6_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_25 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block6_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_5 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_25[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_26 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][0]']             
                                                                                                  
 tf.reshape_27 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_20 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_26[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_21 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_27[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_10 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_20[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_21[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_5 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_10[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_28 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][2]']             
                                                                                                  
 stack3_block6_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_5[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_22 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_28[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_11 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block6_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_22[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_23 (TFO  (None, 256, 10, 32)  0          ['lambda_11[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_29 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_23[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block6_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_29[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block6_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block6_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block6_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block6_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block6_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_17 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block6_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_17 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_17[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block6_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_17[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block6_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block6_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block6_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block6_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block6_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block6_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block7_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block7_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_30 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block7_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_6 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_30[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_31 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][0]']             
                                                                                                  
 tf.reshape_32 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_24 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_31[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_25 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_32[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_12 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_24[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_25[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_6 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_12[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_33 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][2]']             
                                                                                                  
 stack3_block7_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_6[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_26 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_33[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_13 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block7_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_26[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_27 (TFO  (None, 256, 10, 32)  0          ['lambda_13[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_34 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_27[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block7_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_34[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block7_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block7_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block7_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block7_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block7_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_18 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block7_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_18 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_18[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block7_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_18[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block7_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block7_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block7_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block7_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block7_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block7_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block8_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block8_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_35 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block8_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_7 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_35[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_36 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][0]']             
                                                                                                  
 tf.reshape_37 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_28 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_36[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_29 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_37[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_14 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_28[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_29[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_7 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_14[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_38 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][2]']             
                                                                                                  
 stack3_block8_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_7[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_30 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_38[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_15 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block8_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_30[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_31 (TFO  (None, 256, 10, 32)  0          ['lambda_15[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_39 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_31[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block8_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_39[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block8_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block8_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block8_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block8_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block8_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_19 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block8_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_19 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_19[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block8_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_19[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block8_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block8_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block8_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block8_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block8_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block8_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block9_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block9_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_40 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block9_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_8 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_40[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_41 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][0]']             
                                                                                                  
 tf.reshape_42 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_32 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_41[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_33 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_42[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_16 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_32[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_33[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_16[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_43 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][2]']             
                                                                                                  
 stack3_block9_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_8[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_34 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_43[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_17 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block9_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_34[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_35 (TFO  (None, 256, 10, 32)  0          ['lambda_17[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_44 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_35[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block9_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_44[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block9_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block9_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block9_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block9_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block9_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_20 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block9_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_20 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_20[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block9_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_20[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block9_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block9_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block9_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block9_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block9_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_downsample_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack4_downsample_pad (ZeroPad  (None, 18, 18, 320)  0          ['stack4_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack4_downsample_conv (Conv2D  (None, 8, 8, 512)   1475072     ['stack4_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack4_block1_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack4_block1_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_45 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_9 (TFOpLambda)        [(None, 64, 512),    0           ['tf.reshape_45[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_46 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][0]']             
                                                                                                  
 tf.reshape_47 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_36 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_46[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_37 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_47[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_18 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_36[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_37[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 16, 64, 64)  0           ['lambda_18[0][0]']              
 )                                                                                                
                                                                                                  
 tf.reshape_48 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][2]']             
                                                                                                  
 stack4_block1_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_9[0][0]']     
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_38 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_48[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_19 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_38[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_39 (TFO  (None, 64, 16, 32)  0           ['lambda_19[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_49 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_39[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack4_block1_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_49[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block1_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block1_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_21 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_21 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_21[0][0]']          
                                                                                                  
 stack4_block1_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_21[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block1_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block1_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block1_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block2_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_50 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_10 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_50[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_51 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][0]']            
                                                                                                  
 tf.reshape_52 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_40 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_51[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_41 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_52[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_20 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_40[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_41[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_10 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_20[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_53 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][2]']            
                                                                                                  
 stack4_block2_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_10[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_42 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_53[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_21 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_42[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_43 (TFO  (None, 64, 16, 32)  0           ['lambda_21[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_54 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_43[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block2_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_54[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block2_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block2_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_22 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_22 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_22[0][0]']          
                                                                                                  
 stack4_block2_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_22[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block2_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block2_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block2_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block3_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_55 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_11 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_55[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_56 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][0]']            
                                                                                                  
 tf.reshape_57 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_44 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_56[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_45 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_57[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_22 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_44[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_45[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_11 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_22[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_58 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][2]']            
                                                                                                  
 stack4_block3_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_11[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_46 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_58[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_23 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_46[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_47 (TFO  (None, 64, 16, 32)  0           ['lambda_23[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_59 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_47[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block3_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_59[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block3_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block3_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_23 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_23 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_23[0][0]']          
                                                                                                  
 stack4_block3_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_23[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 layer_normalization (LayerNorm  (None, 16, 16, 320)  640        ['stack3_block9_mlp_Dense_1[0][0]
 alization)                                                      ']                               
                                                                                                  
 stack4_block3_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 separable_conv2d (SeparableCon  (None, 16, 16, 320)  105600     ['layer_normalization[0][0]']    
 v2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)              (None, 8, 8, 320)    163840      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_5 (Conv2D)              (None, 8, 8, 320)    1474560     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 attention (Attention)          (None, 16, 16, 320)  0           ['separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]']       
                                                                                                  
 add_2 (Add)                    (None, 8, 8, 320)    0           ['conv2d_4[0][0]',               
                                                                  'conv2d_5[0][0]']               
                                                                                                  
 add_4 (Add)                    (None, 16, 16, 320)  0           ['attention[0][0]',              
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_1 (UpSampling2D)  (None, 16, 16, 320)  0          ['add_2[0][0]']                  
                                                                                                  
 dense (Dense)                  (None, 16, 16, 320)  102720      ['add_4[0][0]']                  
                                                                                                  
 batch_normalization_1 (BatchNo  (None, 16, 16, 320)  1280       ['up_sampling2d_1[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_1 (Dense)                (None, 16, 16, 320)  102720      ['dense[0][0]']                  
                                                                                                  
 activation_1 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_1[0][0]']  
                                                                                                  
 add_5 (Add)                    (None, 16, 16, 320)  0           ['add_4[0][0]',                  
                                                                  'dense_1[0][0]']                
                                                                                                  
 add_6 (Add)                    (None, 16, 16, 320)  0           ['activation_1[0][0]',           
                                                                  'add_5[0][0]']                  
                                                                                                  
 conv2d_8 (Conv2D)              (None, 16, 16, 320)  102720      ['add_6[0][0]']                  
                                                                                                  
 batch_normalization_2 (BatchNo  (None, 16, 16, 320)  1280       ['conv2d_8[0][0]']               
 rmalization)                                                                                     
                                                                                                  
 activation_2 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_2[0][0]']  
                                                                                                  
 conv2d (Conv2D)                (None, 8, 8, 512)    262144      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_1 (Conv2D)              (None, 8, 8, 512)    2359296     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_9 (Conv2D)              (None, 16, 16, 128)  40960       ['activation_2[0][0]']           
                                                                                                  
 conv2d_10 (Conv2D)             (None, 16, 16, 128)  368640      ['activation_2[0][0]']           
                                                                                                  
 add (Add)                      (None, 8, 8, 512)    0           ['conv2d[0][0]',                 
                                                                  'conv2d_1[0][0]']               
                                                                                                  
 layer_normalization_1 (LayerNo  (None, 32, 32, 128)  256        ['stack2_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 add_7 (Add)                    (None, 16, 16, 128)  0           ['conv2d_9[0][0]',               
                                                                  'conv2d_10[0][0]']              
                                                                                                  
 up_sampling2d (UpSampling2D)   (None, 32, 32, 512)  0           ['add[0][0]']                    
                                                                                                  
 separable_conv2d_1 (SeparableC  (None, 32, 32, 128)  17664      ['layer_normalization_1[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 up_sampling2d_2 (UpSampling2D)  (None, 32, 32, 128)  0          ['add_7[0][0]']                  
                                                                                                  
 batch_normalization (BatchNorm  (None, 32, 32, 512)  2048       ['up_sampling2d[0][0]']          
 alization)                                                                                       
                                                                                                  
 attention_1 (Attention)        (None, 32, 32, 128)  0           ['separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]']     
                                                                                                  
 batch_normalization_3 (BatchNo  (None, 32, 32, 128)  512        ['up_sampling2d_2[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 activation (Activation)        (None, 32, 32, 512)  0           ['batch_normalization[0][0]']    
                                                                                                  
 add_9 (Add)                    (None, 32, 32, 128)  0           ['attention_1[0][0]',            
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 activation_3 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_3[0][0]']  
                                                                                                  
 conv2d_13 (Conv2D)             (None, 32, 32, 128)  65664       ['activation[0][0]']             
                                                                                                  
 dense_2 (Dense)                (None, 32, 32, 128)  16512       ['add_9[0][0]']                  
                                                                                                  
 add_11 (Add)                   (None, 32, 32, 128)  0           ['activation_3[0][0]',           
                                                                  'conv2d_13[0][0]']              
                                                                                                  
 dense_3 (Dense)                (None, 32, 32, 128)  16512       ['dense_2[0][0]']                
                                                                                                  
 conv2d_14 (Conv2D)             (None, 32, 32, 128)  16512       ['add_11[0][0]']                 
                                                                                                  
 add_10 (Add)                   (None, 32, 32, 128)  0           ['add_9[0][0]',                  
                                                                  'dense_3[0][0]']                
                                                                                                  
 add_12 (Add)                   (None, 32, 32, 128)  0           ['conv2d_14[0][0]',              
                                                                  'add_10[0][0]']                 
                                                                                                  
 conv2d_15 (Conv2D)             (None, 32, 32, 128)  16512       ['add_12[0][0]']                 
                                                                                                  
 batch_normalization_4 (BatchNo  (None, 32, 32, 128)  512        ['conv2d_15[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 layer_normalization_2 (LayerNo  (None, 64, 64, 64)  128         ['stack1_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 activation_4 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_4[0][0]']  
                                                                                                  
 separable_conv2d_2 (SeparableC  (None, 64, 64, 64)  4736        ['layer_normalization_2[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 conv2d_20 (Conv2D)             (None, 32, 32, 64)   8192        ['activation_4[0][0]']           
                                                                                                  
 conv2d_21 (Conv2D)             (None, 32, 32, 64)   73728       ['activation_4[0][0]']           
                                                                                                  
 attention_2 (Attention)        (None, 64, 64, 64)   0           ['separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]']     
                                                                                                  
 add_15 (Add)                   (None, 32, 32, 64)   0           ['conv2d_20[0][0]',              
                                                                  'conv2d_21[0][0]']              
                                                                                                  
 add_17 (Add)                   (None, 64, 64, 64)   0           ['attention_2[0][0]',            
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_4 (UpSampling2D)  (None, 64, 64, 64)  0           ['add_15[0][0]']                 
                                                                                                  
 dense_4 (Dense)                (None, 64, 64, 64)   4160        ['add_17[0][0]']                 
                                                                                                  
 batch_normalization_6 (BatchNo  (None, 64, 64, 64)  256         ['up_sampling2d_4[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_5 (Dense)                (None, 64, 64, 64)   4160        ['dense_4[0][0]']                
                                                                                                  
 activation_6 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_6[0][0]']  
                                                                                                  
 add_18 (Add)                   (None, 64, 64, 64)   0           ['add_17[0][0]',                 
                                                                  'dense_5[0][0]']                
                                                                                                  
 add_19 (Add)                   (None, 64, 64, 64)   0           ['activation_6[0][0]',           
                                                                  'add_18[0][0]']                 
                                                                                                  
 conv2d_24 (Conv2D)             (None, 64, 64, 64)   4160        ['add_19[0][0]']                 
                                                                                                  
 conv2d_16 (Conv2D)             (None, 32, 32, 128)  16384       ['activation_4[0][0]']           
                                                                                                  
 conv2d_17 (Conv2D)             (None, 32, 32, 128)  147456      ['activation_4[0][0]']           
                                                                                                  
 batch_normalization_7 (BatchNo  (None, 64, 64, 64)  256         ['conv2d_24[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 add_13 (Add)                   (None, 32, 32, 128)  0           ['conv2d_16[0][0]',              
                                                                  'conv2d_17[0][0]']              
                                                                                                  
 activation_7 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_7[0][0]']  
                                                                                                  
 up_sampling2d_3 (UpSampling2D)  (None, 256, 256, 12  0          ['add_13[0][0]']                 
                                8)                                                                
                                                                                                  
 conv2d_26 (Conv2D)             (None, 64, 64, 32)   2048        ['activation_7[0][0]']           
                                                                                                  
 conv2d_27 (Conv2D)             (None, 64, 64, 32)   18432       ['activation_7[0][0]']           
                                                                                                  
 batch_normalization_5 (BatchNo  (None, 256, 256, 12  512        ['up_sampling2d_3[0][0]']        
 rmalization)                   8)                                                                
                                                                                                  
 add_20 (Add)                   (None, 64, 64, 32)   0           ['conv2d_26[0][0]',              
                                                                  'conv2d_27[0][0]']              
                                                                                                  
 activation_5 (Activation)      (None, 256, 256, 12  0           ['batch_normalization_5[0][0]']  
                                8)                                                                
                                                                                                  
 up_sampling2d_5 (UpSampling2D)  (None, 256, 256, 32  0          ['add_20[0][0]']                 
                                )                                                                 
                                                                                                  
 conv2d_25 (Conv2D)             (None, 256, 256, 32  4128        ['activation_5[0][0]']           
                                )                                                                 
                                                                                                  
 batch_normalization_9 (BatchNo  (None, 256, 256, 32  128        ['up_sampling2d_5[0][0]']        
 rmalization)                   )                                                                 
                                                                                                  
 batch_normalization_8 (BatchNo  (None, 256, 256, 32  128        ['conv2d_25[0][0]']              
 rmalization)                   )                                                                 
                                                                                                  
 activation_9 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_9[0][0]']  
                                )                                                                 
                                                                                                  
 activation_8 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_8[0][0]']  
                                )                                                                 
                                                                                                  
 add_22 (Add)                   (None, 256, 256, 32  0           ['activation_9[0][0]',           
                                )                                 'activation_8[0][0]']           
                                                                                                  
 conv2d_30 (Conv2D)             (None, 256, 256, 32  1056        ['add_22[0][0]']                 
                                )                                                                 
                                                                                                  
 batch_normalization_10 (BatchN  (None, 256, 256, 32  128        ['conv2d_30[0][0]']              
 ormalization)                  )                                                                 
                                                                                                  
 activation_10 (Activation)     (None, 256, 256, 32  0           ['batch_normalization_10[0][0]'] 
                                )                                                                 
                                                                                                  
 conv2d_31 (Conv2D)             (None, 256, 256, 1)  33          ['activation_10[0][0]']          
                                                                                                  
==================================================================================================
Total params: 28,765,713
Trainable params: 28,762,193
Non-trainable params: 3,520
__________________________________________________________________________________________________
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 stem_ (ZeroPadding2D)          (None, 260, 260, 3)  0           ['input_1[0][0]']                
                                                                                                  
 stem_conv (Conv2D)             (None, 64, 64, 64)   9472        ['stem_[0][0]']                  
                                                                                                  
 stem_ln (LayerNormalization)   (None, 64, 64, 64)   64          ['stem_conv[0][0]']              
                                                                                                  
 stack1_block1_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stem_ln[0][0]']                
 rmalization)                                                                                     
                                                                                                  
 stack1_block1_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu (TFOpLambda)        (None, 64, 64, 128)  0           ['stack1_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow (TFOpLambda)       (None, 64, 64, 128)  0           ['tf.nn.relu[0][0]']             
                                                                                                  
 stack1_block1_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow[0][0]']            
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block1_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block1_attn_output (Add  (None, 64, 64, 64)  0           ['stem_ln[0][0]',                
 )                                                                'stack1_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack1_block1_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block1_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_1 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_1 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_1[0][0]']           
                                                                                                  
 stack1_block1_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_1[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block1_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block1_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block2_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block2_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_2 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_2 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_2[0][0]']           
                                                                                                  
 stack1_block2_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_2[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block2_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block2_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block1_mlp_output[0][0]'
 )                                                               , 'stack1_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block2_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block2_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_3 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_3 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_3[0][0]']           
                                                                                                  
 stack1_block2_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_3[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block2_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block2_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block3_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block3_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_4 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_4 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_4[0][0]']           
                                                                                                  
 stack1_block3_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_4[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block3_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block3_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block2_mlp_output[0][0]'
 )                                                               , 'stack1_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block3_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block3_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_5 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_5 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_5[0][0]']           
                                                                                                  
 stack1_block3_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_5[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block3_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block3_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_downsample_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack2_downsample_pad (ZeroPad  (None, 66, 66, 64)  0           ['stack2_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack2_downsample_conv (Conv2D  (None, 32, 32, 128)  73856      ['stack2_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack2_block1_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack2_block1_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_6 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_6 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_6[0][0]']           
                                                                                                  
 stack2_block1_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_6[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block1_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block1_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_downsample_conv[0][0]', 
 )                                                                'stack2_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack2_block1_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block1_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_7 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_7 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_7[0][0]']           
                                                                                                  
 stack2_block1_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_7[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block1_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block1_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block2_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block2_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_8 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_8 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_8[0][0]']           
                                                                                                  
 stack2_block2_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_8[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block2_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block2_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block1_mlp_output[0][0]'
 )                                                               , 'stack2_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block2_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block2_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_9 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_9 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_9[0][0]']           
                                                                                                  
 stack2_block2_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_9[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block2_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block2_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block3_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block3_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_10 (TFOpLambda)     (None, 32, 32, 256)  0           ['stack2_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_10 (TFOpLambda)    (None, 32, 32, 256)  0           ['tf.nn.relu_10[0][0]']          
                                                                                                  
 stack2_block3_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_10[0][0]']         
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block3_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block3_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block2_mlp_output[0][0]'
 )                                                               , 'stack2_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block3_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block3_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_11 (TFOpLambda)     (None, 32, 32, 512)  0           ['stack2_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_11 (TFOpLambda)    (None, 32, 32, 512)  0           ['tf.nn.relu_11[0][0]']          
                                                                                                  
 stack2_block3_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_11[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block3_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block3_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_downsample_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack3_downsample_pad (ZeroPad  (None, 34, 34, 128)  0          ['stack3_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack3_downsample_conv (Conv2D  (None, 16, 16, 320)  368960     ['stack3_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack3_block1_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack3_block1_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 256, 960)     0           ['stack3_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split (TFOpLambda)          [(None, 256, 320),   0           ['tf.reshape[0][0]']             
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][0]']               
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][1]']               
                                                                                                  
 tf.compat.v1.transpose (TFOpLa  (None, 10, 256, 32)  0          ['tf.reshape_1[0][0]']           
 mbda)                                                                                            
                                                                                                  
 tf.compat.v1.transpose_1 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_2[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda (Lambda)                (None, 10, 256, 256  0           ['tf.compat.v1.transpose[0][0]', 
                                )                                 'tf.compat.v1.transpose_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 10, 256, 256  0           ['lambda[0][0]']                 
                                )                                                                 
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][2]']               
                                                                                                  
 stack3_block1_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply[0][0]']       
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_2 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_1 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_2[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_3 (TFOp  (None, 256, 10, 32)  0          ['lambda_1[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_3[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block1_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack3_block1_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_4[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block1_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block1_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block1_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block1_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_12 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block1_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_12 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_12[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block1_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_12[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block1_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block1_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block1_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block2_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 256, 960)     0           ['stack3_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_1 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_5[0][0]']           
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][0]']             
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_4 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_6[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_5 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_7[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_2 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_4[0][0]'
                                )                                , 'tf.compat.v1.transpose_5[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_2[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][2]']             
                                                                                                  
 stack3_block2_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_1[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_6 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_8[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_3 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_6[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_7 (TFOp  (None, 256, 10, 32)  0          ['lambda_3[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_7[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block2_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block2_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_9[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block2_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block2_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block2_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_13 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block2_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_13 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_13[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block2_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_13[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block2_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block2_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block2_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block3_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_2 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_10[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][0]']             
                                                                                                  
 tf.reshape_12 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_8 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_11[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_9 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_12[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 lambda_4 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_8[0][0]'
                                )                                , 'tf.compat.v1.transpose_9[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_4[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_13 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][2]']             
                                                                                                  
 stack3_block3_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_2[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_10 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_13[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_5 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_10[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_11 (TFO  (None, 256, 10, 32)  0          ['lambda_5[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_14 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_11[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block3_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_14[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block3_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block3_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block3_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_14 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block3_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_14 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_14[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block3_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_14[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block3_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block3_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block3_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block3_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block4_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block4_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_15 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block4_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_3 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_15[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_16 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][0]']             
                                                                                                  
 tf.reshape_17 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_12 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_16[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_13 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_17[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_6 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_12[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_13[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_3 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_6[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_18 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][2]']             
                                                                                                  
 stack3_block4_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_3[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_14 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_18[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_7 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block4_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_14[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_15 (TFO  (None, 256, 10, 32)  0          ['lambda_7[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_19 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_15[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block4_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_19[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block4_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block4_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block4_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block4_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block4_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_15 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block4_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_15 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_15[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block4_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_15[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block4_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block4_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block4_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block4_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block4_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block4_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block5_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block5_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_20 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block5_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_4 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_20[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_21 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][0]']             
                                                                                                  
 tf.reshape_22 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_16 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_21[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_17 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_22[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_8 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_16[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_17[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_4 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_8[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_23 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][2]']             
                                                                                                  
 stack3_block5_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_4[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_18 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_23[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_9 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block5_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_18[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_19 (TFO  (None, 256, 10, 32)  0          ['lambda_9[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_24 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_19[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block5_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_24[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block5_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block5_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block5_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block5_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block5_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_16 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block5_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_16 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_16[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block5_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_16[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block5_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block5_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block5_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block5_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block5_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block5_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block6_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block6_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_25 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block6_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_5 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_25[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_26 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][0]']             
                                                                                                  
 tf.reshape_27 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_20 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_26[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_21 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_27[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_10 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_20[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_21[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_5 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_10[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_28 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][2]']             
                                                                                                  
 stack3_block6_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_5[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_22 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_28[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_11 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block6_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_22[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_23 (TFO  (None, 256, 10, 32)  0          ['lambda_11[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_29 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_23[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block6_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_29[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block6_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block6_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block6_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block6_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block6_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_17 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block6_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_17 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_17[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block6_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_17[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block6_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block6_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block6_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block6_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block6_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block6_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block7_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block7_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_30 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block7_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_6 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_30[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_31 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][0]']             
                                                                                                  
 tf.reshape_32 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_24 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_31[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_25 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_32[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_12 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_24[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_25[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_6 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_12[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_33 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][2]']             
                                                                                                  
 stack3_block7_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_6[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_26 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_33[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_13 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block7_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_26[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_27 (TFO  (None, 256, 10, 32)  0          ['lambda_13[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_34 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_27[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block7_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_34[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block7_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block7_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block7_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block7_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block7_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_18 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block7_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_18 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_18[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block7_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_18[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block7_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block7_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block7_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block7_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block7_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block7_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block8_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block8_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_35 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block8_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_7 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_35[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_36 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][0]']             
                                                                                                  
 tf.reshape_37 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_28 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_36[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_29 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_37[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_14 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_28[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_29[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_7 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_14[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_38 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][2]']             
                                                                                                  
 stack3_block8_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_7[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_30 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_38[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_15 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block8_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_30[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_31 (TFO  (None, 256, 10, 32)  0          ['lambda_15[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_39 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_31[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block8_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_39[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block8_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block8_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block8_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block8_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block8_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_19 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block8_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_19 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_19[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block8_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_19[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block8_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block8_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block8_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block8_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block8_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block8_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block9_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block9_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_40 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block9_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_8 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_40[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_41 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][0]']             
                                                                                                  
 tf.reshape_42 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_32 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_41[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_33 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_42[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_16 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_32[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_33[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_16[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_43 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][2]']             
                                                                                                  
 stack3_block9_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_8[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_34 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_43[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_17 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block9_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_34[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_35 (TFO  (None, 256, 10, 32)  0          ['lambda_17[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_44 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_35[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block9_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_44[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block9_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block9_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block9_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block9_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block9_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_20 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block9_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_20 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_20[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block9_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_20[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block9_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block9_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block9_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block9_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block9_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_downsample_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack4_downsample_pad (ZeroPad  (None, 18, 18, 320)  0          ['stack4_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack4_downsample_conv (Conv2D  (None, 8, 8, 512)   1475072     ['stack4_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack4_block1_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack4_block1_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_45 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_9 (TFOpLambda)        [(None, 64, 512),    0           ['tf.reshape_45[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_46 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][0]']             
                                                                                                  
 tf.reshape_47 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_36 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_46[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_37 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_47[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_18 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_36[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_37[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 16, 64, 64)  0           ['lambda_18[0][0]']              
 )                                                                                                
                                                                                                  
 tf.reshape_48 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][2]']             
                                                                                                  
 stack4_block1_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_9[0][0]']     
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_38 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_48[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_19 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_38[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_39 (TFO  (None, 64, 16, 32)  0           ['lambda_19[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_49 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_39[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack4_block1_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_49[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block1_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block1_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_21 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_21 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_21[0][0]']          
                                                                                                  
 stack4_block1_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_21[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block1_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block1_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block1_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block2_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_50 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_10 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_50[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_51 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][0]']            
                                                                                                  
 tf.reshape_52 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_40 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_51[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_41 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_52[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_20 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_40[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_41[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_10 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_20[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_53 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][2]']            
                                                                                                  
 stack4_block2_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_10[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_42 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_53[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_21 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_42[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_43 (TFO  (None, 64, 16, 32)  0           ['lambda_21[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_54 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_43[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block2_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_54[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block2_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block2_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_22 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_22 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_22[0][0]']          
                                                                                                  
 stack4_block2_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_22[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block2_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block2_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block2_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block3_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_55 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_11 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_55[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_56 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][0]']            
                                                                                                  
 tf.reshape_57 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_44 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_56[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_45 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_57[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_22 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_44[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_45[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_11 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_22[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_58 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][2]']            
                                                                                                  
 stack4_block3_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_11[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_46 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_58[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_23 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_46[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_47 (TFO  (None, 64, 16, 32)  0           ['lambda_23[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_59 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_47[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block3_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_59[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block3_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block3_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_23 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_23 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_23[0][0]']          
                                                                                                  
 stack4_block3_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_23[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 layer_normalization (LayerNorm  (None, 16, 16, 320)  640        ['stack3_block9_mlp_Dense_1[0][0]
 alization)                                                      ']                               
                                                                                                  
 stack4_block3_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 separable_conv2d (SeparableCon  (None, 16, 16, 320)  105600     ['layer_normalization[0][0]']    
 v2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)              (None, 8, 8, 320)    163840      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_5 (Conv2D)              (None, 8, 8, 320)    1474560     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 attention (Attention)          (None, 16, 16, 320)  0           ['separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]']       
                                                                                                  
 add_2 (Add)                    (None, 8, 8, 320)    0           ['conv2d_4[0][0]',               
                                                                  'conv2d_5[0][0]']               
                                                                                                  
 add_4 (Add)                    (None, 16, 16, 320)  0           ['attention[0][0]',              
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_1 (UpSampling2D)  (None, 16, 16, 320)  0          ['add_2[0][0]']                  
                                                                                                  
 dense (Dense)                  (None, 16, 16, 320)  102720      ['add_4[0][0]']                  
                                                                                                  
 batch_normalization_1 (BatchNo  (None, 16, 16, 320)  1280       ['up_sampling2d_1[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_1 (Dense)                (None, 16, 16, 320)  102720      ['dense[0][0]']                  
                                                                                                  
 activation_1 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_1[0][0]']  
                                                                                                  
 add_5 (Add)                    (None, 16, 16, 320)  0           ['add_4[0][0]',                  
                                                                  'dense_1[0][0]']                
                                                                                                  
 add_6 (Add)                    (None, 16, 16, 320)  0           ['activation_1[0][0]',           
                                                                  'add_5[0][0]']                  
                                                                                                  
 conv2d_8 (Conv2D)              (None, 16, 16, 320)  102720      ['add_6[0][0]']                  
                                                                                                  
 batch_normalization_2 (BatchNo  (None, 16, 16, 320)  1280       ['conv2d_8[0][0]']               
 rmalization)                                                                                     
                                                                                                  
 activation_2 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_2[0][0]']  
                                                                                                  
 conv2d (Conv2D)                (None, 8, 8, 512)    262144      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_1 (Conv2D)              (None, 8, 8, 512)    2359296     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_9 (Conv2D)              (None, 16, 16, 128)  40960       ['activation_2[0][0]']           
                                                                                                  
 conv2d_10 (Conv2D)             (None, 16, 16, 128)  368640      ['activation_2[0][0]']           
                                                                                                  
 add (Add)                      (None, 8, 8, 512)    0           ['conv2d[0][0]',                 
                                                                  'conv2d_1[0][0]']               
                                                                                                  
 layer_normalization_1 (LayerNo  (None, 32, 32, 128)  256        ['stack2_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 add_7 (Add)                    (None, 16, 16, 128)  0           ['conv2d_9[0][0]',               
                                                                  'conv2d_10[0][0]']              
                                                                                                  
 up_sampling2d (UpSampling2D)   (None, 32, 32, 512)  0           ['add[0][0]']                    
                                                                                                  
 separable_conv2d_1 (SeparableC  (None, 32, 32, 128)  17664      ['layer_normalization_1[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 up_sampling2d_2 (UpSampling2D)  (None, 32, 32, 128)  0          ['add_7[0][0]']                  
                                                                                                  
 batch_normalization (BatchNorm  (None, 32, 32, 512)  2048       ['up_sampling2d[0][0]']          
 alization)                                                                                       
                                                                                                  
 attention_1 (Attention)        (None, 32, 32, 128)  0           ['separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]']     
                                                                                                  
 batch_normalization_3 (BatchNo  (None, 32, 32, 128)  512        ['up_sampling2d_2[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 activation (Activation)        (None, 32, 32, 512)  0           ['batch_normalization[0][0]']    
                                                                                                  
 add_9 (Add)                    (None, 32, 32, 128)  0           ['attention_1[0][0]',            
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 activation_3 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_3[0][0]']  
                                                                                                  
 conv2d_13 (Conv2D)             (None, 32, 32, 128)  65664       ['activation[0][0]']             
                                                                                                  
 dense_2 (Dense)                (None, 32, 32, 128)  16512       ['add_9[0][0]']                  
                                                                                                  
 add_11 (Add)                   (None, 32, 32, 128)  0           ['activation_3[0][0]',           
                                                                  'conv2d_13[0][0]']              
                                                                                                  
 dense_3 (Dense)                (None, 32, 32, 128)  16512       ['dense_2[0][0]']                
                                                                                                  
 conv2d_14 (Conv2D)             (None, 32, 32, 128)  16512       ['add_11[0][0]']                 
                                                                                                  
 add_10 (Add)                   (None, 32, 32, 128)  0           ['add_9[0][0]',                  
                                                                  'dense_3[0][0]']                
                                                                                                  
 add_12 (Add)                   (None, 32, 32, 128)  0           ['conv2d_14[0][0]',              
                                                                  'add_10[0][0]']                 
                                                                                                  
 conv2d_15 (Conv2D)             (None, 32, 32, 128)  16512       ['add_12[0][0]']                 
                                                                                                  
 batch_normalization_4 (BatchNo  (None, 32, 32, 128)  512        ['conv2d_15[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 layer_normalization_2 (LayerNo  (None, 64, 64, 64)  128         ['stack1_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 activation_4 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_4[0][0]']  
                                                                                                  
 separable_conv2d_2 (SeparableC  (None, 64, 64, 64)  4736        ['layer_normalization_2[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 conv2d_20 (Conv2D)             (None, 32, 32, 64)   8192        ['activation_4[0][0]']           
                                                                                                  
 conv2d_21 (Conv2D)             (None, 32, 32, 64)   73728       ['activation_4[0][0]']           
                                                                                                  
 attention_2 (Attention)        (None, 64, 64, 64)   0           ['separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]']     
                                                                                                  
 add_15 (Add)                   (None, 32, 32, 64)   0           ['conv2d_20[0][0]',              
                                                                  'conv2d_21[0][0]']              
                                                                                                  
 add_17 (Add)                   (None, 64, 64, 64)   0           ['attention_2[0][0]',            
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_4 (UpSampling2D)  (None, 64, 64, 64)  0           ['add_15[0][0]']                 
                                                                                                  
 dense_4 (Dense)                (None, 64, 64, 64)   4160        ['add_17[0][0]']                 
                                                                                                  
 batch_normalization_6 (BatchNo  (None, 64, 64, 64)  256         ['up_sampling2d_4[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_5 (Dense)                (None, 64, 64, 64)   4160        ['dense_4[0][0]']                
                                                                                                  
 activation_6 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_6[0][0]']  
                                                                                                  
 add_18 (Add)                   (None, 64, 64, 64)   0           ['add_17[0][0]',                 
                                                                  'dense_5[0][0]']                
                                                                                                  
 add_19 (Add)                   (None, 64, 64, 64)   0           ['activation_6[0][0]',           
                                                                  'add_18[0][0]']                 
                                                                                                  
 conv2d_24 (Conv2D)             (None, 64, 64, 64)   4160        ['add_19[0][0]']                 
                                                                                                  
 conv2d_16 (Conv2D)             (None, 32, 32, 128)  16384       ['activation_4[0][0]']           
                                                                                                  
 conv2d_17 (Conv2D)             (None, 32, 32, 128)  147456      ['activation_4[0][0]']           
                                                                                                  
 batch_normalization_7 (BatchNo  (None, 64, 64, 64)  256         ['conv2d_24[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 add_13 (Add)                   (None, 32, 32, 128)  0           ['conv2d_16[0][0]',              
                                                                  'conv2d_17[0][0]']              
                                                                                                  
 activation_7 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_7[0][0]']  
                                                                                                  
 up_sampling2d_3 (UpSampling2D)  (None, 256, 256, 12  0          ['add_13[0][0]']                 
                                8)                                                                
                                                                                                  
 conv2d_26 (Conv2D)             (None, 64, 64, 32)   2048        ['activation_7[0][0]']           
                                                                                                  
 conv2d_27 (Conv2D)             (None, 64, 64, 32)   18432       ['activation_7[0][0]']           
                                                                                                  
 batch_normalization_5 (BatchNo  (None, 256, 256, 12  512        ['up_sampling2d_3[0][0]']        
 rmalization)                   8)                                                                
                                                                                                  
 add_20 (Add)                   (None, 64, 64, 32)   0           ['conv2d_26[0][0]',              
                                                                  'conv2d_27[0][0]']              
                                                                                                  
 activation_5 (Activation)      (None, 256, 256, 12  0           ['batch_normalization_5[0][0]']  
                                8)                                                                
                                                                                                  
 up_sampling2d_5 (UpSampling2D)  (None, 256, 256, 32  0          ['add_20[0][0]']                 
                                )                                                                 
                                                                                                  
 conv2d_25 (Conv2D)             (None, 256, 256, 32  4128        ['activation_5[0][0]']           
                                )                                                                 
                                                                                                  
 batch_normalization_9 (BatchNo  (None, 256, 256, 32  128        ['up_sampling2d_5[0][0]']        
 rmalization)                   )                                                                 
                                                                                                  
 batch_normalization_8 (BatchNo  (None, 256, 256, 32  128        ['conv2d_25[0][0]']              
 rmalization)                   )                                                                 
                                                                                                  
 activation_9 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_9[0][0]']  
                                )                                                                 
                                                                                                  
 activation_8 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_8[0][0]']  
                                )                                                                 
                                                                                                  
 add_22 (Add)                   (None, 256, 256, 32  0           ['activation_9[0][0]',           
                                )                                 'activation_8[0][0]']           
                                                                                                  
 conv2d_30 (Conv2D)             (None, 256, 256, 32  1056        ['add_22[0][0]']                 
                                )                                                                 
                                                                                                  
 batch_normalization_10 (BatchN  (None, 256, 256, 32  128        ['conv2d_30[0][0]']              
 ormalization)                  )                                                                 
                                                                                                  
 activation_10 (Activation)     (None, 256, 256, 32  0           ['batch_normalization_10[0][0]'] 
                                )                                                                 
                                                                                                  
 conv2d_31 (Conv2D)             (None, 256, 256, 1)  33          ['activation_10[0][0]']          
                                                                                                  
==================================================================================================
Total params: 28,765,713
Trainable params: 28,762,193
Non-trainable params: 3,520
__________________________________________________________________________________________________
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 stem_ (ZeroPadding2D)          (None, 260, 260, 3)  0           ['input_1[0][0]']                
                                                                                                  
 stem_conv (Conv2D)             (None, 64, 64, 64)   9472        ['stem_[0][0]']                  
                                                                                                  
 stem_ln (LayerNormalization)   (None, 64, 64, 64)   64          ['stem_conv[0][0]']              
                                                                                                  
 stack1_block1_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stem_ln[0][0]']                
 rmalization)                                                                                     
                                                                                                  
 stack1_block1_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu (TFOpLambda)        (None, 64, 64, 128)  0           ['stack1_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow (TFOpLambda)       (None, 64, 64, 128)  0           ['tf.nn.relu[0][0]']             
                                                                                                  
 stack1_block1_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow[0][0]']            
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block1_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block1_attn_output (Add  (None, 64, 64, 64)  0           ['stem_ln[0][0]',                
 )                                                                'stack1_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack1_block1_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block1_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_1 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_1 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_1[0][0]']           
                                                                                                  
 stack1_block1_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_1[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block1_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block1_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block2_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block2_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_2 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_2 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_2[0][0]']           
                                                                                                  
 stack1_block2_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_2[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block2_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block2_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block1_mlp_output[0][0]'
 )                                                               , 'stack1_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block2_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block2_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_3 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_3 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_3[0][0]']           
                                                                                                  
 stack1_block2_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_3[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block2_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block2_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block3_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block3_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_4 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_4 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_4[0][0]']           
                                                                                                  
 stack1_block3_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_4[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block3_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block3_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block2_mlp_output[0][0]'
 )                                                               , 'stack1_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block3_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block3_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_5 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_5 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_5[0][0]']           
                                                                                                  
 stack1_block3_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_5[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block3_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block3_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_downsample_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack2_downsample_pad (ZeroPad  (None, 66, 66, 64)  0           ['stack2_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack2_downsample_conv (Conv2D  (None, 32, 32, 128)  73856      ['stack2_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack2_block1_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack2_block1_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_6 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_6 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_6[0][0]']           
                                                                                                  
 stack2_block1_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_6[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block1_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block1_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_downsample_conv[0][0]', 
 )                                                                'stack2_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack2_block1_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block1_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_7 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_7 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_7[0][0]']           
                                                                                                  
 stack2_block1_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_7[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block1_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block1_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block2_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block2_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_8 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_8 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_8[0][0]']           
                                                                                                  
 stack2_block2_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_8[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block2_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block2_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block1_mlp_output[0][0]'
 )                                                               , 'stack2_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block2_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block2_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_9 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_9 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_9[0][0]']           
                                                                                                  
 stack2_block2_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_9[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block2_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block2_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block3_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block3_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_10 (TFOpLambda)     (None, 32, 32, 256)  0           ['stack2_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_10 (TFOpLambda)    (None, 32, 32, 256)  0           ['tf.nn.relu_10[0][0]']          
                                                                                                  
 stack2_block3_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_10[0][0]']         
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block3_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block3_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block2_mlp_output[0][0]'
 )                                                               , 'stack2_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block3_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block3_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_11 (TFOpLambda)     (None, 32, 32, 512)  0           ['stack2_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_11 (TFOpLambda)    (None, 32, 32, 512)  0           ['tf.nn.relu_11[0][0]']          
                                                                                                  
 stack2_block3_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_11[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block3_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block3_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_downsample_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack3_downsample_pad (ZeroPad  (None, 34, 34, 128)  0          ['stack3_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack3_downsample_conv (Conv2D  (None, 16, 16, 320)  368960     ['stack3_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack3_block1_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack3_block1_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 256, 960)     0           ['stack3_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split (TFOpLambda)          [(None, 256, 320),   0           ['tf.reshape[0][0]']             
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][0]']               
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][1]']               
                                                                                                  
 tf.compat.v1.transpose (TFOpLa  (None, 10, 256, 32)  0          ['tf.reshape_1[0][0]']           
 mbda)                                                                                            
                                                                                                  
 tf.compat.v1.transpose_1 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_2[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda (Lambda)                (None, 10, 256, 256  0           ['tf.compat.v1.transpose[0][0]', 
                                )                                 'tf.compat.v1.transpose_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 10, 256, 256  0           ['lambda[0][0]']                 
                                )                                                                 
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][2]']               
                                                                                                  
 stack3_block1_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply[0][0]']       
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_2 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_1 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_2[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_3 (TFOp  (None, 256, 10, 32)  0          ['lambda_1[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_3[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block1_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack3_block1_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_4[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block1_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block1_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block1_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block1_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_12 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block1_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_12 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_12[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block1_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_12[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block1_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block1_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block1_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block2_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 256, 960)     0           ['stack3_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_1 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_5[0][0]']           
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][0]']             
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_4 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_6[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_5 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_7[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_2 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_4[0][0]'
                                )                                , 'tf.compat.v1.transpose_5[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_2[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][2]']             
                                                                                                  
 stack3_block2_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_1[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_6 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_8[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_3 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_6[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_7 (TFOp  (None, 256, 10, 32)  0          ['lambda_3[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_7[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block2_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block2_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_9[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block2_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block2_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block2_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_13 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block2_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_13 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_13[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block2_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_13[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block2_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block2_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block2_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block3_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_2 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_10[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][0]']             
                                                                                                  
 tf.reshape_12 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_8 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_11[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_9 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_12[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 lambda_4 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_8[0][0]'
                                )                                , 'tf.compat.v1.transpose_9[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_4[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_13 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][2]']             
                                                                                                  
 stack3_block3_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_2[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_10 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_13[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_5 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_10[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_11 (TFO  (None, 256, 10, 32)  0          ['lambda_5[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_14 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_11[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block3_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_14[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block3_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block3_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block3_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_14 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block3_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_14 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_14[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block3_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_14[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block3_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block3_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block3_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block3_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block4_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block4_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_15 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block4_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_3 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_15[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_16 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][0]']             
                                                                                                  
 tf.reshape_17 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_12 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_16[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_13 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_17[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_6 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_12[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_13[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_3 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_6[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_18 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][2]']             
                                                                                                  
 stack3_block4_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_3[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_14 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_18[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_7 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block4_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_14[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_15 (TFO  (None, 256, 10, 32)  0          ['lambda_7[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_19 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_15[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block4_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_19[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block4_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block4_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block4_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block4_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block4_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_15 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block4_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_15 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_15[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block4_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_15[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block4_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block4_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block4_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block4_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block4_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block4_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block5_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block5_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_20 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block5_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_4 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_20[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_21 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][0]']             
                                                                                                  
 tf.reshape_22 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_16 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_21[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_17 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_22[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_8 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_16[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_17[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_4 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_8[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_23 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][2]']             
                                                                                                  
 stack3_block5_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_4[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_18 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_23[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_9 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block5_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_18[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_19 (TFO  (None, 256, 10, 32)  0          ['lambda_9[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_24 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_19[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block5_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_24[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block5_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block5_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block5_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block5_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block5_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_16 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block5_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_16 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_16[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block5_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_16[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block5_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block5_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block5_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block5_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block5_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block5_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block6_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block6_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_25 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block6_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_5 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_25[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_26 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][0]']             
                                                                                                  
 tf.reshape_27 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_20 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_26[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_21 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_27[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_10 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_20[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_21[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_5 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_10[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_28 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][2]']             
                                                                                                  
 stack3_block6_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_5[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_22 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_28[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_11 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block6_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_22[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_23 (TFO  (None, 256, 10, 32)  0          ['lambda_11[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_29 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_23[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block6_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_29[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block6_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block6_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block6_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block6_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block6_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_17 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block6_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_17 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_17[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block6_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_17[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block6_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block6_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block6_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block6_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block6_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block6_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block7_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block7_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_30 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block7_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_6 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_30[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_31 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][0]']             
                                                                                                  
 tf.reshape_32 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_24 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_31[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_25 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_32[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_12 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_24[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_25[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_6 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_12[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_33 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][2]']             
                                                                                                  
 stack3_block7_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_6[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_26 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_33[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_13 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block7_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_26[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_27 (TFO  (None, 256, 10, 32)  0          ['lambda_13[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_34 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_27[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block7_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_34[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block7_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block7_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block7_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block7_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block7_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_18 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block7_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_18 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_18[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block7_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_18[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block7_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block7_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block7_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block7_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block7_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block7_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block8_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block8_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_35 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block8_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_7 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_35[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_36 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][0]']             
                                                                                                  
 tf.reshape_37 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_28 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_36[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_29 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_37[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_14 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_28[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_29[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_7 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_14[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_38 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][2]']             
                                                                                                  
 stack3_block8_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_7[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_30 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_38[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_15 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block8_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_30[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_31 (TFO  (None, 256, 10, 32)  0          ['lambda_15[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_39 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_31[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block8_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_39[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block8_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block8_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block8_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block8_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block8_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_19 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block8_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_19 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_19[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block8_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_19[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block8_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block8_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block8_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block8_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block8_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block8_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block9_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block9_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_40 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block9_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_8 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_40[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_41 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][0]']             
                                                                                                  
 tf.reshape_42 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_32 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_41[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_33 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_42[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_16 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_32[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_33[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_16[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_43 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][2]']             
                                                                                                  
 stack3_block9_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_8[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_34 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_43[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_17 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block9_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_34[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_35 (TFO  (None, 256, 10, 32)  0          ['lambda_17[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_44 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_35[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block9_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_44[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block9_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block9_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block9_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block9_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block9_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_20 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block9_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_20 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_20[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block9_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_20[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block9_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block9_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block9_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block9_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block9_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_downsample_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack4_downsample_pad (ZeroPad  (None, 18, 18, 320)  0          ['stack4_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack4_downsample_conv (Conv2D  (None, 8, 8, 512)   1475072     ['stack4_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack4_block1_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack4_block1_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_45 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_9 (TFOpLambda)        [(None, 64, 512),    0           ['tf.reshape_45[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_46 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][0]']             
                                                                                                  
 tf.reshape_47 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_36 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_46[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_37 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_47[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_18 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_36[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_37[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 16, 64, 64)  0           ['lambda_18[0][0]']              
 )                                                                                                
                                                                                                  
 tf.reshape_48 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][2]']             
                                                                                                  
 stack4_block1_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_9[0][0]']     
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_38 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_48[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_19 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_38[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_39 (TFO  (None, 64, 16, 32)  0           ['lambda_19[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_49 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_39[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack4_block1_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_49[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block1_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block1_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_21 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_21 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_21[0][0]']          
                                                                                                  
 stack4_block1_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_21[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block1_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block1_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block1_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block2_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_50 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_10 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_50[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_51 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][0]']            
                                                                                                  
 tf.reshape_52 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_40 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_51[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_41 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_52[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_20 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_40[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_41[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_10 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_20[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_53 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][2]']            
                                                                                                  
 stack4_block2_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_10[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_42 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_53[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_21 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_42[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_43 (TFO  (None, 64, 16, 32)  0           ['lambda_21[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_54 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_43[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block2_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_54[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block2_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block2_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_22 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_22 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_22[0][0]']          
                                                                                                  
 stack4_block2_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_22[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block2_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block2_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block2_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block3_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_55 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_11 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_55[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_56 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][0]']            
                                                                                                  
 tf.reshape_57 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_44 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_56[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_45 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_57[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_22 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_44[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_45[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_11 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_22[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_58 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][2]']            
                                                                                                  
 stack4_block3_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_11[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_46 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_58[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_23 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_46[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_47 (TFO  (None, 64, 16, 32)  0           ['lambda_23[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_59 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_47[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block3_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_59[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block3_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block3_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_23 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_23 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_23[0][0]']          
                                                                                                  
 stack4_block3_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_23[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 layer_normalization (LayerNorm  (None, 16, 16, 320)  640        ['stack3_block9_mlp_Dense_1[0][0]
 alization)                                                      ']                               
                                                                                                  
 stack4_block3_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 separable_conv2d (SeparableCon  (None, 16, 16, 320)  105600     ['layer_normalization[0][0]']    
 v2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)              (None, 8, 8, 320)    163840      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_5 (Conv2D)              (None, 8, 8, 320)    1474560     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 attention (Attention)          (None, 16, 16, 320)  0           ['separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]']       
                                                                                                  
 add_2 (Add)                    (None, 8, 8, 320)    0           ['conv2d_4[0][0]',               
                                                                  'conv2d_5[0][0]']               
                                                                                                  
 add_4 (Add)                    (None, 16, 16, 320)  0           ['attention[0][0]',              
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_1 (UpSampling2D)  (None, 16, 16, 320)  0          ['add_2[0][0]']                  
                                                                                                  
 dense (Dense)                  (None, 16, 16, 320)  102720      ['add_4[0][0]']                  
                                                                                                  
 batch_normalization_1 (BatchNo  (None, 16, 16, 320)  1280       ['up_sampling2d_1[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_1 (Dense)                (None, 16, 16, 320)  102720      ['dense[0][0]']                  
                                                                                                  
 activation_1 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_1[0][0]']  
                                                                                                  
 add_5 (Add)                    (None, 16, 16, 320)  0           ['add_4[0][0]',                  
                                                                  'dense_1[0][0]']                
                                                                                                  
 add_6 (Add)                    (None, 16, 16, 320)  0           ['activation_1[0][0]',           
                                                                  'add_5[0][0]']                  
                                                                                                  
 conv2d_8 (Conv2D)              (None, 16, 16, 320)  102720      ['add_6[0][0]']                  
                                                                                                  
 batch_normalization_2 (BatchNo  (None, 16, 16, 320)  1280       ['conv2d_8[0][0]']               
 rmalization)                                                                                     
                                                                                                  
 activation_2 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_2[0][0]']  
                                                                                                  
 conv2d (Conv2D)                (None, 8, 8, 512)    262144      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_1 (Conv2D)              (None, 8, 8, 512)    2359296     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_9 (Conv2D)              (None, 16, 16, 128)  40960       ['activation_2[0][0]']           
                                                                                                  
 conv2d_10 (Conv2D)             (None, 16, 16, 128)  368640      ['activation_2[0][0]']           
                                                                                                  
 add (Add)                      (None, 8, 8, 512)    0           ['conv2d[0][0]',                 
                                                                  'conv2d_1[0][0]']               
                                                                                                  
 layer_normalization_1 (LayerNo  (None, 32, 32, 128)  256        ['stack2_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 add_7 (Add)                    (None, 16, 16, 128)  0           ['conv2d_9[0][0]',               
                                                                  'conv2d_10[0][0]']              
                                                                                                  
 up_sampling2d (UpSampling2D)   (None, 32, 32, 512)  0           ['add[0][0]']                    
                                                                                                  
 separable_conv2d_1 (SeparableC  (None, 32, 32, 128)  17664      ['layer_normalization_1[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 up_sampling2d_2 (UpSampling2D)  (None, 32, 32, 128)  0          ['add_7[0][0]']                  
                                                                                                  
 batch_normalization (BatchNorm  (None, 32, 32, 512)  2048       ['up_sampling2d[0][0]']          
 alization)                                                                                       
                                                                                                  
 attention_1 (Attention)        (None, 32, 32, 128)  0           ['separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]']     
                                                                                                  
 batch_normalization_3 (BatchNo  (None, 32, 32, 128)  512        ['up_sampling2d_2[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 activation (Activation)        (None, 32, 32, 512)  0           ['batch_normalization[0][0]']    
                                                                                                  
 add_9 (Add)                    (None, 32, 32, 128)  0           ['attention_1[0][0]',            
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 activation_3 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_3[0][0]']  
                                                                                                  
 conv2d_13 (Conv2D)             (None, 32, 32, 128)  65664       ['activation[0][0]']             
                                                                                                  
 dense_2 (Dense)                (None, 32, 32, 128)  16512       ['add_9[0][0]']                  
                                                                                                  
 add_11 (Add)                   (None, 32, 32, 128)  0           ['activation_3[0][0]',           
                                                                  'conv2d_13[0][0]']              
                                                                                                  
 dense_3 (Dense)                (None, 32, 32, 128)  16512       ['dense_2[0][0]']                
                                                                                                  
 conv2d_14 (Conv2D)             (None, 32, 32, 128)  16512       ['add_11[0][0]']                 
                                                                                                  
 add_10 (Add)                   (None, 32, 32, 128)  0           ['add_9[0][0]',                  
                                                                  'dense_3[0][0]']                
                                                                                                  
 add_12 (Add)                   (None, 32, 32, 128)  0           ['conv2d_14[0][0]',              
                                                                  'add_10[0][0]']                 
                                                                                                  
 conv2d_15 (Conv2D)             (None, 32, 32, 128)  16512       ['add_12[0][0]']                 
                                                                                                  
 batch_normalization_4 (BatchNo  (None, 32, 32, 128)  512        ['conv2d_15[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 layer_normalization_2 (LayerNo  (None, 64, 64, 64)  128         ['stack1_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 activation_4 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_4[0][0]']  
                                                                                                  
 separable_conv2d_2 (SeparableC  (None, 64, 64, 64)  4736        ['layer_normalization_2[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 conv2d_20 (Conv2D)             (None, 32, 32, 64)   8192        ['activation_4[0][0]']           
                                                                                                  
 conv2d_21 (Conv2D)             (None, 32, 32, 64)   73728       ['activation_4[0][0]']           
                                                                                                  
 attention_2 (Attention)        (None, 64, 64, 64)   0           ['separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]']     
                                                                                                  
 add_15 (Add)                   (None, 32, 32, 64)   0           ['conv2d_20[0][0]',              
                                                                  'conv2d_21[0][0]']              
                                                                                                  
 add_17 (Add)                   (None, 64, 64, 64)   0           ['attention_2[0][0]',            
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_4 (UpSampling2D)  (None, 64, 64, 64)  0           ['add_15[0][0]']                 
                                                                                                  
 dense_4 (Dense)                (None, 64, 64, 64)   4160        ['add_17[0][0]']                 
                                                                                                  
 batch_normalization_6 (BatchNo  (None, 64, 64, 64)  256         ['up_sampling2d_4[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_5 (Dense)                (None, 64, 64, 64)   4160        ['dense_4[0][0]']                
                                                                                                  
 activation_6 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_6[0][0]']  
                                                                                                  
 add_18 (Add)                   (None, 64, 64, 64)   0           ['add_17[0][0]',                 
                                                                  'dense_5[0][0]']                
                                                                                                  
 add_19 (Add)                   (None, 64, 64, 64)   0           ['activation_6[0][0]',           
                                                                  'add_18[0][0]']                 
                                                                                                  
 conv2d_24 (Conv2D)             (None, 64, 64, 64)   4160        ['add_19[0][0]']                 
                                                                                                  
 conv2d_16 (Conv2D)             (None, 32, 32, 128)  16384       ['activation_4[0][0]']           
                                                                                                  
 conv2d_17 (Conv2D)             (None, 32, 32, 128)  147456      ['activation_4[0][0]']           
                                                                                                  
 batch_normalization_7 (BatchNo  (None, 64, 64, 64)  256         ['conv2d_24[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 add_13 (Add)                   (None, 32, 32, 128)  0           ['conv2d_16[0][0]',              
                                                                  'conv2d_17[0][0]']              
                                                                                                  
 activation_7 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_7[0][0]']  
                                                                                                  
 up_sampling2d_3 (UpSampling2D)  (None, 256, 256, 12  0          ['add_13[0][0]']                 
                                8)                                                                
                                                                                                  
 conv2d_26 (Conv2D)             (None, 64, 64, 32)   2048        ['activation_7[0][0]']           
                                                                                                  
 conv2d_27 (Conv2D)             (None, 64, 64, 32)   18432       ['activation_7[0][0]']           
                                                                                                  
 batch_normalization_5 (BatchNo  (None, 256, 256, 12  512        ['up_sampling2d_3[0][0]']        
 rmalization)                   8)                                                                
                                                                                                  
 add_20 (Add)                   (None, 64, 64, 32)   0           ['conv2d_26[0][0]',              
                                                                  'conv2d_27[0][0]']              
                                                                                                  
 activation_5 (Activation)      (None, 256, 256, 12  0           ['batch_normalization_5[0][0]']  
                                8)                                                                
                                                                                                  
 up_sampling2d_5 (UpSampling2D)  (None, 256, 256, 32  0          ['add_20[0][0]']                 
                                )                                                                 
                                                                                                  
 conv2d_25 (Conv2D)             (None, 256, 256, 32  4128        ['activation_5[0][0]']           
                                )                                                                 
                                                                                                  
 batch_normalization_9 (BatchNo  (None, 256, 256, 32  128        ['up_sampling2d_5[0][0]']        
 rmalization)                   )                                                                 
                                                                                                  
 batch_normalization_8 (BatchNo  (None, 256, 256, 32  128        ['conv2d_25[0][0]']              
 rmalization)                   )                                                                 
                                                                                                  
 activation_9 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_9[0][0]']  
                                )                                                                 
                                                                                                  
 activation_8 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_8[0][0]']  
                                )                                                                 
                                                                                                  
 add_22 (Add)                   (None, 256, 256, 32  0           ['activation_9[0][0]',           
                                )                                 'activation_8[0][0]']           
                                                                                                  
 conv2d_30 (Conv2D)             (None, 256, 256, 32  1056        ['add_22[0][0]']                 
                                )                                                                 
                                                                                                  
 batch_normalization_10 (BatchN  (None, 256, 256, 32  128        ['conv2d_30[0][0]']              
 ormalization)                  )                                                                 
                                                                                                  
 activation_10 (Activation)     (None, 256, 256, 32  0           ['batch_normalization_10[0][0]'] 
                                )                                                                 
                                                                                                  
 conv2d_31 (Conv2D)             (None, 256, 256, 1)  33          ['activation_10[0][0]']          
                                                                                                  
==================================================================================================
Total params: 28,765,713
Trainable params: 28,762,193
Non-trainable params: 3,520
__________________________________________________________________________________________________
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 stem_ (ZeroPadding2D)          (None, 260, 260, 3)  0           ['input_1[0][0]']                
                                                                                                  
 stem_conv (Conv2D)             (None, 64, 64, 64)   9472        ['stem_[0][0]']                  
                                                                                                  
 stem_ln (LayerNormalization)   (None, 64, 64, 64)   64          ['stem_conv[0][0]']              
                                                                                                  
 stack1_block1_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stem_ln[0][0]']                
 rmalization)                                                                                     
                                                                                                  
 stack1_block1_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu (TFOpLambda)        (None, 64, 64, 128)  0           ['stack1_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow (TFOpLambda)       (None, 64, 64, 128)  0           ['tf.nn.relu[0][0]']             
                                                                                                  
 stack1_block1_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow[0][0]']            
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block1_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block1_attn_output (Add  (None, 64, 64, 64)  0           ['stem_ln[0][0]',                
 )                                                                'stack1_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack1_block1_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block1_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_1 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_1 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_1[0][0]']           
                                                                                                  
 stack1_block1_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_1[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block1_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block1_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block2_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block2_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_2 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_2 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_2[0][0]']           
                                                                                                  
 stack1_block2_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_2[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block2_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block2_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block1_mlp_output[0][0]'
 )                                                               , 'stack1_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block2_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block2_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_3 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_3 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_3[0][0]']           
                                                                                                  
 stack1_block2_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_3[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block2_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block2_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block3_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block3_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_4 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_4 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_4[0][0]']           
                                                                                                  
 stack1_block3_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_4[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block3_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block3_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block2_mlp_output[0][0]'
 )                                                               , 'stack1_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block3_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block3_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_5 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_5 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_5[0][0]']           
                                                                                                  
 stack1_block3_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_5[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block3_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block3_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_downsample_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack2_downsample_pad (ZeroPad  (None, 66, 66, 64)  0           ['stack2_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack2_downsample_conv (Conv2D  (None, 32, 32, 128)  73856      ['stack2_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack2_block1_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack2_block1_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_6 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_6 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_6[0][0]']           
                                                                                                  
 stack2_block1_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_6[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block1_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block1_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_downsample_conv[0][0]', 
 )                                                                'stack2_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack2_block1_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block1_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_7 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_7 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_7[0][0]']           
                                                                                                  
 stack2_block1_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_7[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block1_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block1_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block2_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block2_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_8 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_8 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_8[0][0]']           
                                                                                                  
 stack2_block2_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_8[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block2_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block2_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block1_mlp_output[0][0]'
 )                                                               , 'stack2_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block2_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block2_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_9 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_9 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_9[0][0]']           
                                                                                                  
 stack2_block2_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_9[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block2_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block2_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block3_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block3_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_10 (TFOpLambda)     (None, 32, 32, 256)  0           ['stack2_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_10 (TFOpLambda)    (None, 32, 32, 256)  0           ['tf.nn.relu_10[0][0]']          
                                                                                                  
 stack2_block3_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_10[0][0]']         
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block3_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block3_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block2_mlp_output[0][0]'
 )                                                               , 'stack2_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block3_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block3_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_11 (TFOpLambda)     (None, 32, 32, 512)  0           ['stack2_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_11 (TFOpLambda)    (None, 32, 32, 512)  0           ['tf.nn.relu_11[0][0]']          
                                                                                                  
 stack2_block3_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_11[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block3_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block3_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_downsample_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack3_downsample_pad (ZeroPad  (None, 34, 34, 128)  0          ['stack3_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack3_downsample_conv (Conv2D  (None, 16, 16, 320)  368960     ['stack3_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack3_block1_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack3_block1_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 256, 960)     0           ['stack3_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split (TFOpLambda)          [(None, 256, 320),   0           ['tf.reshape[0][0]']             
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][0]']               
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][1]']               
                                                                                                  
 tf.compat.v1.transpose (TFOpLa  (None, 10, 256, 32)  0          ['tf.reshape_1[0][0]']           
 mbda)                                                                                            
                                                                                                  
 tf.compat.v1.transpose_1 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_2[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda (Lambda)                (None, 10, 256, 256  0           ['tf.compat.v1.transpose[0][0]', 
                                )                                 'tf.compat.v1.transpose_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 10, 256, 256  0           ['lambda[0][0]']                 
                                )                                                                 
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][2]']               
                                                                                                  
 stack3_block1_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply[0][0]']       
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_2 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_1 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_2[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_3 (TFOp  (None, 256, 10, 32)  0          ['lambda_1[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_3[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block1_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack3_block1_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_4[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block1_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block1_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block1_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block1_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_12 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block1_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_12 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_12[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block1_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_12[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block1_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block1_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block1_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block2_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 256, 960)     0           ['stack3_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_1 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_5[0][0]']           
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][0]']             
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_4 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_6[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_5 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_7[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_2 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_4[0][0]'
                                )                                , 'tf.compat.v1.transpose_5[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_2[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][2]']             
                                                                                                  
 stack3_block2_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_1[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_6 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_8[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_3 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_6[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_7 (TFOp  (None, 256, 10, 32)  0          ['lambda_3[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_7[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block2_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block2_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_9[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block2_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block2_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block2_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_13 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block2_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_13 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_13[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block2_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_13[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block2_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block2_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block2_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block3_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_2 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_10[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][0]']             
                                                                                                  
 tf.reshape_12 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_8 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_11[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_9 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_12[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 lambda_4 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_8[0][0]'
                                )                                , 'tf.compat.v1.transpose_9[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_4[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_13 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][2]']             
                                                                                                  
 stack3_block3_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_2[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_10 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_13[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_5 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_10[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_11 (TFO  (None, 256, 10, 32)  0          ['lambda_5[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_14 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_11[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block3_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_14[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block3_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block3_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block3_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_14 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block3_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_14 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_14[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block3_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_14[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block3_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block3_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block3_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block3_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block4_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block4_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_15 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block4_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_3 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_15[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_16 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][0]']             
                                                                                                  
 tf.reshape_17 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_12 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_16[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_13 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_17[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_6 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_12[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_13[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_3 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_6[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_18 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][2]']             
                                                                                                  
 stack3_block4_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_3[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_14 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_18[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_7 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block4_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_14[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_15 (TFO  (None, 256, 10, 32)  0          ['lambda_7[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_19 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_15[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block4_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_19[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block4_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block4_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block4_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block4_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block4_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_15 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block4_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_15 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_15[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block4_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_15[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block4_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block4_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block4_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block4_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block4_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block4_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block5_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block5_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_20 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block5_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_4 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_20[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_21 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][0]']             
                                                                                                  
 tf.reshape_22 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_16 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_21[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_17 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_22[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_8 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_16[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_17[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_4 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_8[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_23 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][2]']             
                                                                                                  
 stack3_block5_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_4[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_18 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_23[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_9 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block5_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_18[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_19 (TFO  (None, 256, 10, 32)  0          ['lambda_9[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_24 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_19[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block5_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_24[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block5_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block5_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block5_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block5_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block5_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_16 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block5_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_16 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_16[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block5_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_16[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block5_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block5_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block5_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block5_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block5_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block5_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block6_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block6_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_25 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block6_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_5 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_25[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_26 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][0]']             
                                                                                                  
 tf.reshape_27 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_20 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_26[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_21 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_27[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_10 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_20[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_21[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_5 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_10[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_28 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][2]']             
                                                                                                  
 stack3_block6_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_5[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_22 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_28[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_11 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block6_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_22[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_23 (TFO  (None, 256, 10, 32)  0          ['lambda_11[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_29 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_23[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block6_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_29[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block6_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block6_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block6_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block6_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block6_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_17 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block6_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_17 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_17[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block6_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_17[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block6_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block6_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block6_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block6_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block6_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block6_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block7_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block7_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_30 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block7_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_6 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_30[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_31 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][0]']             
                                                                                                  
 tf.reshape_32 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_24 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_31[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_25 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_32[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_12 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_24[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_25[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_6 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_12[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_33 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][2]']             
                                                                                                  
 stack3_block7_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_6[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_26 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_33[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_13 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block7_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_26[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_27 (TFO  (None, 256, 10, 32)  0          ['lambda_13[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_34 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_27[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block7_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_34[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block7_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block7_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block7_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block7_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block7_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_18 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block7_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_18 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_18[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block7_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_18[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block7_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block7_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block7_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block7_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block7_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block7_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block8_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block8_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_35 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block8_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_7 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_35[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_36 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][0]']             
                                                                                                  
 tf.reshape_37 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_28 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_36[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_29 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_37[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_14 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_28[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_29[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_7 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_14[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_38 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][2]']             
                                                                                                  
 stack3_block8_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_7[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_30 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_38[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_15 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block8_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_30[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_31 (TFO  (None, 256, 10, 32)  0          ['lambda_15[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_39 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_31[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block8_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_39[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block8_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block8_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block8_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block8_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block8_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_19 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block8_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_19 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_19[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block8_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_19[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block8_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block8_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block8_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block8_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block8_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block8_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block9_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block9_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_40 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block9_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_8 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_40[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_41 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][0]']             
                                                                                                  
 tf.reshape_42 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_32 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_41[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_33 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_42[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_16 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_32[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_33[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_16[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_43 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][2]']             
                                                                                                  
 stack3_block9_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_8[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_34 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_43[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_17 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block9_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_34[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_35 (TFO  (None, 256, 10, 32)  0          ['lambda_17[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_44 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_35[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block9_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_44[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block9_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block9_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block9_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block9_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block9_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_20 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block9_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_20 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_20[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block9_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_20[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block9_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block9_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block9_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block9_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block9_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_downsample_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack4_downsample_pad (ZeroPad  (None, 18, 18, 320)  0          ['stack4_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack4_downsample_conv (Conv2D  (None, 8, 8, 512)   1475072     ['stack4_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack4_block1_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack4_block1_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_45 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_9 (TFOpLambda)        [(None, 64, 512),    0           ['tf.reshape_45[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_46 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][0]']             
                                                                                                  
 tf.reshape_47 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_36 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_46[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_37 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_47[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_18 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_36[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_37[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 16, 64, 64)  0           ['lambda_18[0][0]']              
 )                                                                                                
                                                                                                  
 tf.reshape_48 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][2]']             
                                                                                                  
 stack4_block1_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_9[0][0]']     
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_38 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_48[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_19 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_38[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_39 (TFO  (None, 64, 16, 32)  0           ['lambda_19[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_49 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_39[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack4_block1_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_49[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block1_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block1_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_21 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_21 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_21[0][0]']          
                                                                                                  
 stack4_block1_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_21[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block1_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block1_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block1_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block2_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_50 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_10 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_50[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_51 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][0]']            
                                                                                                  
 tf.reshape_52 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_40 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_51[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_41 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_52[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_20 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_40[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_41[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_10 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_20[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_53 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][2]']            
                                                                                                  
 stack4_block2_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_10[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_42 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_53[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_21 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_42[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_43 (TFO  (None, 64, 16, 32)  0           ['lambda_21[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_54 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_43[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block2_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_54[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block2_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block2_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_22 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_22 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_22[0][0]']          
                                                                                                  
 stack4_block2_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_22[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block2_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block2_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block2_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block3_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_55 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_11 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_55[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_56 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][0]']            
                                                                                                  
 tf.reshape_57 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_44 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_56[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_45 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_57[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_22 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_44[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_45[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_11 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_22[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_58 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][2]']            
                                                                                                  
 stack4_block3_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_11[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_46 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_58[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_23 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_46[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_47 (TFO  (None, 64, 16, 32)  0           ['lambda_23[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_59 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_47[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block3_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_59[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block3_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block3_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_23 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_23 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_23[0][0]']          
                                                                                                  
 stack4_block3_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_23[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 layer_normalization (LayerNorm  (None, 16, 16, 320)  640        ['stack3_block9_mlp_Dense_1[0][0]
 alization)                                                      ']                               
                                                                                                  
 stack4_block3_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 separable_conv2d (SeparableCon  (None, 16, 16, 320)  105600     ['layer_normalization[0][0]']    
 v2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)              (None, 8, 8, 320)    163840      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_5 (Conv2D)              (None, 8, 8, 320)    1474560     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 attention (Attention)          (None, 16, 16, 320)  0           ['separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]']       
                                                                                                  
 add_2 (Add)                    (None, 8, 8, 320)    0           ['conv2d_4[0][0]',               
                                                                  'conv2d_5[0][0]']               
                                                                                                  
 add_4 (Add)                    (None, 16, 16, 320)  0           ['attention[0][0]',              
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_1 (UpSampling2D)  (None, 16, 16, 320)  0          ['add_2[0][0]']                  
                                                                                                  
 dense (Dense)                  (None, 16, 16, 320)  102720      ['add_4[0][0]']                  
                                                                                                  
 batch_normalization_1 (BatchNo  (None, 16, 16, 320)  1280       ['up_sampling2d_1[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_1 (Dense)                (None, 16, 16, 320)  102720      ['dense[0][0]']                  
                                                                                                  
 activation_1 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_1[0][0]']  
                                                                                                  
 add_5 (Add)                    (None, 16, 16, 320)  0           ['add_4[0][0]',                  
                                                                  'dense_1[0][0]']                
                                                                                                  
 add_6 (Add)                    (None, 16, 16, 320)  0           ['activation_1[0][0]',           
                                                                  'add_5[0][0]']                  
                                                                                                  
 conv2d_8 (Conv2D)              (None, 16, 16, 320)  102720      ['add_6[0][0]']                  
                                                                                                  
 batch_normalization_2 (BatchNo  (None, 16, 16, 320)  1280       ['conv2d_8[0][0]']               
 rmalization)                                                                                     
                                                                                                  
 activation_2 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_2[0][0]']  
                                                                                                  
 conv2d (Conv2D)                (None, 8, 8, 512)    262144      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_1 (Conv2D)              (None, 8, 8, 512)    2359296     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_9 (Conv2D)              (None, 16, 16, 128)  40960       ['activation_2[0][0]']           
                                                                                                  
 conv2d_10 (Conv2D)             (None, 16, 16, 128)  368640      ['activation_2[0][0]']           
                                                                                                  
 add (Add)                      (None, 8, 8, 512)    0           ['conv2d[0][0]',                 
                                                                  'conv2d_1[0][0]']               
                                                                                                  
 layer_normalization_1 (LayerNo  (None, 32, 32, 128)  256        ['stack2_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 add_7 (Add)                    (None, 16, 16, 128)  0           ['conv2d_9[0][0]',               
                                                                  'conv2d_10[0][0]']              
                                                                                                  
 up_sampling2d (UpSampling2D)   (None, 32, 32, 512)  0           ['add[0][0]']                    
                                                                                                  
 separable_conv2d_1 (SeparableC  (None, 32, 32, 128)  17664      ['layer_normalization_1[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 up_sampling2d_2 (UpSampling2D)  (None, 32, 32, 128)  0          ['add_7[0][0]']                  
                                                                                                  
 batch_normalization (BatchNorm  (None, 32, 32, 512)  2048       ['up_sampling2d[0][0]']          
 alization)                                                                                       
                                                                                                  
 attention_1 (Attention)        (None, 32, 32, 128)  0           ['separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]']     
                                                                                                  
 batch_normalization_3 (BatchNo  (None, 32, 32, 128)  512        ['up_sampling2d_2[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 activation (Activation)        (None, 32, 32, 512)  0           ['batch_normalization[0][0]']    
                                                                                                  
 add_9 (Add)                    (None, 32, 32, 128)  0           ['attention_1[0][0]',            
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 activation_3 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_3[0][0]']  
                                                                                                  
 conv2d_13 (Conv2D)             (None, 32, 32, 128)  65664       ['activation[0][0]']             
                                                                                                  
 dense_2 (Dense)                (None, 32, 32, 128)  16512       ['add_9[0][0]']                  
                                                                                                  
 add_11 (Add)                   (None, 32, 32, 128)  0           ['activation_3[0][0]',           
                                                                  'conv2d_13[0][0]']              
                                                                                                  
 dense_3 (Dense)                (None, 32, 32, 128)  16512       ['dense_2[0][0]']                
                                                                                                  
 conv2d_14 (Conv2D)             (None, 32, 32, 128)  16512       ['add_11[0][0]']                 
                                                                                                  
 add_10 (Add)                   (None, 32, 32, 128)  0           ['add_9[0][0]',                  
                                                                  'dense_3[0][0]']                
                                                                                                  
 add_12 (Add)                   (None, 32, 32, 128)  0           ['conv2d_14[0][0]',              
                                                                  'add_10[0][0]']                 
                                                                                                  
 conv2d_15 (Conv2D)             (None, 32, 32, 128)  16512       ['add_12[0][0]']                 
                                                                                                  
 batch_normalization_4 (BatchNo  (None, 32, 32, 128)  512        ['conv2d_15[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 layer_normalization_2 (LayerNo  (None, 64, 64, 64)  128         ['stack1_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 activation_4 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_4[0][0]']  
                                                                                                  
 separable_conv2d_2 (SeparableC  (None, 64, 64, 64)  4736        ['layer_normalization_2[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 conv2d_20 (Conv2D)             (None, 32, 32, 64)   8192        ['activation_4[0][0]']           
                                                                                                  
 conv2d_21 (Conv2D)             (None, 32, 32, 64)   73728       ['activation_4[0][0]']           
                                                                                                  
 attention_2 (Attention)        (None, 64, 64, 64)   0           ['separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]']     
                                                                                                  
 add_15 (Add)                   (None, 32, 32, 64)   0           ['conv2d_20[0][0]',              
                                                                  'conv2d_21[0][0]']              
                                                                                                  
 add_17 (Add)                   (None, 64, 64, 64)   0           ['attention_2[0][0]',            
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_4 (UpSampling2D)  (None, 64, 64, 64)  0           ['add_15[0][0]']                 
                                                                                                  
 dense_4 (Dense)                (None, 64, 64, 64)   4160        ['add_17[0][0]']                 
                                                                                                  
 batch_normalization_6 (BatchNo  (None, 64, 64, 64)  256         ['up_sampling2d_4[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_5 (Dense)                (None, 64, 64, 64)   4160        ['dense_4[0][0]']                
                                                                                                  
 activation_6 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_6[0][0]']  
                                                                                                  
 add_18 (Add)                   (None, 64, 64, 64)   0           ['add_17[0][0]',                 
                                                                  'dense_5[0][0]']                
                                                                                                  
 add_19 (Add)                   (None, 64, 64, 64)   0           ['activation_6[0][0]',           
                                                                  'add_18[0][0]']                 
                                                                                                  
 conv2d_24 (Conv2D)             (None, 64, 64, 64)   4160        ['add_19[0][0]']                 
                                                                                                  
 conv2d_16 (Conv2D)             (None, 32, 32, 128)  16384       ['activation_4[0][0]']           
                                                                                                  
 conv2d_17 (Conv2D)             (None, 32, 32, 128)  147456      ['activation_4[0][0]']           
                                                                                                  
 batch_normalization_7 (BatchNo  (None, 64, 64, 64)  256         ['conv2d_24[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 add_13 (Add)                   (None, 32, 32, 128)  0           ['conv2d_16[0][0]',              
                                                                  'conv2d_17[0][0]']              
                                                                                                  
 activation_7 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_7[0][0]']  
                                                                                                  
 up_sampling2d_3 (UpSampling2D)  (None, 256, 256, 12  0          ['add_13[0][0]']                 
                                8)                                                                
                                                                                                  
 conv2d_26 (Conv2D)             (None, 64, 64, 32)   2048        ['activation_7[0][0]']           
                                                                                                  
 conv2d_27 (Conv2D)             (None, 64, 64, 32)   18432       ['activation_7[0][0]']           
                                                                                                  
 batch_normalization_5 (BatchNo  (None, 256, 256, 12  512        ['up_sampling2d_3[0][0]']        
 rmalization)                   8)                                                                
                                                                                                  
 add_20 (Add)                   (None, 64, 64, 32)   0           ['conv2d_26[0][0]',              
                                                                  'conv2d_27[0][0]']              
                                                                                                  
 activation_5 (Activation)      (None, 256, 256, 12  0           ['batch_normalization_5[0][0]']  
                                8)                                                                
                                                                                                  
 up_sampling2d_5 (UpSampling2D)  (None, 256, 256, 32  0          ['add_20[0][0]']                 
                                )                                                                 
                                                                                                  
 conv2d_25 (Conv2D)             (None, 256, 256, 32  4128        ['activation_5[0][0]']           
                                )                                                                 
                                                                                                  
 batch_normalization_9 (BatchNo  (None, 256, 256, 32  128        ['up_sampling2d_5[0][0]']        
 rmalization)                   )                                                                 
                                                                                                  
 batch_normalization_8 (BatchNo  (None, 256, 256, 32  128        ['conv2d_25[0][0]']              
 rmalization)                   )                                                                 
                                                                                                  
 activation_9 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_9[0][0]']  
                                )                                                                 
                                                                                                  
 activation_8 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_8[0][0]']  
                                )                                                                 
                                                                                                  
 add_22 (Add)                   (None, 256, 256, 32  0           ['activation_9[0][0]',           
                                )                                 'activation_8[0][0]']           
                                                                                                  
 conv2d_30 (Conv2D)             (None, 256, 256, 32  1056        ['add_22[0][0]']                 
                                )                                                                 
                                                                                                  
 batch_normalization_10 (BatchN  (None, 256, 256, 32  128        ['conv2d_30[0][0]']              
 ormalization)                  )                                                                 
                                                                                                  
 activation_10 (Activation)     (None, 256, 256, 32  0           ['batch_normalization_10[0][0]'] 
                                )                                                                 
                                                                                                  
 conv2d_31 (Conv2D)             (None, 256, 256, 1)  33          ['activation_10[0][0]']          
                                                                                                  
==================================================================================================
Total params: 28,765,713
Trainable params: 28,762,193
Non-trainable params: 3,520
__________________________________________________________________________________________________
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 stem_ (ZeroPadding2D)          (None, 260, 260, 3)  0           ['input_1[0][0]']                
                                                                                                  
 stem_conv (Conv2D)             (None, 64, 64, 64)   9472        ['stem_[0][0]']                  
                                                                                                  
 stem_ln (LayerNormalization)   (None, 64, 64, 64)   64          ['stem_conv[0][0]']              
                                                                                                  
 stack1_block1_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stem_ln[0][0]']                
 rmalization)                                                                                     
                                                                                                  
 stack1_block1_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu (TFOpLambda)        (None, 64, 64, 128)  0           ['stack1_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow (TFOpLambda)       (None, 64, 64, 128)  0           ['tf.nn.relu[0][0]']             
                                                                                                  
 stack1_block1_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow[0][0]']            
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block1_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block1_attn_output (Add  (None, 64, 64, 64)  0           ['stem_ln[0][0]',                
 )                                                                'stack1_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack1_block1_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block1_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_1 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_1 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_1[0][0]']           
                                                                                                  
 stack1_block1_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_1[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block1_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block1_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block2_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block2_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_2 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_2 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_2[0][0]']           
                                                                                                  
 stack1_block2_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_2[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block2_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block2_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block1_mlp_output[0][0]'
 )                                                               , 'stack1_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block2_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block2_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_3 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_3 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_3[0][0]']           
                                                                                                  
 stack1_block2_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_3[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block2_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block2_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block3_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block3_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_4 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_4 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_4[0][0]']           
                                                                                                  
 stack1_block3_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_4[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block3_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block3_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block2_mlp_output[0][0]'
 )                                                               , 'stack1_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block3_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block3_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_5 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_5 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_5[0][0]']           
                                                                                                  
 stack1_block3_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_5[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block3_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block3_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_downsample_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack2_downsample_pad (ZeroPad  (None, 66, 66, 64)  0           ['stack2_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack2_downsample_conv (Conv2D  (None, 32, 32, 128)  73856      ['stack2_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack2_block1_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack2_block1_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_6 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_6 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_6[0][0]']           
                                                                                                  
 stack2_block1_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_6[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block1_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block1_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_downsample_conv[0][0]', 
 )                                                                'stack2_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack2_block1_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block1_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_7 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_7 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_7[0][0]']           
                                                                                                  
 stack2_block1_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_7[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block1_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block1_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block2_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block2_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_8 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_8 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_8[0][0]']           
                                                                                                  
 stack2_block2_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_8[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block2_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block2_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block1_mlp_output[0][0]'
 )                                                               , 'stack2_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block2_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block2_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_9 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_9 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_9[0][0]']           
                                                                                                  
 stack2_block2_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_9[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block2_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block2_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block3_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block3_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_10 (TFOpLambda)     (None, 32, 32, 256)  0           ['stack2_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_10 (TFOpLambda)    (None, 32, 32, 256)  0           ['tf.nn.relu_10[0][0]']          
                                                                                                  
 stack2_block3_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_10[0][0]']         
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block3_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block3_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block2_mlp_output[0][0]'
 )                                                               , 'stack2_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block3_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block3_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_11 (TFOpLambda)     (None, 32, 32, 512)  0           ['stack2_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_11 (TFOpLambda)    (None, 32, 32, 512)  0           ['tf.nn.relu_11[0][0]']          
                                                                                                  
 stack2_block3_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_11[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block3_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block3_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_downsample_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack3_downsample_pad (ZeroPad  (None, 34, 34, 128)  0          ['stack3_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack3_downsample_conv (Conv2D  (None, 16, 16, 320)  368960     ['stack3_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack3_block1_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack3_block1_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 256, 960)     0           ['stack3_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split (TFOpLambda)          [(None, 256, 320),   0           ['tf.reshape[0][0]']             
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][0]']               
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][1]']               
                                                                                                  
 tf.compat.v1.transpose (TFOpLa  (None, 10, 256, 32)  0          ['tf.reshape_1[0][0]']           
 mbda)                                                                                            
                                                                                                  
 tf.compat.v1.transpose_1 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_2[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda (Lambda)                (None, 10, 256, 256  0           ['tf.compat.v1.transpose[0][0]', 
                                )                                 'tf.compat.v1.transpose_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 10, 256, 256  0           ['lambda[0][0]']                 
                                )                                                                 
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][2]']               
                                                                                                  
 stack3_block1_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply[0][0]']       
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_2 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_1 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_2[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_3 (TFOp  (None, 256, 10, 32)  0          ['lambda_1[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_3[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block1_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack3_block1_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_4[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block1_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block1_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block1_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block1_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_12 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block1_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_12 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_12[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block1_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_12[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block1_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block1_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block1_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block2_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 256, 960)     0           ['stack3_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_1 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_5[0][0]']           
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][0]']             
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_4 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_6[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_5 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_7[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_2 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_4[0][0]'
                                )                                , 'tf.compat.v1.transpose_5[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_2[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][2]']             
                                                                                                  
 stack3_block2_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_1[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_6 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_8[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_3 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_6[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_7 (TFOp  (None, 256, 10, 32)  0          ['lambda_3[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_7[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block2_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block2_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_9[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block2_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block2_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block2_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_13 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block2_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_13 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_13[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block2_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_13[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block2_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block2_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block2_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block3_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_2 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_10[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][0]']             
                                                                                                  
 tf.reshape_12 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_8 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_11[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_9 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_12[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 lambda_4 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_8[0][0]'
                                )                                , 'tf.compat.v1.transpose_9[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_4[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_13 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][2]']             
                                                                                                  
 stack3_block3_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_2[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_10 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_13[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_5 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_10[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_11 (TFO  (None, 256, 10, 32)  0          ['lambda_5[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_14 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_11[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block3_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_14[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block3_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block3_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block3_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_14 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block3_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_14 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_14[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block3_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_14[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block3_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block3_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block3_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block3_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block4_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block4_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_15 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block4_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_3 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_15[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_16 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][0]']             
                                                                                                  
 tf.reshape_17 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_12 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_16[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_13 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_17[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_6 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_12[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_13[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_3 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_6[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_18 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][2]']             
                                                                                                  
 stack3_block4_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_3[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_14 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_18[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_7 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block4_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_14[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_15 (TFO  (None, 256, 10, 32)  0          ['lambda_7[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_19 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_15[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block4_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_19[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block4_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block4_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block4_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block4_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block4_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_15 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block4_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_15 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_15[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block4_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_15[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block4_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block4_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block4_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block4_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block4_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block4_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block5_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block5_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_20 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block5_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_4 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_20[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_21 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][0]']             
                                                                                                  
 tf.reshape_22 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_16 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_21[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_17 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_22[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_8 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_16[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_17[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_4 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_8[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_23 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][2]']             
                                                                                                  
 stack3_block5_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_4[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_18 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_23[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_9 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block5_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_18[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_19 (TFO  (None, 256, 10, 32)  0          ['lambda_9[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_24 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_19[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block5_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_24[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block5_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block5_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block5_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block5_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block5_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_16 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block5_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_16 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_16[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block5_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_16[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block5_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block5_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block5_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block5_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block5_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block5_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block6_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block6_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_25 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block6_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_5 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_25[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_26 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][0]']             
                                                                                                  
 tf.reshape_27 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_20 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_26[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_21 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_27[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_10 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_20[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_21[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_5 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_10[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_28 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][2]']             
                                                                                                  
 stack3_block6_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_5[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_22 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_28[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_11 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block6_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_22[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_23 (TFO  (None, 256, 10, 32)  0          ['lambda_11[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_29 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_23[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block6_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_29[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block6_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block6_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block6_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block6_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block6_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_17 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block6_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_17 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_17[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block6_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_17[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block6_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block6_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block6_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block6_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block6_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block6_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block7_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block7_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_30 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block7_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_6 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_30[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_31 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][0]']             
                                                                                                  
 tf.reshape_32 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_24 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_31[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_25 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_32[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_12 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_24[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_25[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_6 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_12[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_33 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][2]']             
                                                                                                  
 stack3_block7_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_6[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_26 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_33[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_13 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block7_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_26[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_27 (TFO  (None, 256, 10, 32)  0          ['lambda_13[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_34 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_27[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block7_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_34[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block7_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block7_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block7_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block7_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block7_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_18 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block7_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_18 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_18[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block7_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_18[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block7_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block7_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block7_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block7_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block7_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block7_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block8_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block8_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_35 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block8_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_7 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_35[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_36 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][0]']             
                                                                                                  
 tf.reshape_37 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_28 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_36[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_29 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_37[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_14 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_28[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_29[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_7 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_14[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_38 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][2]']             
                                                                                                  
 stack3_block8_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_7[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_30 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_38[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_15 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block8_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_30[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_31 (TFO  (None, 256, 10, 32)  0          ['lambda_15[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_39 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_31[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block8_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_39[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block8_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block8_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block8_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block8_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block8_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_19 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block8_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_19 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_19[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block8_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_19[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block8_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block8_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block8_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block8_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block8_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block8_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block9_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block9_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_40 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block9_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_8 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_40[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_41 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][0]']             
                                                                                                  
 tf.reshape_42 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_32 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_41[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_33 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_42[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_16 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_32[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_33[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_16[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_43 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][2]']             
                                                                                                  
 stack3_block9_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_8[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_34 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_43[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_17 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block9_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_34[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_35 (TFO  (None, 256, 10, 32)  0          ['lambda_17[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_44 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_35[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block9_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_44[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block9_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block9_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block9_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block9_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block9_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_20 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block9_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_20 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_20[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block9_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_20[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block9_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block9_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block9_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block9_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block9_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_downsample_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack4_downsample_pad (ZeroPad  (None, 18, 18, 320)  0          ['stack4_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack4_downsample_conv (Conv2D  (None, 8, 8, 512)   1475072     ['stack4_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack4_block1_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack4_block1_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_45 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_9 (TFOpLambda)        [(None, 64, 512),    0           ['tf.reshape_45[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_46 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][0]']             
                                                                                                  
 tf.reshape_47 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_36 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_46[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_37 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_47[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_18 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_36[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_37[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 16, 64, 64)  0           ['lambda_18[0][0]']              
 )                                                                                                
                                                                                                  
 tf.reshape_48 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][2]']             
                                                                                                  
 stack4_block1_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_9[0][0]']     
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_38 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_48[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_19 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_38[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_39 (TFO  (None, 64, 16, 32)  0           ['lambda_19[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_49 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_39[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack4_block1_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_49[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block1_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block1_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_21 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_21 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_21[0][0]']          
                                                                                                  
 stack4_block1_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_21[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block1_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block1_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block1_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block2_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_50 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_10 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_50[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_51 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][0]']            
                                                                                                  
 tf.reshape_52 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_40 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_51[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_41 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_52[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_20 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_40[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_41[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_10 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_20[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_53 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][2]']            
                                                                                                  
 stack4_block2_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_10[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_42 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_53[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_21 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_42[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_43 (TFO  (None, 64, 16, 32)  0           ['lambda_21[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_54 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_43[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block2_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_54[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block2_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block2_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_22 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_22 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_22[0][0]']          
                                                                                                  
 stack4_block2_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_22[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block2_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block2_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block2_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block3_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_55 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_11 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_55[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_56 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][0]']            
                                                                                                  
 tf.reshape_57 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_44 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_56[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_45 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_57[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_22 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_44[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_45[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_11 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_22[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_58 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][2]']            
                                                                                                  
 stack4_block3_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_11[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_46 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_58[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_23 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_46[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_47 (TFO  (None, 64, 16, 32)  0           ['lambda_23[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_59 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_47[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block3_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_59[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block3_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block3_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_23 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_23 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_23[0][0]']          
                                                                                                  
 stack4_block3_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_23[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 layer_normalization (LayerNorm  (None, 16, 16, 320)  640        ['stack3_block9_mlp_Dense_1[0][0]
 alization)                                                      ']                               
                                                                                                  
 stack4_block3_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 separable_conv2d (SeparableCon  (None, 16, 16, 320)  105600     ['layer_normalization[0][0]']    
 v2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)              (None, 8, 8, 320)    163840      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_5 (Conv2D)              (None, 8, 8, 320)    1474560     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 attention (Attention)          (None, 16, 16, 320)  0           ['separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]']       
                                                                                                  
 add_2 (Add)                    (None, 8, 8, 320)    0           ['conv2d_4[0][0]',               
                                                                  'conv2d_5[0][0]']               
                                                                                                  
 add_4 (Add)                    (None, 16, 16, 320)  0           ['attention[0][0]',              
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_1 (UpSampling2D)  (None, 16, 16, 320)  0          ['add_2[0][0]']                  
                                                                                                  
 dense (Dense)                  (None, 16, 16, 320)  102720      ['add_4[0][0]']                  
                                                                                                  
 batch_normalization_1 (BatchNo  (None, 16, 16, 320)  1280       ['up_sampling2d_1[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_1 (Dense)                (None, 16, 16, 320)  102720      ['dense[0][0]']                  
                                                                                                  
 activation_1 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_1[0][0]']  
                                                                                                  
 add_5 (Add)                    (None, 16, 16, 320)  0           ['add_4[0][0]',                  
                                                                  'dense_1[0][0]']                
                                                                                                  
 add_6 (Add)                    (None, 16, 16, 320)  0           ['activation_1[0][0]',           
                                                                  'add_5[0][0]']                  
                                                                                                  
 conv2d_8 (Conv2D)              (None, 16, 16, 320)  102720      ['add_6[0][0]']                  
                                                                                                  
 batch_normalization_2 (BatchNo  (None, 16, 16, 320)  1280       ['conv2d_8[0][0]']               
 rmalization)                                                                                     
                                                                                                  
 activation_2 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_2[0][0]']  
                                                                                                  
 conv2d (Conv2D)                (None, 8, 8, 512)    262144      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_1 (Conv2D)              (None, 8, 8, 512)    2359296     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_9 (Conv2D)              (None, 16, 16, 128)  40960       ['activation_2[0][0]']           
                                                                                                  
 conv2d_10 (Conv2D)             (None, 16, 16, 128)  368640      ['activation_2[0][0]']           
                                                                                                  
 add (Add)                      (None, 8, 8, 512)    0           ['conv2d[0][0]',                 
                                                                  'conv2d_1[0][0]']               
                                                                                                  
 layer_normalization_1 (LayerNo  (None, 32, 32, 128)  256        ['stack2_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 add_7 (Add)                    (None, 16, 16, 128)  0           ['conv2d_9[0][0]',               
                                                                  'conv2d_10[0][0]']              
                                                                                                  
 up_sampling2d (UpSampling2D)   (None, 32, 32, 512)  0           ['add[0][0]']                    
                                                                                                  
 separable_conv2d_1 (SeparableC  (None, 32, 32, 128)  17664      ['layer_normalization_1[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 up_sampling2d_2 (UpSampling2D)  (None, 32, 32, 128)  0          ['add_7[0][0]']                  
                                                                                                  
 batch_normalization (BatchNorm  (None, 32, 32, 512)  2048       ['up_sampling2d[0][0]']          
 alization)                                                                                       
                                                                                                  
 attention_1 (Attention)        (None, 32, 32, 128)  0           ['separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]']     
                                                                                                  
 batch_normalization_3 (BatchNo  (None, 32, 32, 128)  512        ['up_sampling2d_2[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 activation (Activation)        (None, 32, 32, 512)  0           ['batch_normalization[0][0]']    
                                                                                                  
 add_9 (Add)                    (None, 32, 32, 128)  0           ['attention_1[0][0]',            
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 activation_3 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_3[0][0]']  
                                                                                                  
 conv2d_13 (Conv2D)             (None, 32, 32, 128)  65664       ['activation[0][0]']             
                                                                                                  
 dense_2 (Dense)                (None, 32, 32, 128)  16512       ['add_9[0][0]']                  
                                                                                                  
 add_11 (Add)                   (None, 32, 32, 128)  0           ['activation_3[0][0]',           
                                                                  'conv2d_13[0][0]']              
                                                                                                  
 dense_3 (Dense)                (None, 32, 32, 128)  16512       ['dense_2[0][0]']                
                                                                                                  
 conv2d_14 (Conv2D)             (None, 32, 32, 128)  16512       ['add_11[0][0]']                 
                                                                                                  
 add_10 (Add)                   (None, 32, 32, 128)  0           ['add_9[0][0]',                  
                                                                  'dense_3[0][0]']                
                                                                                                  
 add_12 (Add)                   (None, 32, 32, 128)  0           ['conv2d_14[0][0]',              
                                                                  'add_10[0][0]']                 
                                                                                                  
 conv2d_15 (Conv2D)             (None, 32, 32, 128)  16512       ['add_12[0][0]']                 
                                                                                                  
 batch_normalization_4 (BatchNo  (None, 32, 32, 128)  512        ['conv2d_15[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 layer_normalization_2 (LayerNo  (None, 64, 64, 64)  128         ['stack1_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 activation_4 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_4[0][0]']  
                                                                                                  
 separable_conv2d_2 (SeparableC  (None, 64, 64, 64)  4736        ['layer_normalization_2[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 conv2d_20 (Conv2D)             (None, 32, 32, 64)   8192        ['activation_4[0][0]']           
                                                                                                  
 conv2d_21 (Conv2D)             (None, 32, 32, 64)   73728       ['activation_4[0][0]']           
                                                                                                  
 attention_2 (Attention)        (None, 64, 64, 64)   0           ['separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]']     
                                                                                                  
 add_15 (Add)                   (None, 32, 32, 64)   0           ['conv2d_20[0][0]',              
                                                                  'conv2d_21[0][0]']              
                                                                                                  
 add_17 (Add)                   (None, 64, 64, 64)   0           ['attention_2[0][0]',            
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_4 (UpSampling2D)  (None, 64, 64, 64)  0           ['add_15[0][0]']                 
                                                                                                  
 dense_4 (Dense)                (None, 64, 64, 64)   4160        ['add_17[0][0]']                 
                                                                                                  
 batch_normalization_6 (BatchNo  (None, 64, 64, 64)  256         ['up_sampling2d_4[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_5 (Dense)                (None, 64, 64, 64)   4160        ['dense_4[0][0]']                
                                                                                                  
 activation_6 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_6[0][0]']  
                                                                                                  
 add_18 (Add)                   (None, 64, 64, 64)   0           ['add_17[0][0]',                 
                                                                  'dense_5[0][0]']                
                                                                                                  
 add_19 (Add)                   (None, 64, 64, 64)   0           ['activation_6[0][0]',           
                                                                  'add_18[0][0]']                 
                                                                                                  
 conv2d_24 (Conv2D)             (None, 64, 64, 64)   4160        ['add_19[0][0]']                 
                                                                                                  
 conv2d_16 (Conv2D)             (None, 32, 32, 128)  16384       ['activation_4[0][0]']           
                                                                                                  
 conv2d_17 (Conv2D)             (None, 32, 32, 128)  147456      ['activation_4[0][0]']           
                                                                                                  
 batch_normalization_7 (BatchNo  (None, 64, 64, 64)  256         ['conv2d_24[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 add_13 (Add)                   (None, 32, 32, 128)  0           ['conv2d_16[0][0]',              
                                                                  'conv2d_17[0][0]']              
                                                                                                  
 activation_7 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_7[0][0]']  
                                                                                                  
 up_sampling2d_3 (UpSampling2D)  (None, 256, 256, 12  0          ['add_13[0][0]']                 
                                8)                                                                
                                                                                                  
 conv2d_26 (Conv2D)             (None, 64, 64, 32)   2048        ['activation_7[0][0]']           
                                                                                                  
 conv2d_27 (Conv2D)             (None, 64, 64, 32)   18432       ['activation_7[0][0]']           
                                                                                                  
 batch_normalization_5 (BatchNo  (None, 256, 256, 12  512        ['up_sampling2d_3[0][0]']        
 rmalization)                   8)                                                                
                                                                                                  
 add_20 (Add)                   (None, 64, 64, 32)   0           ['conv2d_26[0][0]',              
                                                                  'conv2d_27[0][0]']              
                                                                                                  
 activation_5 (Activation)      (None, 256, 256, 12  0           ['batch_normalization_5[0][0]']  
                                8)                                                                
                                                                                                  
 up_sampling2d_5 (UpSampling2D)  (None, 256, 256, 32  0          ['add_20[0][0]']                 
                                )                                                                 
                                                                                                  
 conv2d_25 (Conv2D)             (None, 256, 256, 32  4128        ['activation_5[0][0]']           
                                )                                                                 
                                                                                                  
 batch_normalization_9 (BatchNo  (None, 256, 256, 32  128        ['up_sampling2d_5[0][0]']        
 rmalization)                   )                                                                 
                                                                                                  
 batch_normalization_8 (BatchNo  (None, 256, 256, 32  128        ['conv2d_25[0][0]']              
 rmalization)                   )                                                                 
                                                                                                  
 activation_9 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_9[0][0]']  
                                )                                                                 
                                                                                                  
 activation_8 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_8[0][0]']  
                                )                                                                 
                                                                                                  
 add_22 (Add)                   (None, 256, 256, 32  0           ['activation_9[0][0]',           
                                )                                 'activation_8[0][0]']           
                                                                                                  
 conv2d_30 (Conv2D)             (None, 256, 256, 32  1056        ['add_22[0][0]']                 
                                )                                                                 
                                                                                                  
 batch_normalization_10 (BatchN  (None, 256, 256, 32  128        ['conv2d_30[0][0]']              
 ormalization)                  )                                                                 
                                                                                                  
 activation_10 (Activation)     (None, 256, 256, 32  0           ['batch_normalization_10[0][0]'] 
                                )                                                                 
                                                                                                  
 conv2d_31 (Conv2D)             (None, 256, 256, 1)  33          ['activation_10[0][0]']          
                                                                                                  
==================================================================================================
Total params: 28,765,713
Trainable params: 28,762,193
Non-trainable params: 3,520
__________________________________________________________________________________________________
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 stem_ (ZeroPadding2D)          (None, 260, 260, 3)  0           ['input_1[0][0]']                
                                                                                                  
 stem_conv (Conv2D)             (None, 64, 64, 64)   9472        ['stem_[0][0]']                  
                                                                                                  
 stem_ln (LayerNormalization)   (None, 64, 64, 64)   64          ['stem_conv[0][0]']              
                                                                                                  
 stack1_block1_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stem_ln[0][0]']                
 rmalization)                                                                                     
                                                                                                  
 stack1_block1_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu (TFOpLambda)        (None, 64, 64, 128)  0           ['stack1_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow (TFOpLambda)       (None, 64, 64, 128)  0           ['tf.nn.relu[0][0]']             
                                                                                                  
 stack1_block1_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow[0][0]']            
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block1_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block1_attn_output (Add  (None, 64, 64, 64)  0           ['stem_ln[0][0]',                
 )                                                                'stack1_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack1_block1_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block1_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_1 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_1 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_1[0][0]']           
                                                                                                  
 stack1_block1_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_1[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block1_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block1_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block2_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block2_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_2 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_2 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_2[0][0]']           
                                                                                                  
 stack1_block2_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_2[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block2_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block2_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block1_mlp_output[0][0]'
 )                                                               , 'stack1_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block2_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block2_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_3 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_3 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_3[0][0]']           
                                                                                                  
 stack1_block2_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_3[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block2_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block2_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block3_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block3_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_4 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_4 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_4[0][0]']           
                                                                                                  
 stack1_block3_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_4[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block3_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block3_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block2_mlp_output[0][0]'
 )                                                               , 'stack1_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block3_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block3_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_5 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_5 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_5[0][0]']           
                                                                                                  
 stack1_block3_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_5[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block3_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block3_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_downsample_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack2_downsample_pad (ZeroPad  (None, 66, 66, 64)  0           ['stack2_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack2_downsample_conv (Conv2D  (None, 32, 32, 128)  73856      ['stack2_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack2_block1_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack2_block1_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_6 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_6 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_6[0][0]']           
                                                                                                  
 stack2_block1_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_6[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block1_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block1_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_downsample_conv[0][0]', 
 )                                                                'stack2_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack2_block1_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block1_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_7 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_7 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_7[0][0]']           
                                                                                                  
 stack2_block1_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_7[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block1_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block1_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block2_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block2_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_8 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_8 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_8[0][0]']           
                                                                                                  
 stack2_block2_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_8[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block2_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block2_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block1_mlp_output[0][0]'
 )                                                               , 'stack2_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block2_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block2_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_9 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_9 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_9[0][0]']           
                                                                                                  
 stack2_block2_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_9[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block2_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block2_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block3_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block3_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_10 (TFOpLambda)     (None, 32, 32, 256)  0           ['stack2_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_10 (TFOpLambda)    (None, 32, 32, 256)  0           ['tf.nn.relu_10[0][0]']          
                                                                                                  
 stack2_block3_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_10[0][0]']         
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block3_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block3_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block2_mlp_output[0][0]'
 )                                                               , 'stack2_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block3_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block3_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_11 (TFOpLambda)     (None, 32, 32, 512)  0           ['stack2_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_11 (TFOpLambda)    (None, 32, 32, 512)  0           ['tf.nn.relu_11[0][0]']          
                                                                                                  
 stack2_block3_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_11[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block3_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block3_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_downsample_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack3_downsample_pad (ZeroPad  (None, 34, 34, 128)  0          ['stack3_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack3_downsample_conv (Conv2D  (None, 16, 16, 320)  368960     ['stack3_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack3_block1_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack3_block1_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 256, 960)     0           ['stack3_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split (TFOpLambda)          [(None, 256, 320),   0           ['tf.reshape[0][0]']             
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][0]']               
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][1]']               
                                                                                                  
 tf.compat.v1.transpose (TFOpLa  (None, 10, 256, 32)  0          ['tf.reshape_1[0][0]']           
 mbda)                                                                                            
                                                                                                  
 tf.compat.v1.transpose_1 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_2[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda (Lambda)                (None, 10, 256, 256  0           ['tf.compat.v1.transpose[0][0]', 
                                )                                 'tf.compat.v1.transpose_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 10, 256, 256  0           ['lambda[0][0]']                 
                                )                                                                 
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][2]']               
                                                                                                  
 stack3_block1_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply[0][0]']       
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_2 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_1 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_2[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_3 (TFOp  (None, 256, 10, 32)  0          ['lambda_1[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_3[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block1_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack3_block1_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_4[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block1_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block1_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block1_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block1_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_12 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block1_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_12 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_12[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block1_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_12[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block1_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block1_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block1_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block2_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 256, 960)     0           ['stack3_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_1 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_5[0][0]']           
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][0]']             
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_4 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_6[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_5 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_7[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_2 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_4[0][0]'
                                )                                , 'tf.compat.v1.transpose_5[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_2[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][2]']             
                                                                                                  
 stack3_block2_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_1[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_6 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_8[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_3 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_6[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_7 (TFOp  (None, 256, 10, 32)  0          ['lambda_3[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_7[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block2_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block2_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_9[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block2_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block2_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block2_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_13 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block2_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_13 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_13[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block2_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_13[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block2_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block2_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block2_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block3_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_2 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_10[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][0]']             
                                                                                                  
 tf.reshape_12 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_8 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_11[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_9 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_12[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 lambda_4 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_8[0][0]'
                                )                                , 'tf.compat.v1.transpose_9[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_4[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_13 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][2]']             
                                                                                                  
 stack3_block3_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_2[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_10 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_13[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_5 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_10[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_11 (TFO  (None, 256, 10, 32)  0          ['lambda_5[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_14 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_11[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block3_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_14[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block3_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block3_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block3_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_14 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block3_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_14 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_14[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block3_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_14[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block3_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block3_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block3_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block3_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block4_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block4_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_15 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block4_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_3 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_15[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_16 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][0]']             
                                                                                                  
 tf.reshape_17 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_12 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_16[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_13 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_17[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_6 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_12[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_13[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_3 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_6[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_18 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][2]']             
                                                                                                  
 stack3_block4_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_3[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_14 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_18[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_7 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block4_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_14[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_15 (TFO  (None, 256, 10, 32)  0          ['lambda_7[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_19 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_15[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block4_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_19[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block4_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block4_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block4_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block4_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block4_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_15 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block4_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_15 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_15[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block4_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_15[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block4_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block4_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block4_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block4_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block4_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block4_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block5_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block5_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_20 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block5_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_4 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_20[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_21 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][0]']             
                                                                                                  
 tf.reshape_22 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_16 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_21[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_17 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_22[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_8 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_16[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_17[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_4 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_8[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_23 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][2]']             
                                                                                                  
 stack3_block5_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_4[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_18 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_23[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_9 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block5_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_18[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_19 (TFO  (None, 256, 10, 32)  0          ['lambda_9[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_24 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_19[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block5_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_24[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block5_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block5_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block5_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block5_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block5_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_16 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block5_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_16 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_16[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block5_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_16[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block5_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block5_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block5_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block5_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block5_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block5_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block6_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block6_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_25 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block6_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_5 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_25[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_26 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][0]']             
                                                                                                  
 tf.reshape_27 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_20 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_26[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_21 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_27[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_10 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_20[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_21[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_5 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_10[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_28 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][2]']             
                                                                                                  
 stack3_block6_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_5[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_22 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_28[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_11 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block6_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_22[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_23 (TFO  (None, 256, 10, 32)  0          ['lambda_11[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_29 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_23[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block6_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_29[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block6_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block6_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block6_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block6_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block6_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_17 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block6_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_17 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_17[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block6_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_17[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block6_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block6_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block6_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block6_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block6_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block6_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block7_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block7_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_30 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block7_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_6 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_30[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_31 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][0]']             
                                                                                                  
 tf.reshape_32 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_24 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_31[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_25 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_32[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_12 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_24[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_25[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_6 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_12[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_33 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][2]']             
                                                                                                  
 stack3_block7_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_6[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_26 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_33[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_13 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block7_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_26[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_27 (TFO  (None, 256, 10, 32)  0          ['lambda_13[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_34 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_27[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block7_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_34[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block7_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block7_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block7_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block7_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block7_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_18 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block7_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_18 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_18[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block7_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_18[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block7_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block7_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block7_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block7_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block7_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block7_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block8_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block8_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_35 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block8_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_7 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_35[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_36 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][0]']             
                                                                                                  
 tf.reshape_37 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_28 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_36[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_29 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_37[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_14 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_28[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_29[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_7 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_14[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_38 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][2]']             
                                                                                                  
 stack3_block8_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_7[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_30 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_38[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_15 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block8_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_30[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_31 (TFO  (None, 256, 10, 32)  0          ['lambda_15[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_39 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_31[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block8_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_39[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block8_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block8_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block8_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block8_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block8_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_19 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block8_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_19 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_19[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block8_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_19[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block8_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block8_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block8_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block8_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block8_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block8_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block9_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block9_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_40 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block9_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_8 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_40[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_41 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][0]']             
                                                                                                  
 tf.reshape_42 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_32 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_41[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_33 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_42[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_16 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_32[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_33[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_16[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_43 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][2]']             
                                                                                                  
 stack3_block9_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_8[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_34 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_43[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_17 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block9_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_34[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_35 (TFO  (None, 256, 10, 32)  0          ['lambda_17[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_44 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_35[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block9_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_44[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block9_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block9_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block9_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block9_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block9_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_20 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block9_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_20 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_20[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block9_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_20[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block9_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block9_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block9_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block9_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block9_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_downsample_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack4_downsample_pad (ZeroPad  (None, 18, 18, 320)  0          ['stack4_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack4_downsample_conv (Conv2D  (None, 8, 8, 512)   1475072     ['stack4_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack4_block1_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack4_block1_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_45 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_9 (TFOpLambda)        [(None, 64, 512),    0           ['tf.reshape_45[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_46 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][0]']             
                                                                                                  
 tf.reshape_47 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_36 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_46[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_37 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_47[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_18 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_36[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_37[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 16, 64, 64)  0           ['lambda_18[0][0]']              
 )                                                                                                
                                                                                                  
 tf.reshape_48 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][2]']             
                                                                                                  
 stack4_block1_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_9[0][0]']     
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_38 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_48[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_19 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_38[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_39 (TFO  (None, 64, 16, 32)  0           ['lambda_19[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_49 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_39[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack4_block1_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_49[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block1_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block1_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_21 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_21 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_21[0][0]']          
                                                                                                  
 stack4_block1_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_21[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block1_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block1_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block1_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block2_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_50 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_10 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_50[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_51 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][0]']            
                                                                                                  
 tf.reshape_52 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_40 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_51[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_41 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_52[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_20 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_40[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_41[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_10 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_20[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_53 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][2]']            
                                                                                                  
 stack4_block2_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_10[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_42 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_53[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_21 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_42[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_43 (TFO  (None, 64, 16, 32)  0           ['lambda_21[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_54 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_43[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block2_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_54[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block2_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block2_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_22 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_22 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_22[0][0]']          
                                                                                                  
 stack4_block2_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_22[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block2_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block2_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block2_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block3_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_55 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_11 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_55[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_56 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][0]']            
                                                                                                  
 tf.reshape_57 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_44 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_56[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_45 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_57[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_22 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_44[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_45[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_11 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_22[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_58 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][2]']            
                                                                                                  
 stack4_block3_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_11[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_46 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_58[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_23 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_46[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_47 (TFO  (None, 64, 16, 32)  0           ['lambda_23[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_59 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_47[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block3_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_59[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block3_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block3_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_23 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_23 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_23[0][0]']          
                                                                                                  
 stack4_block3_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_23[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 layer_normalization (LayerNorm  (None, 16, 16, 320)  640        ['stack3_block9_mlp_Dense_1[0][0]
 alization)                                                      ']                               
                                                                                                  
 stack4_block3_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 separable_conv2d (SeparableCon  (None, 16, 16, 320)  105600     ['layer_normalization[0][0]']    
 v2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)              (None, 8, 8, 320)    163840      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_5 (Conv2D)              (None, 8, 8, 320)    1474560     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 attention (Attention)          (None, 16, 16, 320)  0           ['separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]']       
                                                                                                  
 add_2 (Add)                    (None, 8, 8, 320)    0           ['conv2d_4[0][0]',               
                                                                  'conv2d_5[0][0]']               
                                                                                                  
 add_4 (Add)                    (None, 16, 16, 320)  0           ['attention[0][0]',              
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_1 (UpSampling2D)  (None, 16, 16, 320)  0          ['add_2[0][0]']                  
                                                                                                  
 dense (Dense)                  (None, 16, 16, 320)  102720      ['add_4[0][0]']                  
                                                                                                  
 batch_normalization_1 (BatchNo  (None, 16, 16, 320)  1280       ['up_sampling2d_1[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_1 (Dense)                (None, 16, 16, 320)  102720      ['dense[0][0]']                  
                                                                                                  
 activation_1 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_1[0][0]']  
                                                                                                  
 add_5 (Add)                    (None, 16, 16, 320)  0           ['add_4[0][0]',                  
                                                                  'dense_1[0][0]']                
                                                                                                  
 add_6 (Add)                    (None, 16, 16, 320)  0           ['activation_1[0][0]',           
                                                                  'add_5[0][0]']                  
                                                                                                  
 conv2d_8 (Conv2D)              (None, 16, 16, 320)  102720      ['add_6[0][0]']                  
                                                                                                  
 batch_normalization_2 (BatchNo  (None, 16, 16, 320)  1280       ['conv2d_8[0][0]']               
 rmalization)                                                                                     
                                                                                                  
 activation_2 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_2[0][0]']  
                                                                                                  
 conv2d (Conv2D)                (None, 8, 8, 512)    262144      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_1 (Conv2D)              (None, 8, 8, 512)    2359296     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_9 (Conv2D)              (None, 16, 16, 128)  40960       ['activation_2[0][0]']           
                                                                                                  
 conv2d_10 (Conv2D)             (None, 16, 16, 128)  368640      ['activation_2[0][0]']           
                                                                                                  
 add (Add)                      (None, 8, 8, 512)    0           ['conv2d[0][0]',                 
                                                                  'conv2d_1[0][0]']               
                                                                                                  
 layer_normalization_1 (LayerNo  (None, 32, 32, 128)  256        ['stack2_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 add_7 (Add)                    (None, 16, 16, 128)  0           ['conv2d_9[0][0]',               
                                                                  'conv2d_10[0][0]']              
                                                                                                  
 up_sampling2d (UpSampling2D)   (None, 32, 32, 512)  0           ['add[0][0]']                    
                                                                                                  
 separable_conv2d_1 (SeparableC  (None, 32, 32, 128)  17664      ['layer_normalization_1[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 up_sampling2d_2 (UpSampling2D)  (None, 32, 32, 128)  0          ['add_7[0][0]']                  
                                                                                                  
 batch_normalization (BatchNorm  (None, 32, 32, 512)  2048       ['up_sampling2d[0][0]']          
 alization)                                                                                       
                                                                                                  
 attention_1 (Attention)        (None, 32, 32, 128)  0           ['separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]']     
                                                                                                  
 batch_normalization_3 (BatchNo  (None, 32, 32, 128)  512        ['up_sampling2d_2[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 activation (Activation)        (None, 32, 32, 512)  0           ['batch_normalization[0][0]']    
                                                                                                  
 add_9 (Add)                    (None, 32, 32, 128)  0           ['attention_1[0][0]',            
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 activation_3 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_3[0][0]']  
                                                                                                  
 conv2d_13 (Conv2D)             (None, 32, 32, 128)  65664       ['activation[0][0]']             
                                                                                                  
 dense_2 (Dense)                (None, 32, 32, 128)  16512       ['add_9[0][0]']                  
                                                                                                  
 add_11 (Add)                   (None, 32, 32, 128)  0           ['activation_3[0][0]',           
                                                                  'conv2d_13[0][0]']              
                                                                                                  
 dense_3 (Dense)                (None, 32, 32, 128)  16512       ['dense_2[0][0]']                
                                                                                                  
 conv2d_14 (Conv2D)             (None, 32, 32, 128)  16512       ['add_11[0][0]']                 
                                                                                                  
 add_10 (Add)                   (None, 32, 32, 128)  0           ['add_9[0][0]',                  
                                                                  'dense_3[0][0]']                
                                                                                                  
 add_12 (Add)                   (None, 32, 32, 128)  0           ['conv2d_14[0][0]',              
                                                                  'add_10[0][0]']                 
                                                                                                  
 conv2d_15 (Conv2D)             (None, 32, 32, 128)  16512       ['add_12[0][0]']                 
                                                                                                  
 batch_normalization_4 (BatchNo  (None, 32, 32, 128)  512        ['conv2d_15[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 layer_normalization_2 (LayerNo  (None, 64, 64, 64)  128         ['stack1_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 activation_4 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_4[0][0]']  
                                                                                                  
 separable_conv2d_2 (SeparableC  (None, 64, 64, 64)  4736        ['layer_normalization_2[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 conv2d_20 (Conv2D)             (None, 32, 32, 64)   8192        ['activation_4[0][0]']           
                                                                                                  
 conv2d_21 (Conv2D)             (None, 32, 32, 64)   73728       ['activation_4[0][0]']           
                                                                                                  
 attention_2 (Attention)        (None, 64, 64, 64)   0           ['separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]']     
                                                                                                  
 add_15 (Add)                   (None, 32, 32, 64)   0           ['conv2d_20[0][0]',              
                                                                  'conv2d_21[0][0]']              
                                                                                                  
 add_17 (Add)                   (None, 64, 64, 64)   0           ['attention_2[0][0]',            
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_4 (UpSampling2D)  (None, 64, 64, 64)  0           ['add_15[0][0]']                 
                                                                                                  
 dense_4 (Dense)                (None, 64, 64, 64)   4160        ['add_17[0][0]']                 
                                                                                                  
 batch_normalization_6 (BatchNo  (None, 64, 64, 64)  256         ['up_sampling2d_4[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_5 (Dense)                (None, 64, 64, 64)   4160        ['dense_4[0][0]']                
                                                                                                  
 activation_6 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_6[0][0]']  
                                                                                                  
 add_18 (Add)                   (None, 64, 64, 64)   0           ['add_17[0][0]',                 
                                                                  'dense_5[0][0]']                
                                                                                                  
 add_19 (Add)                   (None, 64, 64, 64)   0           ['activation_6[0][0]',           
                                                                  'add_18[0][0]']                 
                                                                                                  
 conv2d_24 (Conv2D)             (None, 64, 64, 64)   4160        ['add_19[0][0]']                 
                                                                                                  
 conv2d_16 (Conv2D)             (None, 32, 32, 128)  16384       ['activation_4[0][0]']           
                                                                                                  
 conv2d_17 (Conv2D)             (None, 32, 32, 128)  147456      ['activation_4[0][0]']           
                                                                                                  
 batch_normalization_7 (BatchNo  (None, 64, 64, 64)  256         ['conv2d_24[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 add_13 (Add)                   (None, 32, 32, 128)  0           ['conv2d_16[0][0]',              
                                                                  'conv2d_17[0][0]']              
                                                                                                  
 activation_7 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_7[0][0]']  
                                                                                                  
 up_sampling2d_3 (UpSampling2D)  (None, 256, 256, 12  0          ['add_13[0][0]']                 
                                8)                                                                
                                                                                                  
 conv2d_26 (Conv2D)             (None, 64, 64, 32)   2048        ['activation_7[0][0]']           
                                                                                                  
 conv2d_27 (Conv2D)             (None, 64, 64, 32)   18432       ['activation_7[0][0]']           
                                                                                                  
 batch_normalization_5 (BatchNo  (None, 256, 256, 12  512        ['up_sampling2d_3[0][0]']        
 rmalization)                   8)                                                                
                                                                                                  
 add_20 (Add)                   (None, 64, 64, 32)   0           ['conv2d_26[0][0]',              
                                                                  'conv2d_27[0][0]']              
                                                                                                  
 activation_5 (Activation)      (None, 256, 256, 12  0           ['batch_normalization_5[0][0]']  
                                8)                                                                
                                                                                                  
 up_sampling2d_5 (UpSampling2D)  (None, 256, 256, 32  0          ['add_20[0][0]']                 
                                )                                                                 
                                                                                                  
 conv2d_25 (Conv2D)             (None, 256, 256, 32  4128        ['activation_5[0][0]']           
                                )                                                                 
                                                                                                  
 batch_normalization_9 (BatchNo  (None, 256, 256, 32  128        ['up_sampling2d_5[0][0]']        
 rmalization)                   )                                                                 
                                                                                                  
 batch_normalization_8 (BatchNo  (None, 256, 256, 32  128        ['conv2d_25[0][0]']              
 rmalization)                   )                                                                 
                                                                                                  
 activation_9 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_9[0][0]']  
                                )                                                                 
                                                                                                  
 activation_8 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_8[0][0]']  
                                )                                                                 
                                                                                                  
 add_22 (Add)                   (None, 256, 256, 32  0           ['activation_9[0][0]',           
                                )                                 'activation_8[0][0]']           
                                                                                                  
 conv2d_30 (Conv2D)             (None, 256, 256, 32  1056        ['add_22[0][0]']                 
                                )                                                                 
                                                                                                  
 batch_normalization_10 (BatchN  (None, 256, 256, 32  128        ['conv2d_30[0][0]']              
 ormalization)                  )                                                                 
                                                                                                  
 activation_10 (Activation)     (None, 256, 256, 32  0           ['batch_normalization_10[0][0]'] 
                                )                                                                 
                                                                                                  
 conv2d_31 (Conv2D)             (None, 256, 256, 1)  33          ['activation_10[0][0]']          
                                                                                                  
==================================================================================================
Total params: 28,765,713
Trainable params: 28,762,193
Non-trainable params: 3,520
__________________________________________________________________________________________________
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 stem_ (ZeroPadding2D)          (None, 260, 260, 3)  0           ['input_1[0][0]']                
                                                                                                  
 stem_conv (Conv2D)             (None, 64, 64, 64)   9472        ['stem_[0][0]']                  
                                                                                                  
 stem_ln (LayerNormalization)   (None, 64, 64, 64)   64          ['stem_conv[0][0]']              
                                                                                                  
 stack1_block1_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stem_ln[0][0]']                
 rmalization)                                                                                     
                                                                                                  
 stack1_block1_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu (TFOpLambda)        (None, 64, 64, 128)  0           ['stack1_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow (TFOpLambda)       (None, 64, 64, 128)  0           ['tf.nn.relu[0][0]']             
                                                                                                  
 stack1_block1_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow[0][0]']            
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block1_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block1_attn_output (Add  (None, 64, 64, 64)  0           ['stem_ln[0][0]',                
 )                                                                'stack1_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack1_block1_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block1_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_1 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_1 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_1[0][0]']           
                                                                                                  
 stack1_block1_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_1[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block1_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block1_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block2_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block2_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_2 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_2 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_2[0][0]']           
                                                                                                  
 stack1_block2_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_2[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block2_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block2_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block1_mlp_output[0][0]'
 )                                                               , 'stack1_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block2_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block2_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_3 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_3 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_3[0][0]']           
                                                                                                  
 stack1_block2_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_3[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block2_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block2_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block3_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block3_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_4 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_4 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_4[0][0]']           
                                                                                                  
 stack1_block3_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_4[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block3_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block3_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block2_mlp_output[0][0]'
 )                                                               , 'stack1_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block3_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block3_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_5 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_5 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_5[0][0]']           
                                                                                                  
 stack1_block3_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_5[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block3_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block3_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_downsample_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack2_downsample_pad (ZeroPad  (None, 66, 66, 64)  0           ['stack2_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack2_downsample_conv (Conv2D  (None, 32, 32, 128)  73856      ['stack2_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack2_block1_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack2_block1_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_6 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_6 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_6[0][0]']           
                                                                                                  
 stack2_block1_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_6[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block1_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block1_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_downsample_conv[0][0]', 
 )                                                                'stack2_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack2_block1_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block1_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_7 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_7 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_7[0][0]']           
                                                                                                  
 stack2_block1_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_7[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block1_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block1_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block2_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block2_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_8 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_8 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_8[0][0]']           
                                                                                                  
 stack2_block2_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_8[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block2_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block2_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block1_mlp_output[0][0]'
 )                                                               , 'stack2_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block2_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block2_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_9 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_9 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_9[0][0]']           
                                                                                                  
 stack2_block2_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_9[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block2_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block2_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block3_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block3_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_10 (TFOpLambda)     (None, 32, 32, 256)  0           ['stack2_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_10 (TFOpLambda)    (None, 32, 32, 256)  0           ['tf.nn.relu_10[0][0]']          
                                                                                                  
 stack2_block3_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_10[0][0]']         
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block3_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block3_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block2_mlp_output[0][0]'
 )                                                               , 'stack2_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block3_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block3_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_11 (TFOpLambda)     (None, 32, 32, 512)  0           ['stack2_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_11 (TFOpLambda)    (None, 32, 32, 512)  0           ['tf.nn.relu_11[0][0]']          
                                                                                                  
 stack2_block3_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_11[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block3_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block3_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_downsample_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack3_downsample_pad (ZeroPad  (None, 34, 34, 128)  0          ['stack3_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack3_downsample_conv (Conv2D  (None, 16, 16, 320)  368960     ['stack3_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack3_block1_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack3_block1_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 256, 960)     0           ['stack3_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split (TFOpLambda)          [(None, 256, 320),   0           ['tf.reshape[0][0]']             
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][0]']               
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][1]']               
                                                                                                  
 tf.compat.v1.transpose (TFOpLa  (None, 10, 256, 32)  0          ['tf.reshape_1[0][0]']           
 mbda)                                                                                            
                                                                                                  
 tf.compat.v1.transpose_1 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_2[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda (Lambda)                (None, 10, 256, 256  0           ['tf.compat.v1.transpose[0][0]', 
                                )                                 'tf.compat.v1.transpose_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 10, 256, 256  0           ['lambda[0][0]']                 
                                )                                                                 
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][2]']               
                                                                                                  
 stack3_block1_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply[0][0]']       
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_2 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_1 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_2[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_3 (TFOp  (None, 256, 10, 32)  0          ['lambda_1[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_3[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block1_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack3_block1_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_4[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block1_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block1_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block1_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block1_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_12 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block1_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_12 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_12[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block1_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_12[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block1_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block1_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block1_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block2_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 256, 960)     0           ['stack3_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_1 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_5[0][0]']           
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][0]']             
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_4 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_6[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_5 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_7[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_2 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_4[0][0]'
                                )                                , 'tf.compat.v1.transpose_5[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_2[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][2]']             
                                                                                                  
 stack3_block2_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_1[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_6 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_8[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_3 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_6[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_7 (TFOp  (None, 256, 10, 32)  0          ['lambda_3[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_7[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block2_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block2_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_9[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block2_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block2_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block2_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_13 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block2_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_13 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_13[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block2_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_13[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block2_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block2_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block2_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block3_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_2 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_10[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][0]']             
                                                                                                  
 tf.reshape_12 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_8 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_11[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_9 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_12[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 lambda_4 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_8[0][0]'
                                )                                , 'tf.compat.v1.transpose_9[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_4[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_13 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][2]']             
                                                                                                  
 stack3_block3_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_2[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_10 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_13[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_5 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_10[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_11 (TFO  (None, 256, 10, 32)  0          ['lambda_5[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_14 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_11[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block3_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_14[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block3_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block3_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block3_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_14 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block3_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_14 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_14[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block3_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_14[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block3_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block3_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block3_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block3_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block4_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block4_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_15 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block4_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_3 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_15[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_16 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][0]']             
                                                                                                  
 tf.reshape_17 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_12 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_16[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_13 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_17[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_6 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_12[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_13[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_3 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_6[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_18 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][2]']             
                                                                                                  
 stack3_block4_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_3[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_14 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_18[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_7 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block4_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_14[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_15 (TFO  (None, 256, 10, 32)  0          ['lambda_7[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_19 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_15[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block4_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_19[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block4_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block4_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block4_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block4_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block4_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_15 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block4_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_15 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_15[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block4_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_15[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block4_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block4_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block4_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block4_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block4_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block4_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block5_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block5_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_20 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block5_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_4 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_20[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_21 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][0]']             
                                                                                                  
 tf.reshape_22 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_16 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_21[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_17 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_22[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_8 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_16[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_17[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_4 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_8[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_23 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][2]']             
                                                                                                  
 stack3_block5_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_4[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_18 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_23[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_9 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block5_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_18[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_19 (TFO  (None, 256, 10, 32)  0          ['lambda_9[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_24 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_19[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block5_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_24[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block5_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block5_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block5_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block5_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block5_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_16 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block5_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_16 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_16[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block5_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_16[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block5_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block5_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block5_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block5_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block5_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block5_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block6_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block6_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_25 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block6_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_5 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_25[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_26 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][0]']             
                                                                                                  
 tf.reshape_27 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_20 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_26[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_21 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_27[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_10 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_20[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_21[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_5 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_10[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_28 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][2]']             
                                                                                                  
 stack3_block6_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_5[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_22 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_28[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_11 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block6_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_22[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_23 (TFO  (None, 256, 10, 32)  0          ['lambda_11[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_29 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_23[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block6_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_29[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block6_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block6_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block6_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block6_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block6_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_17 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block6_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_17 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_17[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block6_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_17[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block6_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block6_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block6_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block6_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block6_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block6_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block7_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block7_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_30 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block7_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_6 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_30[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_31 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][0]']             
                                                                                                  
 tf.reshape_32 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_24 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_31[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_25 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_32[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_12 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_24[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_25[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_6 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_12[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_33 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][2]']             
                                                                                                  
 stack3_block7_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_6[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_26 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_33[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_13 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block7_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_26[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_27 (TFO  (None, 256, 10, 32)  0          ['lambda_13[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_34 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_27[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block7_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_34[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block7_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block7_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block7_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block7_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block7_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_18 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block7_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_18 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_18[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block7_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_18[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block7_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block7_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block7_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block7_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block7_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block7_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block8_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block8_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_35 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block8_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_7 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_35[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_36 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][0]']             
                                                                                                  
 tf.reshape_37 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_28 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_36[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_29 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_37[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_14 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_28[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_29[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_7 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_14[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_38 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][2]']             
                                                                                                  
 stack3_block8_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_7[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_30 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_38[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_15 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block8_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_30[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_31 (TFO  (None, 256, 10, 32)  0          ['lambda_15[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_39 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_31[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block8_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_39[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block8_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block8_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block8_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block8_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block8_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_19 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block8_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_19 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_19[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block8_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_19[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block8_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block8_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block8_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block8_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block8_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block8_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block9_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block9_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_40 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block9_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_8 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_40[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_41 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][0]']             
                                                                                                  
 tf.reshape_42 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_32 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_41[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_33 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_42[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_16 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_32[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_33[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_16[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_43 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][2]']             
                                                                                                  
 stack3_block9_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_8[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_34 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_43[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_17 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block9_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_34[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_35 (TFO  (None, 256, 10, 32)  0          ['lambda_17[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_44 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_35[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block9_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_44[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block9_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block9_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block9_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block9_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block9_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_20 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block9_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_20 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_20[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block9_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_20[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block9_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block9_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block9_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block9_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block9_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_downsample_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack4_downsample_pad (ZeroPad  (None, 18, 18, 320)  0          ['stack4_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack4_downsample_conv (Conv2D  (None, 8, 8, 512)   1475072     ['stack4_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack4_block1_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack4_block1_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_45 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_9 (TFOpLambda)        [(None, 64, 512),    0           ['tf.reshape_45[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_46 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][0]']             
                                                                                                  
 tf.reshape_47 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_36 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_46[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_37 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_47[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_18 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_36[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_37[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 16, 64, 64)  0           ['lambda_18[0][0]']              
 )                                                                                                
                                                                                                  
 tf.reshape_48 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][2]']             
                                                                                                  
 stack4_block1_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_9[0][0]']     
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_38 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_48[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_19 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_38[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_39 (TFO  (None, 64, 16, 32)  0           ['lambda_19[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_49 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_39[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack4_block1_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_49[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block1_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block1_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_21 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_21 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_21[0][0]']          
                                                                                                  
 stack4_block1_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_21[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block1_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block1_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block1_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block2_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_50 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_10 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_50[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_51 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][0]']            
                                                                                                  
 tf.reshape_52 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_40 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_51[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_41 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_52[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_20 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_40[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_41[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_10 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_20[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_53 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][2]']            
                                                                                                  
 stack4_block2_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_10[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_42 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_53[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_21 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_42[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_43 (TFO  (None, 64, 16, 32)  0           ['lambda_21[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_54 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_43[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block2_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_54[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block2_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block2_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_22 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_22 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_22[0][0]']          
                                                                                                  
 stack4_block2_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_22[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block2_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block2_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block2_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block3_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_55 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_11 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_55[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_56 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][0]']            
                                                                                                  
 tf.reshape_57 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_44 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_56[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_45 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_57[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_22 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_44[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_45[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_11 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_22[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_58 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][2]']            
                                                                                                  
 stack4_block3_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_11[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_46 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_58[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_23 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_46[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_47 (TFO  (None, 64, 16, 32)  0           ['lambda_23[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_59 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_47[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block3_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_59[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block3_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block3_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_23 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_23 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_23[0][0]']          
                                                                                                  
 stack4_block3_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_23[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 layer_normalization (LayerNorm  (None, 16, 16, 320)  640        ['stack3_block9_mlp_Dense_1[0][0]
 alization)                                                      ']                               
                                                                                                  
 stack4_block3_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 separable_conv2d (SeparableCon  (None, 16, 16, 320)  105600     ['layer_normalization[0][0]']    
 v2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)              (None, 8, 8, 320)    163840      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_5 (Conv2D)              (None, 8, 8, 320)    1474560     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 attention (Attention)          (None, 16, 16, 320)  0           ['separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]']       
                                                                                                  
 add_2 (Add)                    (None, 8, 8, 320)    0           ['conv2d_4[0][0]',               
                                                                  'conv2d_5[0][0]']               
                                                                                                  
 add_4 (Add)                    (None, 16, 16, 320)  0           ['attention[0][0]',              
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_1 (UpSampling2D)  (None, 16, 16, 320)  0          ['add_2[0][0]']                  
                                                                                                  
 dense (Dense)                  (None, 16, 16, 320)  102720      ['add_4[0][0]']                  
                                                                                                  
 batch_normalization_1 (BatchNo  (None, 16, 16, 320)  1280       ['up_sampling2d_1[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_1 (Dense)                (None, 16, 16, 320)  102720      ['dense[0][0]']                  
                                                                                                  
 activation_1 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_1[0][0]']  
                                                                                                  
 add_5 (Add)                    (None, 16, 16, 320)  0           ['add_4[0][0]',                  
                                                                  'dense_1[0][0]']                
                                                                                                  
 add_6 (Add)                    (None, 16, 16, 320)  0           ['activation_1[0][0]',           
                                                                  'add_5[0][0]']                  
                                                                                                  
 conv2d_8 (Conv2D)              (None, 16, 16, 320)  102720      ['add_6[0][0]']                  
                                                                                                  
 batch_normalization_2 (BatchNo  (None, 16, 16, 320)  1280       ['conv2d_8[0][0]']               
 rmalization)                                                                                     
                                                                                                  
 activation_2 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_2[0][0]']  
                                                                                                  
 conv2d (Conv2D)                (None, 8, 8, 512)    262144      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_1 (Conv2D)              (None, 8, 8, 512)    2359296     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_9 (Conv2D)              (None, 16, 16, 128)  40960       ['activation_2[0][0]']           
                                                                                                  
 conv2d_10 (Conv2D)             (None, 16, 16, 128)  368640      ['activation_2[0][0]']           
                                                                                                  
 add (Add)                      (None, 8, 8, 512)    0           ['conv2d[0][0]',                 
                                                                  'conv2d_1[0][0]']               
                                                                                                  
 layer_normalization_1 (LayerNo  (None, 32, 32, 128)  256        ['stack2_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 add_7 (Add)                    (None, 16, 16, 128)  0           ['conv2d_9[0][0]',               
                                                                  'conv2d_10[0][0]']              
                                                                                                  
 up_sampling2d (UpSampling2D)   (None, 32, 32, 512)  0           ['add[0][0]']                    
                                                                                                  
 separable_conv2d_1 (SeparableC  (None, 32, 32, 128)  17664      ['layer_normalization_1[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 up_sampling2d_2 (UpSampling2D)  (None, 32, 32, 128)  0          ['add_7[0][0]']                  
                                                                                                  
 batch_normalization (BatchNorm  (None, 32, 32, 512)  2048       ['up_sampling2d[0][0]']          
 alization)                                                                                       
                                                                                                  
 attention_1 (Attention)        (None, 32, 32, 128)  0           ['separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]']     
                                                                                                  
 batch_normalization_3 (BatchNo  (None, 32, 32, 128)  512        ['up_sampling2d_2[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 activation (Activation)        (None, 32, 32, 512)  0           ['batch_normalization[0][0]']    
                                                                                                  
 add_9 (Add)                    (None, 32, 32, 128)  0           ['attention_1[0][0]',            
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 activation_3 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_3[0][0]']  
                                                                                                  
 conv2d_13 (Conv2D)             (None, 32, 32, 128)  65664       ['activation[0][0]']             
                                                                                                  
 dense_2 (Dense)                (None, 32, 32, 128)  16512       ['add_9[0][0]']                  
                                                                                                  
 add_11 (Add)                   (None, 32, 32, 128)  0           ['activation_3[0][0]',           
                                                                  'conv2d_13[0][0]']              
                                                                                                  
 dense_3 (Dense)                (None, 32, 32, 128)  16512       ['dense_2[0][0]']                
                                                                                                  
 conv2d_14 (Conv2D)             (None, 32, 32, 128)  16512       ['add_11[0][0]']                 
                                                                                                  
 add_10 (Add)                   (None, 32, 32, 128)  0           ['add_9[0][0]',                  
                                                                  'dense_3[0][0]']                
                                                                                                  
 add_12 (Add)                   (None, 32, 32, 128)  0           ['conv2d_14[0][0]',              
                                                                  'add_10[0][0]']                 
                                                                                                  
 conv2d_15 (Conv2D)             (None, 32, 32, 128)  16512       ['add_12[0][0]']                 
                                                                                                  
 batch_normalization_4 (BatchNo  (None, 32, 32, 128)  512        ['conv2d_15[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 layer_normalization_2 (LayerNo  (None, 64, 64, 64)  128         ['stack1_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 activation_4 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_4[0][0]']  
                                                                                                  
 separable_conv2d_2 (SeparableC  (None, 64, 64, 64)  4736        ['layer_normalization_2[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 conv2d_20 (Conv2D)             (None, 32, 32, 64)   8192        ['activation_4[0][0]']           
                                                                                                  
 conv2d_21 (Conv2D)             (None, 32, 32, 64)   73728       ['activation_4[0][0]']           
                                                                                                  
 attention_2 (Attention)        (None, 64, 64, 64)   0           ['separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]']     
                                                                                                  
 add_15 (Add)                   (None, 32, 32, 64)   0           ['conv2d_20[0][0]',              
                                                                  'conv2d_21[0][0]']              
                                                                                                  
 add_17 (Add)                   (None, 64, 64, 64)   0           ['attention_2[0][0]',            
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_4 (UpSampling2D)  (None, 64, 64, 64)  0           ['add_15[0][0]']                 
                                                                                                  
 dense_4 (Dense)                (None, 64, 64, 64)   4160        ['add_17[0][0]']                 
                                                                                                  
 batch_normalization_6 (BatchNo  (None, 64, 64, 64)  256         ['up_sampling2d_4[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_5 (Dense)                (None, 64, 64, 64)   4160        ['dense_4[0][0]']                
                                                                                                  
 activation_6 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_6[0][0]']  
                                                                                                  
 add_18 (Add)                   (None, 64, 64, 64)   0           ['add_17[0][0]',                 
                                                                  'dense_5[0][0]']                
                                                                                                  
 add_19 (Add)                   (None, 64, 64, 64)   0           ['activation_6[0][0]',           
                                                                  'add_18[0][0]']                 
                                                                                                  
 conv2d_24 (Conv2D)             (None, 64, 64, 64)   4160        ['add_19[0][0]']                 
                                                                                                  
 conv2d_16 (Conv2D)             (None, 32, 32, 128)  16384       ['activation_4[0][0]']           
                                                                                                  
 conv2d_17 (Conv2D)             (None, 32, 32, 128)  147456      ['activation_4[0][0]']           
                                                                                                  
 batch_normalization_7 (BatchNo  (None, 64, 64, 64)  256         ['conv2d_24[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 add_13 (Add)                   (None, 32, 32, 128)  0           ['conv2d_16[0][0]',              
                                                                  'conv2d_17[0][0]']              
                                                                                                  
 activation_7 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_7[0][0]']  
                                                                                                  
 up_sampling2d_3 (UpSampling2D)  (None, 256, 256, 12  0          ['add_13[0][0]']                 
                                8)                                                                
                                                                                                  
 conv2d_26 (Conv2D)             (None, 64, 64, 32)   2048        ['activation_7[0][0]']           
                                                                                                  
 conv2d_27 (Conv2D)             (None, 64, 64, 32)   18432       ['activation_7[0][0]']           
                                                                                                  
 batch_normalization_5 (BatchNo  (None, 256, 256, 12  512        ['up_sampling2d_3[0][0]']        
 rmalization)                   8)                                                                
                                                                                                  
 add_20 (Add)                   (None, 64, 64, 32)   0           ['conv2d_26[0][0]',              
                                                                  'conv2d_27[0][0]']              
                                                                                                  
 activation_5 (Activation)      (None, 256, 256, 12  0           ['batch_normalization_5[0][0]']  
                                8)                                                                
                                                                                                  
 up_sampling2d_5 (UpSampling2D)  (None, 256, 256, 32  0          ['add_20[0][0]']                 
                                )                                                                 
                                                                                                  
 conv2d_25 (Conv2D)             (None, 256, 256, 32  4128        ['activation_5[0][0]']           
                                )                                                                 
                                                                                                  
 batch_normalization_9 (BatchNo  (None, 256, 256, 32  128        ['up_sampling2d_5[0][0]']        
 rmalization)                   )                                                                 
                                                                                                  
 batch_normalization_8 (BatchNo  (None, 256, 256, 32  128        ['conv2d_25[0][0]']              
 rmalization)                   )                                                                 
                                                                                                  
 activation_9 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_9[0][0]']  
                                )                                                                 
                                                                                                  
 activation_8 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_8[0][0]']  
                                )                                                                 
                                                                                                  
 add_22 (Add)                   (None, 256, 256, 32  0           ['activation_9[0][0]',           
                                )                                 'activation_8[0][0]']           
                                                                                                  
 conv2d_30 (Conv2D)             (None, 256, 256, 32  1056        ['add_22[0][0]']                 
                                )                                                                 
                                                                                                  
 batch_normalization_10 (BatchN  (None, 256, 256, 32  128        ['conv2d_30[0][0]']              
 ormalization)                  )                                                                 
                                                                                                  
 activation_10 (Activation)     (None, 256, 256, 32  0           ['batch_normalization_10[0][0]'] 
                                )                                                                 
                                                                                                  
 conv2d_31 (Conv2D)             (None, 256, 256, 1)  33          ['activation_10[0][0]']          
                                                                                                  
==================================================================================================
Total params: 28,765,713
Trainable params: 28,762,193
Non-trainable params: 3,520
__________________________________________________________________________________________________
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 stem_ (ZeroPadding2D)          (None, 260, 260, 3)  0           ['input_1[0][0]']                
                                                                                                  
 stem_conv (Conv2D)             (None, 64, 64, 64)   9472        ['stem_[0][0]']                  
                                                                                                  
 stem_ln (LayerNormalization)   (None, 64, 64, 64)   64          ['stem_conv[0][0]']              
                                                                                                  
 stack1_block1_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stem_ln[0][0]']                
 rmalization)                                                                                     
                                                                                                  
 stack1_block1_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu (TFOpLambda)        (None, 64, 64, 128)  0           ['stack1_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow (TFOpLambda)       (None, 64, 64, 128)  0           ['tf.nn.relu[0][0]']             
                                                                                                  
 stack1_block1_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow[0][0]']            
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block1_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block1_attn_output (Add  (None, 64, 64, 64)  0           ['stem_ln[0][0]',                
 )                                                                'stack1_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack1_block1_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block1_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_1 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_1 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_1[0][0]']           
                                                                                                  
 stack1_block1_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_1[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block1_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block1_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block2_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block2_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_2 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_2 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_2[0][0]']           
                                                                                                  
 stack1_block2_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_2[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block2_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block2_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block1_mlp_output[0][0]'
 )                                                               , 'stack1_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block2_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block2_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_3 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_3 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_3[0][0]']           
                                                                                                  
 stack1_block2_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_3[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block2_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block2_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block3_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block3_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_4 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_4 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_4[0][0]']           
                                                                                                  
 stack1_block3_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_4[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block3_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block3_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block2_mlp_output[0][0]'
 )                                                               , 'stack1_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block3_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block3_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_5 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_5 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_5[0][0]']           
                                                                                                  
 stack1_block3_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_5[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block3_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block3_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_downsample_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack2_downsample_pad (ZeroPad  (None, 66, 66, 64)  0           ['stack2_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack2_downsample_conv (Conv2D  (None, 32, 32, 128)  73856      ['stack2_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack2_block1_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack2_block1_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_6 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_6 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_6[0][0]']           
                                                                                                  
 stack2_block1_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_6[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block1_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block1_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_downsample_conv[0][0]', 
 )                                                                'stack2_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack2_block1_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block1_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_7 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_7 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_7[0][0]']           
                                                                                                  
 stack2_block1_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_7[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block1_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block1_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block2_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block2_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_8 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_8 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_8[0][0]']           
                                                                                                  
 stack2_block2_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_8[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block2_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block2_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block1_mlp_output[0][0]'
 )                                                               , 'stack2_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block2_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block2_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_9 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_9 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_9[0][0]']           
                                                                                                  
 stack2_block2_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_9[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block2_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block2_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block3_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block3_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_10 (TFOpLambda)     (None, 32, 32, 256)  0           ['stack2_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_10 (TFOpLambda)    (None, 32, 32, 256)  0           ['tf.nn.relu_10[0][0]']          
                                                                                                  
 stack2_block3_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_10[0][0]']         
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block3_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block3_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block2_mlp_output[0][0]'
 )                                                               , 'stack2_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block3_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block3_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_11 (TFOpLambda)     (None, 32, 32, 512)  0           ['stack2_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_11 (TFOpLambda)    (None, 32, 32, 512)  0           ['tf.nn.relu_11[0][0]']          
                                                                                                  
 stack2_block3_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_11[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block3_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block3_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_downsample_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack3_downsample_pad (ZeroPad  (None, 34, 34, 128)  0          ['stack3_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack3_downsample_conv (Conv2D  (None, 16, 16, 320)  368960     ['stack3_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack3_block1_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack3_block1_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 256, 960)     0           ['stack3_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split (TFOpLambda)          [(None, 256, 320),   0           ['tf.reshape[0][0]']             
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][0]']               
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][1]']               
                                                                                                  
 tf.compat.v1.transpose (TFOpLa  (None, 10, 256, 32)  0          ['tf.reshape_1[0][0]']           
 mbda)                                                                                            
                                                                                                  
 tf.compat.v1.transpose_1 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_2[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda (Lambda)                (None, 10, 256, 256  0           ['tf.compat.v1.transpose[0][0]', 
                                )                                 'tf.compat.v1.transpose_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 10, 256, 256  0           ['lambda[0][0]']                 
                                )                                                                 
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][2]']               
                                                                                                  
 stack3_block1_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply[0][0]']       
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_2 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_1 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_2[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_3 (TFOp  (None, 256, 10, 32)  0          ['lambda_1[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_3[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block1_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack3_block1_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_4[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block1_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block1_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block1_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block1_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_12 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block1_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_12 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_12[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block1_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_12[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block1_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block1_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block1_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block2_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 256, 960)     0           ['stack3_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_1 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_5[0][0]']           
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][0]']             
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_4 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_6[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_5 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_7[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_2 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_4[0][0]'
                                )                                , 'tf.compat.v1.transpose_5[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_2[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][2]']             
                                                                                                  
 stack3_block2_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_1[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_6 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_8[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_3 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_6[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_7 (TFOp  (None, 256, 10, 32)  0          ['lambda_3[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_7[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block2_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block2_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_9[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block2_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block2_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block2_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_13 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block2_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_13 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_13[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block2_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_13[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block2_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block2_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block2_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block3_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_2 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_10[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][0]']             
                                                                                                  
 tf.reshape_12 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_8 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_11[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_9 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_12[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 lambda_4 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_8[0][0]'
                                )                                , 'tf.compat.v1.transpose_9[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_4[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_13 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][2]']             
                                                                                                  
 stack3_block3_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_2[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_10 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_13[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_5 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_10[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_11 (TFO  (None, 256, 10, 32)  0          ['lambda_5[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_14 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_11[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block3_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_14[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block3_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block3_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block3_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_14 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block3_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_14 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_14[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block3_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_14[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block3_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block3_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block3_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block3_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block4_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block4_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_15 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block4_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_3 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_15[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_16 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][0]']             
                                                                                                  
 tf.reshape_17 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_12 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_16[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_13 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_17[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_6 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_12[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_13[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_3 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_6[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_18 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][2]']             
                                                                                                  
 stack3_block4_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_3[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_14 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_18[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_7 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block4_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_14[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_15 (TFO  (None, 256, 10, 32)  0          ['lambda_7[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_19 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_15[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block4_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_19[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block4_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block4_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block4_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block4_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block4_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_15 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block4_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_15 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_15[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block4_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_15[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block4_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block4_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block4_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block4_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block4_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block4_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block5_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block5_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_20 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block5_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_4 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_20[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_21 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][0]']             
                                                                                                  
 tf.reshape_22 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_16 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_21[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_17 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_22[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_8 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_16[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_17[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_4 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_8[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_23 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][2]']             
                                                                                                  
 stack3_block5_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_4[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_18 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_23[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_9 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block5_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_18[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_19 (TFO  (None, 256, 10, 32)  0          ['lambda_9[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_24 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_19[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block5_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_24[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block5_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block5_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block5_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block5_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block5_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_16 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block5_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_16 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_16[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block5_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_16[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block5_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block5_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block5_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block5_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block5_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block5_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block6_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block6_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_25 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block6_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_5 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_25[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_26 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][0]']             
                                                                                                  
 tf.reshape_27 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_20 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_26[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_21 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_27[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_10 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_20[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_21[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_5 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_10[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_28 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][2]']             
                                                                                                  
 stack3_block6_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_5[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_22 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_28[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_11 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block6_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_22[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_23 (TFO  (None, 256, 10, 32)  0          ['lambda_11[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_29 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_23[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block6_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_29[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block6_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block6_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block6_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block6_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block6_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_17 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block6_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_17 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_17[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block6_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_17[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block6_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block6_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block6_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block6_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block6_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block6_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block7_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block7_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_30 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block7_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_6 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_30[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_31 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][0]']             
                                                                                                  
 tf.reshape_32 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_24 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_31[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_25 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_32[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_12 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_24[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_25[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_6 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_12[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_33 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][2]']             
                                                                                                  
 stack3_block7_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_6[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_26 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_33[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_13 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block7_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_26[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_27 (TFO  (None, 256, 10, 32)  0          ['lambda_13[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_34 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_27[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block7_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_34[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block7_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block7_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block7_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block7_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block7_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_18 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block7_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_18 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_18[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block7_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_18[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block7_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block7_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block7_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block7_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block7_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block7_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block8_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block8_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_35 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block8_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_7 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_35[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_36 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][0]']             
                                                                                                  
 tf.reshape_37 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_28 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_36[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_29 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_37[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_14 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_28[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_29[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_7 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_14[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_38 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][2]']             
                                                                                                  
 stack3_block8_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_7[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_30 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_38[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_15 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block8_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_30[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_31 (TFO  (None, 256, 10, 32)  0          ['lambda_15[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_39 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_31[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block8_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_39[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block8_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block8_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block8_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block8_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block8_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_19 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block8_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_19 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_19[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block8_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_19[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block8_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block8_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block8_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block8_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block8_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block8_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block9_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block9_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_40 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block9_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_8 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_40[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_41 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][0]']             
                                                                                                  
 tf.reshape_42 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_32 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_41[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_33 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_42[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_16 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_32[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_33[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_16[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_43 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][2]']             
                                                                                                  
 stack3_block9_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_8[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_34 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_43[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_17 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block9_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_34[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_35 (TFO  (None, 256, 10, 32)  0          ['lambda_17[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_44 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_35[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block9_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_44[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block9_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block9_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block9_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block9_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block9_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_20 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block9_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_20 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_20[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block9_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_20[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block9_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block9_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block9_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block9_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block9_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_downsample_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack4_downsample_pad (ZeroPad  (None, 18, 18, 320)  0          ['stack4_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack4_downsample_conv (Conv2D  (None, 8, 8, 512)   1475072     ['stack4_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack4_block1_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack4_block1_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_45 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_9 (TFOpLambda)        [(None, 64, 512),    0           ['tf.reshape_45[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_46 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][0]']             
                                                                                                  
 tf.reshape_47 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_36 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_46[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_37 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_47[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_18 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_36[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_37[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 16, 64, 64)  0           ['lambda_18[0][0]']              
 )                                                                                                
                                                                                                  
 tf.reshape_48 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][2]']             
                                                                                                  
 stack4_block1_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_9[0][0]']     
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_38 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_48[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_19 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_38[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_39 (TFO  (None, 64, 16, 32)  0           ['lambda_19[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_49 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_39[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack4_block1_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_49[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block1_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block1_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_21 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_21 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_21[0][0]']          
                                                                                                  
 stack4_block1_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_21[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block1_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block1_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block1_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block2_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_50 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_10 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_50[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_51 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][0]']            
                                                                                                  
 tf.reshape_52 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_40 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_51[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_41 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_52[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_20 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_40[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_41[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_10 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_20[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_53 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][2]']            
                                                                                                  
 stack4_block2_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_10[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_42 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_53[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_21 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_42[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_43 (TFO  (None, 64, 16, 32)  0           ['lambda_21[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_54 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_43[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block2_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_54[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block2_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block2_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_22 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_22 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_22[0][0]']          
                                                                                                  
 stack4_block2_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_22[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block2_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block2_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block2_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block3_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_55 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_11 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_55[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_56 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][0]']            
                                                                                                  
 tf.reshape_57 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_44 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_56[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_45 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_57[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_22 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_44[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_45[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_11 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_22[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_58 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][2]']            
                                                                                                  
 stack4_block3_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_11[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_46 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_58[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_23 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_46[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_47 (TFO  (None, 64, 16, 32)  0           ['lambda_23[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_59 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_47[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block3_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_59[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block3_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block3_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_23 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_23 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_23[0][0]']          
                                                                                                  
 stack4_block3_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_23[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 layer_normalization (LayerNorm  (None, 16, 16, 320)  640        ['stack3_block9_mlp_Dense_1[0][0]
 alization)                                                      ']                               
                                                                                                  
 stack4_block3_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 separable_conv2d (SeparableCon  (None, 16, 16, 320)  105600     ['layer_normalization[0][0]']    
 v2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)              (None, 8, 8, 320)    163840      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_5 (Conv2D)              (None, 8, 8, 320)    1474560     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 attention (Attention)          (None, 16, 16, 320)  0           ['separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]']       
                                                                                                  
 add_2 (Add)                    (None, 8, 8, 320)    0           ['conv2d_4[0][0]',               
                                                                  'conv2d_5[0][0]']               
                                                                                                  
 add_4 (Add)                    (None, 16, 16, 320)  0           ['attention[0][0]',              
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_1 (UpSampling2D)  (None, 16, 16, 320)  0          ['add_2[0][0]']                  
                                                                                                  
 dense (Dense)                  (None, 16, 16, 320)  102720      ['add_4[0][0]']                  
                                                                                                  
 batch_normalization_1 (BatchNo  (None, 16, 16, 320)  1280       ['up_sampling2d_1[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_1 (Dense)                (None, 16, 16, 320)  102720      ['dense[0][0]']                  
                                                                                                  
 activation_1 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_1[0][0]']  
                                                                                                  
 add_5 (Add)                    (None, 16, 16, 320)  0           ['add_4[0][0]',                  
                                                                  'dense_1[0][0]']                
                                                                                                  
 add_6 (Add)                    (None, 16, 16, 320)  0           ['activation_1[0][0]',           
                                                                  'add_5[0][0]']                  
                                                                                                  
 conv2d_8 (Conv2D)              (None, 16, 16, 320)  102720      ['add_6[0][0]']                  
                                                                                                  
 batch_normalization_2 (BatchNo  (None, 16, 16, 320)  1280       ['conv2d_8[0][0]']               
 rmalization)                                                                                     
                                                                                                  
 activation_2 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_2[0][0]']  
                                                                                                  
 conv2d (Conv2D)                (None, 8, 8, 512)    262144      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_1 (Conv2D)              (None, 8, 8, 512)    2359296     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_9 (Conv2D)              (None, 16, 16, 128)  40960       ['activation_2[0][0]']           
                                                                                                  
 conv2d_10 (Conv2D)             (None, 16, 16, 128)  368640      ['activation_2[0][0]']           
                                                                                                  
 add (Add)                      (None, 8, 8, 512)    0           ['conv2d[0][0]',                 
                                                                  'conv2d_1[0][0]']               
                                                                                                  
 layer_normalization_1 (LayerNo  (None, 32, 32, 128)  256        ['stack2_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 add_7 (Add)                    (None, 16, 16, 128)  0           ['conv2d_9[0][0]',               
                                                                  'conv2d_10[0][0]']              
                                                                                                  
 up_sampling2d (UpSampling2D)   (None, 32, 32, 512)  0           ['add[0][0]']                    
                                                                                                  
 separable_conv2d_1 (SeparableC  (None, 32, 32, 128)  17664      ['layer_normalization_1[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 up_sampling2d_2 (UpSampling2D)  (None, 32, 32, 128)  0          ['add_7[0][0]']                  
                                                                                                  
 batch_normalization (BatchNorm  (None, 32, 32, 512)  2048       ['up_sampling2d[0][0]']          
 alization)                                                                                       
                                                                                                  
 attention_1 (Attention)        (None, 32, 32, 128)  0           ['separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]']     
                                                                                                  
 batch_normalization_3 (BatchNo  (None, 32, 32, 128)  512        ['up_sampling2d_2[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 activation (Activation)        (None, 32, 32, 512)  0           ['batch_normalization[0][0]']    
                                                                                                  
 add_9 (Add)                    (None, 32, 32, 128)  0           ['attention_1[0][0]',            
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 activation_3 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_3[0][0]']  
                                                                                                  
 conv2d_13 (Conv2D)             (None, 32, 32, 128)  65664       ['activation[0][0]']             
                                                                                                  
 dense_2 (Dense)                (None, 32, 32, 128)  16512       ['add_9[0][0]']                  
                                                                                                  
 add_11 (Add)                   (None, 32, 32, 128)  0           ['activation_3[0][0]',           
                                                                  'conv2d_13[0][0]']              
                                                                                                  
 dense_3 (Dense)                (None, 32, 32, 128)  16512       ['dense_2[0][0]']                
                                                                                                  
 conv2d_14 (Conv2D)             (None, 32, 32, 128)  16512       ['add_11[0][0]']                 
                                                                                                  
 add_10 (Add)                   (None, 32, 32, 128)  0           ['add_9[0][0]',                  
                                                                  'dense_3[0][0]']                
                                                                                                  
 add_12 (Add)                   (None, 32, 32, 128)  0           ['conv2d_14[0][0]',              
                                                                  'add_10[0][0]']                 
                                                                                                  
 conv2d_15 (Conv2D)             (None, 32, 32, 128)  16512       ['add_12[0][0]']                 
                                                                                                  
 batch_normalization_4 (BatchNo  (None, 32, 32, 128)  512        ['conv2d_15[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 layer_normalization_2 (LayerNo  (None, 64, 64, 64)  128         ['stack1_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 activation_4 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_4[0][0]']  
                                                                                                  
 separable_conv2d_2 (SeparableC  (None, 64, 64, 64)  4736        ['layer_normalization_2[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 conv2d_20 (Conv2D)             (None, 32, 32, 64)   8192        ['activation_4[0][0]']           
                                                                                                  
 conv2d_21 (Conv2D)             (None, 32, 32, 64)   73728       ['activation_4[0][0]']           
                                                                                                  
 attention_2 (Attention)        (None, 64, 64, 64)   0           ['separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]']     
                                                                                                  
 add_15 (Add)                   (None, 32, 32, 64)   0           ['conv2d_20[0][0]',              
                                                                  'conv2d_21[0][0]']              
                                                                                                  
 add_17 (Add)                   (None, 64, 64, 64)   0           ['attention_2[0][0]',            
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_4 (UpSampling2D)  (None, 64, 64, 64)  0           ['add_15[0][0]']                 
                                                                                                  
 dense_4 (Dense)                (None, 64, 64, 64)   4160        ['add_17[0][0]']                 
                                                                                                  
 batch_normalization_6 (BatchNo  (None, 64, 64, 64)  256         ['up_sampling2d_4[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_5 (Dense)                (None, 64, 64, 64)   4160        ['dense_4[0][0]']                
                                                                                                  
 activation_6 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_6[0][0]']  
                                                                                                  
 add_18 (Add)                   (None, 64, 64, 64)   0           ['add_17[0][0]',                 
                                                                  'dense_5[0][0]']                
                                                                                                  
 add_19 (Add)                   (None, 64, 64, 64)   0           ['activation_6[0][0]',           
                                                                  'add_18[0][0]']                 
                                                                                                  
 conv2d_24 (Conv2D)             (None, 64, 64, 64)   4160        ['add_19[0][0]']                 
                                                                                                  
 conv2d_16 (Conv2D)             (None, 32, 32, 128)  16384       ['activation_4[0][0]']           
                                                                                                  
 conv2d_17 (Conv2D)             (None, 32, 32, 128)  147456      ['activation_4[0][0]']           
                                                                                                  
 batch_normalization_7 (BatchNo  (None, 64, 64, 64)  256         ['conv2d_24[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 add_13 (Add)                   (None, 32, 32, 128)  0           ['conv2d_16[0][0]',              
                                                                  'conv2d_17[0][0]']              
                                                                                                  
 activation_7 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_7[0][0]']  
                                                                                                  
 up_sampling2d_3 (UpSampling2D)  (None, 256, 256, 12  0          ['add_13[0][0]']                 
                                8)                                                                
                                                                                                  
 conv2d_26 (Conv2D)             (None, 64, 64, 32)   2048        ['activation_7[0][0]']           
                                                                                                  
 conv2d_27 (Conv2D)             (None, 64, 64, 32)   18432       ['activation_7[0][0]']           
                                                                                                  
 batch_normalization_5 (BatchNo  (None, 256, 256, 12  512        ['up_sampling2d_3[0][0]']        
 rmalization)                   8)                                                                
                                                                                                  
 add_20 (Add)                   (None, 64, 64, 32)   0           ['conv2d_26[0][0]',              
                                                                  'conv2d_27[0][0]']              
                                                                                                  
 activation_5 (Activation)      (None, 256, 256, 12  0           ['batch_normalization_5[0][0]']  
                                8)                                                                
                                                                                                  
 up_sampling2d_5 (UpSampling2D)  (None, 256, 256, 32  0          ['add_20[0][0]']                 
                                )                                                                 
                                                                                                  
 conv2d_25 (Conv2D)             (None, 256, 256, 32  4128        ['activation_5[0][0]']           
                                )                                                                 
                                                                                                  
 batch_normalization_9 (BatchNo  (None, 256, 256, 32  128        ['up_sampling2d_5[0][0]']        
 rmalization)                   )                                                                 
                                                                                                  
 batch_normalization_8 (BatchNo  (None, 256, 256, 32  128        ['conv2d_25[0][0]']              
 rmalization)                   )                                                                 
                                                                                                  
 activation_9 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_9[0][0]']  
                                )                                                                 
                                                                                                  
 activation_8 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_8[0][0]']  
                                )                                                                 
                                                                                                  
 add_22 (Add)                   (None, 256, 256, 32  0           ['activation_9[0][0]',           
                                )                                 'activation_8[0][0]']           
                                                                                                  
 conv2d_30 (Conv2D)             (None, 256, 256, 32  1056        ['add_22[0][0]']                 
                                )                                                                 
                                                                                                  
 batch_normalization_10 (BatchN  (None, 256, 256, 32  128        ['conv2d_30[0][0]']              
 ormalization)                  )                                                                 
                                                                                                  
 activation_10 (Activation)     (None, 256, 256, 32  0           ['batch_normalization_10[0][0]'] 
                                )                                                                 
                                                                                                  
 conv2d_31 (Conv2D)             (None, 256, 256, 1)  33          ['activation_10[0][0]']          
                                                                                                  
==================================================================================================
Total params: 28,765,713
Trainable params: 28,762,193
Non-trainable params: 3,520
__________________________________________________________________________________________________
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 stem_ (ZeroPadding2D)          (None, 260, 260, 3)  0           ['input_1[0][0]']                
                                                                                                  
 stem_conv (Conv2D)             (None, 64, 64, 64)   9472        ['stem_[0][0]']                  
                                                                                                  
 stem_ln (LayerNormalization)   (None, 64, 64, 64)   64          ['stem_conv[0][0]']              
                                                                                                  
 stack1_block1_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stem_ln[0][0]']                
 rmalization)                                                                                     
                                                                                                  
 stack1_block1_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu (TFOpLambda)        (None, 64, 64, 128)  0           ['stack1_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow (TFOpLambda)       (None, 64, 64, 128)  0           ['tf.nn.relu[0][0]']             
                                                                                                  
 stack1_block1_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow[0][0]']            
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block1_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block1_attn_output (Add  (None, 64, 64, 64)  0           ['stem_ln[0][0]',                
 )                                                                'stack1_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack1_block1_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block1_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_1 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_1 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_1[0][0]']           
                                                                                                  
 stack1_block1_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_1[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block1_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block1_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block2_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block2_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_2 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_2 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_2[0][0]']           
                                                                                                  
 stack1_block2_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_2[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block2_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block2_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block1_mlp_output[0][0]'
 )                                                               , 'stack1_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block2_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block2_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_3 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_3 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_3[0][0]']           
                                                                                                  
 stack1_block2_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_3[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block2_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block2_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block3_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block3_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_4 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_4 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_4[0][0]']           
                                                                                                  
 stack1_block3_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_4[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block3_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block3_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block2_mlp_output[0][0]'
 )                                                               , 'stack1_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block3_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block3_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_5 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_5 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_5[0][0]']           
                                                                                                  
 stack1_block3_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_5[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block3_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block3_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_downsample_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack2_downsample_pad (ZeroPad  (None, 66, 66, 64)  0           ['stack2_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack2_downsample_conv (Conv2D  (None, 32, 32, 128)  73856      ['stack2_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack2_block1_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack2_block1_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_6 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_6 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_6[0][0]']           
                                                                                                  
 stack2_block1_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_6[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block1_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block1_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_downsample_conv[0][0]', 
 )                                                                'stack2_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack2_block1_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block1_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_7 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_7 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_7[0][0]']           
                                                                                                  
 stack2_block1_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_7[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block1_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block1_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block2_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block2_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_8 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_8 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_8[0][0]']           
                                                                                                  
 stack2_block2_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_8[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block2_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block2_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block1_mlp_output[0][0]'
 )                                                               , 'stack2_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block2_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block2_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_9 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_9 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_9[0][0]']           
                                                                                                  
 stack2_block2_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_9[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block2_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block2_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block3_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block3_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_10 (TFOpLambda)     (None, 32, 32, 256)  0           ['stack2_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_10 (TFOpLambda)    (None, 32, 32, 256)  0           ['tf.nn.relu_10[0][0]']          
                                                                                                  
 stack2_block3_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_10[0][0]']         
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block3_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block3_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block2_mlp_output[0][0]'
 )                                                               , 'stack2_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block3_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block3_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_11 (TFOpLambda)     (None, 32, 32, 512)  0           ['stack2_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_11 (TFOpLambda)    (None, 32, 32, 512)  0           ['tf.nn.relu_11[0][0]']          
                                                                                                  
 stack2_block3_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_11[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block3_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block3_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_downsample_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack3_downsample_pad (ZeroPad  (None, 34, 34, 128)  0          ['stack3_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack3_downsample_conv (Conv2D  (None, 16, 16, 320)  368960     ['stack3_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack3_block1_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack3_block1_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 256, 960)     0           ['stack3_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split (TFOpLambda)          [(None, 256, 320),   0           ['tf.reshape[0][0]']             
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][0]']               
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][1]']               
                                                                                                  
 tf.compat.v1.transpose (TFOpLa  (None, 10, 256, 32)  0          ['tf.reshape_1[0][0]']           
 mbda)                                                                                            
                                                                                                  
 tf.compat.v1.transpose_1 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_2[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda (Lambda)                (None, 10, 256, 256  0           ['tf.compat.v1.transpose[0][0]', 
                                )                                 'tf.compat.v1.transpose_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 10, 256, 256  0           ['lambda[0][0]']                 
                                )                                                                 
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][2]']               
                                                                                                  
 stack3_block1_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply[0][0]']       
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_2 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_1 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_2[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_3 (TFOp  (None, 256, 10, 32)  0          ['lambda_1[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_3[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block1_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack3_block1_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_4[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block1_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block1_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block1_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block1_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_12 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block1_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_12 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_12[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block1_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_12[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block1_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block1_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block1_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block2_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 256, 960)     0           ['stack3_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_1 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_5[0][0]']           
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][0]']             
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_4 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_6[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_5 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_7[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_2 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_4[0][0]'
                                )                                , 'tf.compat.v1.transpose_5[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_2[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][2]']             
                                                                                                  
 stack3_block2_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_1[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_6 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_8[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_3 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_6[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_7 (TFOp  (None, 256, 10, 32)  0          ['lambda_3[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_7[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block2_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block2_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_9[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block2_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block2_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block2_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_13 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block2_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_13 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_13[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block2_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_13[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block2_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block2_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block2_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block3_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_2 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_10[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][0]']             
                                                                                                  
 tf.reshape_12 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_8 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_11[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_9 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_12[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 lambda_4 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_8[0][0]'
                                )                                , 'tf.compat.v1.transpose_9[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_4[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_13 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][2]']             
                                                                                                  
 stack3_block3_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_2[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_10 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_13[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_5 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_10[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_11 (TFO  (None, 256, 10, 32)  0          ['lambda_5[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_14 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_11[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block3_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_14[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block3_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block3_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block3_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_14 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block3_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_14 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_14[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block3_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_14[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block3_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block3_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block3_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block3_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block4_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block4_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_15 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block4_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_3 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_15[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_16 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][0]']             
                                                                                                  
 tf.reshape_17 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_12 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_16[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_13 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_17[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_6 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_12[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_13[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_3 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_6[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_18 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][2]']             
                                                                                                  
 stack3_block4_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_3[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_14 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_18[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_7 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block4_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_14[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_15 (TFO  (None, 256, 10, 32)  0          ['lambda_7[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_19 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_15[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block4_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_19[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block4_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block4_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block4_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block4_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block4_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_15 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block4_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_15 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_15[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block4_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_15[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block4_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block4_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block4_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block4_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block4_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block4_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block5_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block5_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_20 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block5_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_4 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_20[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_21 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][0]']             
                                                                                                  
 tf.reshape_22 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_16 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_21[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_17 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_22[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_8 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_16[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_17[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_4 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_8[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_23 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][2]']             
                                                                                                  
 stack3_block5_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_4[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_18 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_23[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_9 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block5_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_18[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_19 (TFO  (None, 256, 10, 32)  0          ['lambda_9[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_24 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_19[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block5_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_24[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block5_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block5_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block5_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block5_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block5_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_16 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block5_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_16 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_16[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block5_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_16[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block5_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block5_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block5_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block5_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block5_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block5_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block6_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block6_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_25 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block6_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_5 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_25[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_26 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][0]']             
                                                                                                  
 tf.reshape_27 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_20 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_26[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_21 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_27[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_10 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_20[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_21[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_5 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_10[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_28 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][2]']             
                                                                                                  
 stack3_block6_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_5[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_22 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_28[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_11 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block6_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_22[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_23 (TFO  (None, 256, 10, 32)  0          ['lambda_11[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_29 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_23[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block6_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_29[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block6_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block6_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block6_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block6_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block6_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_17 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block6_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_17 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_17[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block6_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_17[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block6_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block6_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block6_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block6_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block6_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block6_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block7_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block7_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_30 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block7_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_6 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_30[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_31 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][0]']             
                                                                                                  
 tf.reshape_32 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_24 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_31[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_25 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_32[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_12 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_24[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_25[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_6 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_12[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_33 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][2]']             
                                                                                                  
 stack3_block7_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_6[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_26 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_33[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_13 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block7_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_26[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_27 (TFO  (None, 256, 10, 32)  0          ['lambda_13[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_34 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_27[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block7_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_34[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block7_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block7_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block7_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block7_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block7_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_18 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block7_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_18 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_18[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block7_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_18[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block7_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block7_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block7_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block7_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block7_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block7_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block8_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block8_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_35 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block8_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_7 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_35[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_36 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][0]']             
                                                                                                  
 tf.reshape_37 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_28 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_36[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_29 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_37[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_14 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_28[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_29[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_7 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_14[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_38 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][2]']             
                                                                                                  
 stack3_block8_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_7[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_30 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_38[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_15 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block8_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_30[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_31 (TFO  (None, 256, 10, 32)  0          ['lambda_15[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_39 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_31[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block8_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_39[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block8_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block8_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block8_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block8_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block8_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_19 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block8_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_19 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_19[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block8_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_19[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block8_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block8_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block8_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block8_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block8_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block8_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block9_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block9_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_40 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block9_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_8 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_40[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_41 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][0]']             
                                                                                                  
 tf.reshape_42 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_32 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_41[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_33 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_42[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_16 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_32[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_33[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_16[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_43 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][2]']             
                                                                                                  
 stack3_block9_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_8[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_34 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_43[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_17 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block9_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_34[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_35 (TFO  (None, 256, 10, 32)  0          ['lambda_17[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_44 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_35[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block9_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_44[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block9_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block9_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block9_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block9_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block9_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_20 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block9_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_20 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_20[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block9_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_20[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block9_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block9_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block9_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block9_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block9_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_downsample_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack4_downsample_pad (ZeroPad  (None, 18, 18, 320)  0          ['stack4_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack4_downsample_conv (Conv2D  (None, 8, 8, 512)   1475072     ['stack4_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack4_block1_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack4_block1_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_45 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_9 (TFOpLambda)        [(None, 64, 512),    0           ['tf.reshape_45[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_46 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][0]']             
                                                                                                  
 tf.reshape_47 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_36 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_46[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_37 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_47[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_18 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_36[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_37[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 16, 64, 64)  0           ['lambda_18[0][0]']              
 )                                                                                                
                                                                                                  
 tf.reshape_48 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][2]']             
                                                                                                  
 stack4_block1_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_9[0][0]']     
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_38 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_48[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_19 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_38[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_39 (TFO  (None, 64, 16, 32)  0           ['lambda_19[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_49 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_39[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack4_block1_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_49[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block1_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block1_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_21 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_21 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_21[0][0]']          
                                                                                                  
 stack4_block1_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_21[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block1_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block1_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block1_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block2_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_50 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_10 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_50[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_51 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][0]']            
                                                                                                  
 tf.reshape_52 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_40 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_51[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_41 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_52[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_20 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_40[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_41[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_10 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_20[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_53 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][2]']            
                                                                                                  
 stack4_block2_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_10[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_42 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_53[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_21 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_42[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_43 (TFO  (None, 64, 16, 32)  0           ['lambda_21[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_54 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_43[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block2_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_54[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block2_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block2_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_22 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_22 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_22[0][0]']          
                                                                                                  
 stack4_block2_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_22[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block2_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block2_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block2_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block3_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_55 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_11 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_55[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_56 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][0]']            
                                                                                                  
 tf.reshape_57 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_44 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_56[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_45 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_57[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_22 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_44[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_45[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_11 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_22[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_58 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][2]']            
                                                                                                  
 stack4_block3_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_11[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_46 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_58[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_23 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_46[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_47 (TFO  (None, 64, 16, 32)  0           ['lambda_23[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_59 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_47[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block3_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_59[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block3_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block3_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_23 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_23 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_23[0][0]']          
                                                                                                  
 stack4_block3_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_23[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 layer_normalization (LayerNorm  (None, 16, 16, 320)  640        ['stack3_block9_mlp_Dense_1[0][0]
 alization)                                                      ']                               
                                                                                                  
 stack4_block3_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 separable_conv2d (SeparableCon  (None, 16, 16, 320)  105600     ['layer_normalization[0][0]']    
 v2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)              (None, 8, 8, 320)    163840      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_5 (Conv2D)              (None, 8, 8, 320)    1474560     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 attention (Attention)          (None, 16, 16, 320)  0           ['separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]']       
                                                                                                  
 add_2 (Add)                    (None, 8, 8, 320)    0           ['conv2d_4[0][0]',               
                                                                  'conv2d_5[0][0]']               
                                                                                                  
 add_4 (Add)                    (None, 16, 16, 320)  0           ['attention[0][0]',              
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_1 (UpSampling2D)  (None, 16, 16, 320)  0          ['add_2[0][0]']                  
                                                                                                  
 dense (Dense)                  (None, 16, 16, 320)  102720      ['add_4[0][0]']                  
                                                                                                  
 batch_normalization_1 (BatchNo  (None, 16, 16, 320)  1280       ['up_sampling2d_1[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_1 (Dense)                (None, 16, 16, 320)  102720      ['dense[0][0]']                  
                                                                                                  
 activation_1 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_1[0][0]']  
                                                                                                  
 add_5 (Add)                    (None, 16, 16, 320)  0           ['add_4[0][0]',                  
                                                                  'dense_1[0][0]']                
                                                                                                  
 add_6 (Add)                    (None, 16, 16, 320)  0           ['activation_1[0][0]',           
                                                                  'add_5[0][0]']                  
                                                                                                  
 conv2d_8 (Conv2D)              (None, 16, 16, 320)  102720      ['add_6[0][0]']                  
                                                                                                  
 batch_normalization_2 (BatchNo  (None, 16, 16, 320)  1280       ['conv2d_8[0][0]']               
 rmalization)                                                                                     
                                                                                                  
 activation_2 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_2[0][0]']  
                                                                                                  
 conv2d (Conv2D)                (None, 8, 8, 512)    262144      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_1 (Conv2D)              (None, 8, 8, 512)    2359296     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_9 (Conv2D)              (None, 16, 16, 128)  40960       ['activation_2[0][0]']           
                                                                                                  
 conv2d_10 (Conv2D)             (None, 16, 16, 128)  368640      ['activation_2[0][0]']           
                                                                                                  
 add (Add)                      (None, 8, 8, 512)    0           ['conv2d[0][0]',                 
                                                                  'conv2d_1[0][0]']               
                                                                                                  
 layer_normalization_1 (LayerNo  (None, 32, 32, 128)  256        ['stack2_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 add_7 (Add)                    (None, 16, 16, 128)  0           ['conv2d_9[0][0]',               
                                                                  'conv2d_10[0][0]']              
                                                                                                  
 up_sampling2d (UpSampling2D)   (None, 32, 32, 512)  0           ['add[0][0]']                    
                                                                                                  
 separable_conv2d_1 (SeparableC  (None, 32, 32, 128)  17664      ['layer_normalization_1[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 up_sampling2d_2 (UpSampling2D)  (None, 32, 32, 128)  0          ['add_7[0][0]']                  
                                                                                                  
 batch_normalization (BatchNorm  (None, 32, 32, 512)  2048       ['up_sampling2d[0][0]']          
 alization)                                                                                       
                                                                                                  
 attention_1 (Attention)        (None, 32, 32, 128)  0           ['separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]']     
                                                                                                  
 batch_normalization_3 (BatchNo  (None, 32, 32, 128)  512        ['up_sampling2d_2[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 activation (Activation)        (None, 32, 32, 512)  0           ['batch_normalization[0][0]']    
                                                                                                  
 add_9 (Add)                    (None, 32, 32, 128)  0           ['attention_1[0][0]',            
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 activation_3 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_3[0][0]']  
                                                                                                  
 conv2d_13 (Conv2D)             (None, 32, 32, 128)  65664       ['activation[0][0]']             
                                                                                                  
 dense_2 (Dense)                (None, 32, 32, 128)  16512       ['add_9[0][0]']                  
                                                                                                  
 add_11 (Add)                   (None, 32, 32, 128)  0           ['activation_3[0][0]',           
                                                                  'conv2d_13[0][0]']              
                                                                                                  
 dense_3 (Dense)                (None, 32, 32, 128)  16512       ['dense_2[0][0]']                
                                                                                                  
 conv2d_14 (Conv2D)             (None, 32, 32, 128)  16512       ['add_11[0][0]']                 
                                                                                                  
 add_10 (Add)                   (None, 32, 32, 128)  0           ['add_9[0][0]',                  
                                                                  'dense_3[0][0]']                
                                                                                                  
 add_12 (Add)                   (None, 32, 32, 128)  0           ['conv2d_14[0][0]',              
                                                                  'add_10[0][0]']                 
                                                                                                  
 conv2d_15 (Conv2D)             (None, 32, 32, 128)  16512       ['add_12[0][0]']                 
                                                                                                  
 batch_normalization_4 (BatchNo  (None, 32, 32, 128)  512        ['conv2d_15[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 layer_normalization_2 (LayerNo  (None, 64, 64, 64)  128         ['stack1_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 activation_4 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_4[0][0]']  
                                                                                                  
 separable_conv2d_2 (SeparableC  (None, 64, 64, 64)  4736        ['layer_normalization_2[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 conv2d_20 (Conv2D)             (None, 32, 32, 64)   8192        ['activation_4[0][0]']           
                                                                                                  
 conv2d_21 (Conv2D)             (None, 32, 32, 64)   73728       ['activation_4[0][0]']           
                                                                                                  
 attention_2 (Attention)        (None, 64, 64, 64)   0           ['separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]']     
                                                                                                  
 add_15 (Add)                   (None, 32, 32, 64)   0           ['conv2d_20[0][0]',              
                                                                  'conv2d_21[0][0]']              
                                                                                                  
 add_17 (Add)                   (None, 64, 64, 64)   0           ['attention_2[0][0]',            
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_4 (UpSampling2D)  (None, 64, 64, 64)  0           ['add_15[0][0]']                 
                                                                                                  
 dense_4 (Dense)                (None, 64, 64, 64)   4160        ['add_17[0][0]']                 
                                                                                                  
 batch_normalization_6 (BatchNo  (None, 64, 64, 64)  256         ['up_sampling2d_4[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_5 (Dense)                (None, 64, 64, 64)   4160        ['dense_4[0][0]']                
                                                                                                  
 activation_6 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_6[0][0]']  
                                                                                                  
 add_18 (Add)                   (None, 64, 64, 64)   0           ['add_17[0][0]',                 
                                                                  'dense_5[0][0]']                
                                                                                                  
 add_19 (Add)                   (None, 64, 64, 64)   0           ['activation_6[0][0]',           
                                                                  'add_18[0][0]']                 
                                                                                                  
 conv2d_24 (Conv2D)             (None, 64, 64, 64)   4160        ['add_19[0][0]']                 
                                                                                                  
 conv2d_16 (Conv2D)             (None, 32, 32, 128)  16384       ['activation_4[0][0]']           
                                                                                                  
 conv2d_17 (Conv2D)             (None, 32, 32, 128)  147456      ['activation_4[0][0]']           
                                                                                                  
 batch_normalization_7 (BatchNo  (None, 64, 64, 64)  256         ['conv2d_24[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 add_13 (Add)                   (None, 32, 32, 128)  0           ['conv2d_16[0][0]',              
                                                                  'conv2d_17[0][0]']              
                                                                                                  
 activation_7 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_7[0][0]']  
                                                                                                  
 up_sampling2d_3 (UpSampling2D)  (None, 256, 256, 12  0          ['add_13[0][0]']                 
                                8)                                                                
                                                                                                  
 conv2d_26 (Conv2D)             (None, 64, 64, 32)   2048        ['activation_7[0][0]']           
                                                                                                  
 conv2d_27 (Conv2D)             (None, 64, 64, 32)   18432       ['activation_7[0][0]']           
                                                                                                  
 batch_normalization_5 (BatchNo  (None, 256, 256, 12  512        ['up_sampling2d_3[0][0]']        
 rmalization)                   8)                                                                
                                                                                                  
 add_20 (Add)                   (None, 64, 64, 32)   0           ['conv2d_26[0][0]',              
                                                                  'conv2d_27[0][0]']              
                                                                                                  
 activation_5 (Activation)      (None, 256, 256, 12  0           ['batch_normalization_5[0][0]']  
                                8)                                                                
                                                                                                  
 up_sampling2d_5 (UpSampling2D)  (None, 256, 256, 32  0          ['add_20[0][0]']                 
                                )                                                                 
                                                                                                  
 conv2d_25 (Conv2D)             (None, 256, 256, 32  4128        ['activation_5[0][0]']           
                                )                                                                 
                                                                                                  
 batch_normalization_9 (BatchNo  (None, 256, 256, 32  128        ['up_sampling2d_5[0][0]']        
 rmalization)                   )                                                                 
                                                                                                  
 batch_normalization_8 (BatchNo  (None, 256, 256, 32  128        ['conv2d_25[0][0]']              
 rmalization)                   )                                                                 
                                                                                                  
 activation_9 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_9[0][0]']  
                                )                                                                 
                                                                                                  
 activation_8 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_8[0][0]']  
                                )                                                                 
                                                                                                  
 add_22 (Add)                   (None, 256, 256, 32  0           ['activation_9[0][0]',           
                                )                                 'activation_8[0][0]']           
                                                                                                  
 conv2d_30 (Conv2D)             (None, 256, 256, 32  1056        ['add_22[0][0]']                 
                                )                                                                 
                                                                                                  
 batch_normalization_10 (BatchN  (None, 256, 256, 32  128        ['conv2d_30[0][0]']              
 ormalization)                  )                                                                 
                                                                                                  
 activation_10 (Activation)     (None, 256, 256, 32  0           ['batch_normalization_10[0][0]'] 
                                )                                                                 
                                                                                                  
 conv2d_31 (Conv2D)             (None, 256, 256, 1)  33          ['activation_10[0][0]']          
                                                                                                  
==================================================================================================
Total params: 28,765,713
Trainable params: 28,762,193
Non-trainable params: 3,520
__________________________________________________________________________________________________
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 stem_ (ZeroPadding2D)          (None, 260, 260, 3)  0           ['input_1[0][0]']                
                                                                                                  
 stem_conv (Conv2D)             (None, 64, 64, 64)   9472        ['stem_[0][0]']                  
                                                                                                  
 stem_ln (LayerNormalization)   (None, 64, 64, 64)   64          ['stem_conv[0][0]']              
                                                                                                  
 stack1_block1_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stem_ln[0][0]']                
 rmalization)                                                                                     
                                                                                                  
 stack1_block1_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu (TFOpLambda)        (None, 64, 64, 128)  0           ['stack1_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow (TFOpLambda)       (None, 64, 64, 128)  0           ['tf.nn.relu[0][0]']             
                                                                                                  
 stack1_block1_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow[0][0]']            
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block1_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block1_attn_output (Add  (None, 64, 64, 64)  0           ['stem_ln[0][0]',                
 )                                                                'stack1_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack1_block1_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block1_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_1 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_1 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_1[0][0]']           
                                                                                                  
 stack1_block1_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_1[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block1_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block1_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block2_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block2_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_2 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_2 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_2[0][0]']           
                                                                                                  
 stack1_block2_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_2[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block2_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block2_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block1_mlp_output[0][0]'
 )                                                               , 'stack1_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block2_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block2_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_3 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_3 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_3[0][0]']           
                                                                                                  
 stack1_block2_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_3[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block2_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block2_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block3_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block3_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_4 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_4 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_4[0][0]']           
                                                                                                  
 stack1_block3_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_4[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block3_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block3_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block2_mlp_output[0][0]'
 )                                                               , 'stack1_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block3_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block3_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_5 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_5 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_5[0][0]']           
                                                                                                  
 stack1_block3_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_5[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block3_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block3_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_downsample_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack2_downsample_pad (ZeroPad  (None, 66, 66, 64)  0           ['stack2_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack2_downsample_conv (Conv2D  (None, 32, 32, 128)  73856      ['stack2_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack2_block1_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack2_block1_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_6 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_6 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_6[0][0]']           
                                                                                                  
 stack2_block1_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_6[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block1_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block1_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_downsample_conv[0][0]', 
 )                                                                'stack2_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack2_block1_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block1_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_7 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_7 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_7[0][0]']           
                                                                                                  
 stack2_block1_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_7[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block1_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block1_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block2_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block2_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_8 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_8 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_8[0][0]']           
                                                                                                  
 stack2_block2_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_8[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block2_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block2_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block1_mlp_output[0][0]'
 )                                                               , 'stack2_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block2_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block2_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_9 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_9 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_9[0][0]']           
                                                                                                  
 stack2_block2_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_9[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block2_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block2_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block3_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block3_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_10 (TFOpLambda)     (None, 32, 32, 256)  0           ['stack2_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_10 (TFOpLambda)    (None, 32, 32, 256)  0           ['tf.nn.relu_10[0][0]']          
                                                                                                  
 stack2_block3_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_10[0][0]']         
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block3_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block3_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block2_mlp_output[0][0]'
 )                                                               , 'stack2_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block3_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block3_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_11 (TFOpLambda)     (None, 32, 32, 512)  0           ['stack2_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_11 (TFOpLambda)    (None, 32, 32, 512)  0           ['tf.nn.relu_11[0][0]']          
                                                                                                  
 stack2_block3_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_11[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block3_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block3_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_downsample_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack3_downsample_pad (ZeroPad  (None, 34, 34, 128)  0          ['stack3_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack3_downsample_conv (Conv2D  (None, 16, 16, 320)  368960     ['stack3_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack3_block1_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack3_block1_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 256, 960)     0           ['stack3_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split (TFOpLambda)          [(None, 256, 320),   0           ['tf.reshape[0][0]']             
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][0]']               
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][1]']               
                                                                                                  
 tf.compat.v1.transpose (TFOpLa  (None, 10, 256, 32)  0          ['tf.reshape_1[0][0]']           
 mbda)                                                                                            
                                                                                                  
 tf.compat.v1.transpose_1 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_2[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda (Lambda)                (None, 10, 256, 256  0           ['tf.compat.v1.transpose[0][0]', 
                                )                                 'tf.compat.v1.transpose_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 10, 256, 256  0           ['lambda[0][0]']                 
                                )                                                                 
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][2]']               
                                                                                                  
 stack3_block1_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply[0][0]']       
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_2 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_1 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_2[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_3 (TFOp  (None, 256, 10, 32)  0          ['lambda_1[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_3[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block1_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack3_block1_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_4[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block1_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block1_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block1_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block1_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_12 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block1_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_12 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_12[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block1_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_12[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block1_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block1_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block1_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block2_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 256, 960)     0           ['stack3_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_1 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_5[0][0]']           
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][0]']             
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_4 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_6[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_5 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_7[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_2 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_4[0][0]'
                                )                                , 'tf.compat.v1.transpose_5[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_2[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][2]']             
                                                                                                  
 stack3_block2_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_1[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_6 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_8[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_3 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_6[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_7 (TFOp  (None, 256, 10, 32)  0          ['lambda_3[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_7[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block2_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block2_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_9[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block2_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block2_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block2_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_13 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block2_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_13 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_13[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block2_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_13[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block2_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block2_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block2_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block3_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_2 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_10[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][0]']             
                                                                                                  
 tf.reshape_12 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_8 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_11[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_9 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_12[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 lambda_4 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_8[0][0]'
                                )                                , 'tf.compat.v1.transpose_9[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_4[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_13 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][2]']             
                                                                                                  
 stack3_block3_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_2[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_10 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_13[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_5 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_10[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_11 (TFO  (None, 256, 10, 32)  0          ['lambda_5[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_14 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_11[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block3_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_14[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block3_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block3_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block3_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_14 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block3_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_14 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_14[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block3_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_14[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block3_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block3_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block3_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block3_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block4_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block4_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_15 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block4_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_3 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_15[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_16 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][0]']             
                                                                                                  
 tf.reshape_17 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_12 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_16[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_13 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_17[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_6 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_12[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_13[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_3 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_6[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_18 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][2]']             
                                                                                                  
 stack3_block4_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_3[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_14 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_18[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_7 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block4_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_14[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_15 (TFO  (None, 256, 10, 32)  0          ['lambda_7[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_19 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_15[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block4_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_19[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block4_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block4_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block4_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block4_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block4_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_15 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block4_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_15 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_15[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block4_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_15[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block4_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block4_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block4_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block4_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block4_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block4_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block5_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block5_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_20 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block5_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_4 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_20[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_21 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][0]']             
                                                                                                  
 tf.reshape_22 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_16 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_21[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_17 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_22[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_8 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_16[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_17[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_4 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_8[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_23 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][2]']             
                                                                                                  
 stack3_block5_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_4[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_18 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_23[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_9 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block5_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_18[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_19 (TFO  (None, 256, 10, 32)  0          ['lambda_9[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_24 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_19[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block5_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_24[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block5_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block5_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block5_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block5_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block5_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_16 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block5_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_16 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_16[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block5_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_16[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block5_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block5_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block5_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block5_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block5_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block5_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block6_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block6_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_25 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block6_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_5 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_25[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_26 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][0]']             
                                                                                                  
 tf.reshape_27 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_20 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_26[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_21 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_27[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_10 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_20[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_21[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_5 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_10[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_28 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][2]']             
                                                                                                  
 stack3_block6_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_5[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_22 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_28[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_11 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block6_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_22[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_23 (TFO  (None, 256, 10, 32)  0          ['lambda_11[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_29 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_23[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block6_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_29[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block6_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block6_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block6_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block6_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block6_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_17 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block6_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_17 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_17[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block6_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_17[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block6_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block6_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block6_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block6_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block6_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block6_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block7_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block7_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_30 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block7_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_6 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_30[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_31 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][0]']             
                                                                                                  
 tf.reshape_32 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_24 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_31[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_25 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_32[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_12 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_24[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_25[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_6 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_12[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_33 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][2]']             
                                                                                                  
 stack3_block7_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_6[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_26 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_33[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_13 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block7_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_26[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_27 (TFO  (None, 256, 10, 32)  0          ['lambda_13[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_34 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_27[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block7_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_34[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block7_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block7_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block7_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block7_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block7_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_18 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block7_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_18 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_18[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block7_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_18[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block7_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block7_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block7_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block7_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block7_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block7_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block8_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block8_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_35 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block8_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_7 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_35[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_36 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][0]']             
                                                                                                  
 tf.reshape_37 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_28 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_36[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_29 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_37[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_14 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_28[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_29[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_7 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_14[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_38 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][2]']             
                                                                                                  
 stack3_block8_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_7[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_30 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_38[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_15 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block8_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_30[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_31 (TFO  (None, 256, 10, 32)  0          ['lambda_15[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_39 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_31[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block8_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_39[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block8_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block8_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block8_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block8_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block8_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_19 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block8_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_19 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_19[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block8_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_19[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block8_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block8_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block8_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block8_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block8_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block8_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block9_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block9_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_40 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block9_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_8 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_40[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_41 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][0]']             
                                                                                                  
 tf.reshape_42 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_32 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_41[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_33 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_42[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_16 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_32[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_33[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_16[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_43 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][2]']             
                                                                                                  
 stack3_block9_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_8[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_34 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_43[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_17 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block9_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_34[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_35 (TFO  (None, 256, 10, 32)  0          ['lambda_17[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_44 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_35[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block9_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_44[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block9_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block9_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block9_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block9_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block9_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_20 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block9_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_20 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_20[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block9_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_20[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block9_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block9_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block9_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block9_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block9_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_downsample_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack4_downsample_pad (ZeroPad  (None, 18, 18, 320)  0          ['stack4_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack4_downsample_conv (Conv2D  (None, 8, 8, 512)   1475072     ['stack4_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack4_block1_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack4_block1_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_45 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_9 (TFOpLambda)        [(None, 64, 512),    0           ['tf.reshape_45[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_46 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][0]']             
                                                                                                  
 tf.reshape_47 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_36 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_46[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_37 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_47[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_18 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_36[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_37[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 16, 64, 64)  0           ['lambda_18[0][0]']              
 )                                                                                                
                                                                                                  
 tf.reshape_48 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][2]']             
                                                                                                  
 stack4_block1_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_9[0][0]']     
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_38 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_48[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_19 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_38[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_39 (TFO  (None, 64, 16, 32)  0           ['lambda_19[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_49 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_39[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack4_block1_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_49[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block1_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block1_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_21 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_21 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_21[0][0]']          
                                                                                                  
 stack4_block1_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_21[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block1_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block1_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block1_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block2_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_50 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_10 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_50[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_51 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][0]']            
                                                                                                  
 tf.reshape_52 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_40 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_51[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_41 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_52[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_20 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_40[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_41[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_10 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_20[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_53 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][2]']            
                                                                                                  
 stack4_block2_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_10[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_42 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_53[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_21 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_42[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_43 (TFO  (None, 64, 16, 32)  0           ['lambda_21[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_54 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_43[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block2_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_54[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block2_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block2_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_22 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_22 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_22[0][0]']          
                                                                                                  
 stack4_block2_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_22[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block2_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block2_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block2_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block3_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_55 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_11 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_55[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_56 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][0]']            
                                                                                                  
 tf.reshape_57 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_44 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_56[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_45 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_57[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_22 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_44[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_45[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_11 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_22[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_58 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][2]']            
                                                                                                  
 stack4_block3_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_11[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_46 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_58[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_23 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_46[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_47 (TFO  (None, 64, 16, 32)  0           ['lambda_23[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_59 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_47[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block3_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_59[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block3_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block3_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_23 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_23 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_23[0][0]']          
                                                                                                  
 stack4_block3_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_23[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 layer_normalization (LayerNorm  (None, 16, 16, 320)  640        ['stack3_block9_mlp_Dense_1[0][0]
 alization)                                                      ']                               
                                                                                                  
 stack4_block3_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 separable_conv2d (SeparableCon  (None, 16, 16, 320)  105600     ['layer_normalization[0][0]']    
 v2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)              (None, 8, 8, 320)    163840      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_5 (Conv2D)              (None, 8, 8, 320)    1474560     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 attention (Attention)          (None, 16, 16, 320)  0           ['separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]']       
                                                                                                  
 add_2 (Add)                    (None, 8, 8, 320)    0           ['conv2d_4[0][0]',               
                                                                  'conv2d_5[0][0]']               
                                                                                                  
 add_4 (Add)                    (None, 16, 16, 320)  0           ['attention[0][0]',              
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_1 (UpSampling2D)  (None, 16, 16, 320)  0          ['add_2[0][0]']                  
                                                                                                  
 dense (Dense)                  (None, 16, 16, 320)  102720      ['add_4[0][0]']                  
                                                                                                  
 batch_normalization_1 (BatchNo  (None, 16, 16, 320)  1280       ['up_sampling2d_1[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_1 (Dense)                (None, 16, 16, 320)  102720      ['dense[0][0]']                  
                                                                                                  
 activation_1 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_1[0][0]']  
                                                                                                  
 add_5 (Add)                    (None, 16, 16, 320)  0           ['add_4[0][0]',                  
                                                                  'dense_1[0][0]']                
                                                                                                  
 add_6 (Add)                    (None, 16, 16, 320)  0           ['activation_1[0][0]',           
                                                                  'add_5[0][0]']                  
                                                                                                  
 conv2d_8 (Conv2D)              (None, 16, 16, 320)  102720      ['add_6[0][0]']                  
                                                                                                  
 batch_normalization_2 (BatchNo  (None, 16, 16, 320)  1280       ['conv2d_8[0][0]']               
 rmalization)                                                                                     
                                                                                                  
 activation_2 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_2[0][0]']  
                                                                                                  
 conv2d (Conv2D)                (None, 8, 8, 512)    262144      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_1 (Conv2D)              (None, 8, 8, 512)    2359296     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_9 (Conv2D)              (None, 16, 16, 128)  40960       ['activation_2[0][0]']           
                                                                                                  
 conv2d_10 (Conv2D)             (None, 16, 16, 128)  368640      ['activation_2[0][0]']           
                                                                                                  
 add (Add)                      (None, 8, 8, 512)    0           ['conv2d[0][0]',                 
                                                                  'conv2d_1[0][0]']               
                                                                                                  
 layer_normalization_1 (LayerNo  (None, 32, 32, 128)  256        ['stack2_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 add_7 (Add)                    (None, 16, 16, 128)  0           ['conv2d_9[0][0]',               
                                                                  'conv2d_10[0][0]']              
                                                                                                  
 up_sampling2d (UpSampling2D)   (None, 32, 32, 512)  0           ['add[0][0]']                    
                                                                                                  
 separable_conv2d_1 (SeparableC  (None, 32, 32, 128)  17664      ['layer_normalization_1[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 up_sampling2d_2 (UpSampling2D)  (None, 32, 32, 128)  0          ['add_7[0][0]']                  
                                                                                                  
 batch_normalization (BatchNorm  (None, 32, 32, 512)  2048       ['up_sampling2d[0][0]']          
 alization)                                                                                       
                                                                                                  
 attention_1 (Attention)        (None, 32, 32, 128)  0           ['separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]']     
                                                                                                  
 batch_normalization_3 (BatchNo  (None, 32, 32, 128)  512        ['up_sampling2d_2[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 activation (Activation)        (None, 32, 32, 512)  0           ['batch_normalization[0][0]']    
                                                                                                  
 add_9 (Add)                    (None, 32, 32, 128)  0           ['attention_1[0][0]',            
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 activation_3 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_3[0][0]']  
                                                                                                  
 conv2d_13 (Conv2D)             (None, 32, 32, 128)  65664       ['activation[0][0]']             
                                                                                                  
 dense_2 (Dense)                (None, 32, 32, 128)  16512       ['add_9[0][0]']                  
                                                                                                  
 add_11 (Add)                   (None, 32, 32, 128)  0           ['activation_3[0][0]',           
                                                                  'conv2d_13[0][0]']              
                                                                                                  
 dense_3 (Dense)                (None, 32, 32, 128)  16512       ['dense_2[0][0]']                
                                                                                                  
 conv2d_14 (Conv2D)             (None, 32, 32, 128)  16512       ['add_11[0][0]']                 
                                                                                                  
 add_10 (Add)                   (None, 32, 32, 128)  0           ['add_9[0][0]',                  
                                                                  'dense_3[0][0]']                
                                                                                                  
 add_12 (Add)                   (None, 32, 32, 128)  0           ['conv2d_14[0][0]',              
                                                                  'add_10[0][0]']                 
                                                                                                  
 conv2d_15 (Conv2D)             (None, 32, 32, 128)  16512       ['add_12[0][0]']                 
                                                                                                  
 batch_normalization_4 (BatchNo  (None, 32, 32, 128)  512        ['conv2d_15[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 layer_normalization_2 (LayerNo  (None, 64, 64, 64)  128         ['stack1_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 activation_4 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_4[0][0]']  
                                                                                                  
 separable_conv2d_2 (SeparableC  (None, 64, 64, 64)  4736        ['layer_normalization_2[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 conv2d_20 (Conv2D)             (None, 32, 32, 64)   8192        ['activation_4[0][0]']           
                                                                                                  
 conv2d_21 (Conv2D)             (None, 32, 32, 64)   73728       ['activation_4[0][0]']           
                                                                                                  
 attention_2 (Attention)        (None, 64, 64, 64)   0           ['separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]']     
                                                                                                  
 add_15 (Add)                   (None, 32, 32, 64)   0           ['conv2d_20[0][0]',              
                                                                  'conv2d_21[0][0]']              
                                                                                                  
 add_17 (Add)                   (None, 64, 64, 64)   0           ['attention_2[0][0]',            
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_4 (UpSampling2D)  (None, 64, 64, 64)  0           ['add_15[0][0]']                 
                                                                                                  
 dense_4 (Dense)                (None, 64, 64, 64)   4160        ['add_17[0][0]']                 
                                                                                                  
 batch_normalization_6 (BatchNo  (None, 64, 64, 64)  256         ['up_sampling2d_4[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_5 (Dense)                (None, 64, 64, 64)   4160        ['dense_4[0][0]']                
                                                                                                  
 activation_6 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_6[0][0]']  
                                                                                                  
 add_18 (Add)                   (None, 64, 64, 64)   0           ['add_17[0][0]',                 
                                                                  'dense_5[0][0]']                
                                                                                                  
 add_19 (Add)                   (None, 64, 64, 64)   0           ['activation_6[0][0]',           
                                                                  'add_18[0][0]']                 
                                                                                                  
 conv2d_24 (Conv2D)             (None, 64, 64, 64)   4160        ['add_19[0][0]']                 
                                                                                                  
 conv2d_16 (Conv2D)             (None, 32, 32, 128)  16384       ['activation_4[0][0]']           
                                                                                                  
 conv2d_17 (Conv2D)             (None, 32, 32, 128)  147456      ['activation_4[0][0]']           
                                                                                                  
 batch_normalization_7 (BatchNo  (None, 64, 64, 64)  256         ['conv2d_24[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 add_13 (Add)                   (None, 32, 32, 128)  0           ['conv2d_16[0][0]',              
                                                                  'conv2d_17[0][0]']              
                                                                                                  
 activation_7 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_7[0][0]']  
                                                                                                  
 up_sampling2d_3 (UpSampling2D)  (None, 256, 256, 12  0          ['add_13[0][0]']                 
                                8)                                                                
                                                                                                  
 conv2d_26 (Conv2D)             (None, 64, 64, 32)   2048        ['activation_7[0][0]']           
                                                                                                  
 conv2d_27 (Conv2D)             (None, 64, 64, 32)   18432       ['activation_7[0][0]']           
                                                                                                  
 batch_normalization_5 (BatchNo  (None, 256, 256, 12  512        ['up_sampling2d_3[0][0]']        
 rmalization)                   8)                                                                
                                                                                                  
 add_20 (Add)                   (None, 64, 64, 32)   0           ['conv2d_26[0][0]',              
                                                                  'conv2d_27[0][0]']              
                                                                                                  
 activation_5 (Activation)      (None, 256, 256, 12  0           ['batch_normalization_5[0][0]']  
                                8)                                                                
                                                                                                  
 up_sampling2d_5 (UpSampling2D)  (None, 256, 256, 32  0          ['add_20[0][0]']                 
                                )                                                                 
                                                                                                  
 conv2d_25 (Conv2D)             (None, 256, 256, 32  4128        ['activation_5[0][0]']           
                                )                                                                 
                                                                                                  
 batch_normalization_9 (BatchNo  (None, 256, 256, 32  128        ['up_sampling2d_5[0][0]']        
 rmalization)                   )                                                                 
                                                                                                  
 batch_normalization_8 (BatchNo  (None, 256, 256, 32  128        ['conv2d_25[0][0]']              
 rmalization)                   )                                                                 
                                                                                                  
 activation_9 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_9[0][0]']  
                                )                                                                 
                                                                                                  
 activation_8 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_8[0][0]']  
                                )                                                                 
                                                                                                  
 add_22 (Add)                   (None, 256, 256, 32  0           ['activation_9[0][0]',           
                                )                                 'activation_8[0][0]']           
                                                                                                  
 conv2d_30 (Conv2D)             (None, 256, 256, 32  1056        ['add_22[0][0]']                 
                                )                                                                 
                                                                                                  
 batch_normalization_10 (BatchN  (None, 256, 256, 32  128        ['conv2d_30[0][0]']              
 ormalization)                  )                                                                 
                                                                                                  
 activation_10 (Activation)     (None, 256, 256, 32  0           ['batch_normalization_10[0][0]'] 
                                )                                                                 
                                                                                                  
 conv2d_31 (Conv2D)             (None, 256, 256, 1)  33          ['activation_10[0][0]']          
                                                                                                  
==================================================================================================
Total params: 28,765,713
Trainable params: 28,762,193
Non-trainable params: 3,520
__________________________________________________________________________________________________
Model: "model"
__________________________________________________________________________________________________
 Layer (type)                   Output Shape         Param #     Connected to                     
==================================================================================================
 input_1 (InputLayer)           [(None, 256, 256, 3  0           []                               
                                )]                                                                
                                                                                                  
 stem_ (ZeroPadding2D)          (None, 260, 260, 3)  0           ['input_1[0][0]']                
                                                                                                  
 stem_conv (Conv2D)             (None, 64, 64, 64)   9472        ['stem_[0][0]']                  
                                                                                                  
 stem_ln (LayerNormalization)   (None, 64, 64, 64)   64          ['stem_conv[0][0]']              
                                                                                                  
 stack1_block1_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stem_ln[0][0]']                
 rmalization)                                                                                     
                                                                                                  
 stack1_block1_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu (TFOpLambda)        (None, 64, 64, 128)  0           ['stack1_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow (TFOpLambda)       (None, 64, 64, 128)  0           ['tf.nn.relu[0][0]']             
                                                                                                  
 stack1_block1_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow[0][0]']            
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block1_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block1_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block1_attn_output (Add  (None, 64, 64, 64)  0           ['stem_ln[0][0]',                
 )                                                                'stack1_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack1_block1_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block1_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_1 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_1 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_1[0][0]']           
                                                                                                  
 stack1_block1_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_1[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block1_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block1_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block2_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block2_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_2 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_2 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_2[0][0]']           
                                                                                                  
 stack1_block2_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_2[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block2_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block2_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block2_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block1_mlp_output[0][0]'
 )                                                               , 'stack1_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block2_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block2_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_3 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_3 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_3[0][0]']           
                                                                                                  
 stack1_block2_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_3[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block2_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block2_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack1_block3_attn_ln (LayerNo  (None, 64, 64, 64)  64          ['stack1_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack1_block3_mlp_sep_1_dense   (None, 64, 64, 128)  8192       ['stack1_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_4 (TFOpLambda)      (None, 64, 64, 128)  0           ['stack1_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_4 (TFOpLambda)     (None, 64, 64, 128)  0           ['tf.nn.relu_4[0][0]']           
                                                                                                  
 stack1_block3_mlp_sep_star_rel  (None, 64, 64, 128)  2          ['tf.math.pow_4[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_p  (None, 70, 70, 128)  0          ['stack1_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack1_block3_mlp_sep_mid_dw_c  (None, 64, 64, 128)  6272       ['stack1_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack1_block3_mlp_sep_2_dense   (None, 64, 64, 64)  8192        ['stack1_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack1_block3_attn_output (Add  (None, 64, 64, 64)  0           ['stack1_block2_mlp_output[0][0]'
 )                                                               , 'stack1_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack1_block3_mlp_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack1_block3_mlp_Dense_0 (Den  (None, 64, 64, 256)  16384      ['stack1_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_5 (TFOpLambda)      (None, 64, 64, 256)  0           ['stack1_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_5 (TFOpLambda)     (None, 64, 64, 256)  0           ['tf.nn.relu_5[0][0]']           
                                                                                                  
 stack1_block3_mlp_star_relu (Z  (None, 64, 64, 256)  2          ['tf.math.pow_5[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack1_block3_mlp_Dense_1 (Den  (None, 64, 64, 64)  16384       ['stack1_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack1_block3_mlp_output (Add)  (None, 64, 64, 64)  0           ['stack1_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_downsample_ln (LayerNor  (None, 64, 64, 64)  64          ['stack1_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack2_downsample_pad (ZeroPad  (None, 66, 66, 64)  0           ['stack2_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack2_downsample_conv (Conv2D  (None, 32, 32, 128)  73856      ['stack2_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack2_block1_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack2_block1_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block1_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_6 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block1_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_6 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_6[0][0]']           
                                                                                                  
 stack2_block1_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_6[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block1_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block1_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block1_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block1_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block1_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block1_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_downsample_conv[0][0]', 
 )                                                                'stack2_block1_mlp_sep_2_dense[0
                                                                 ][0]']                           
                                                                                                  
 stack2_block1_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block1_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_7 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_7 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_7[0][0]']           
                                                                                                  
 stack2_block1_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_7[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block1_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block1_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block1_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block2_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block2_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block2_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_8 (TFOpLambda)      (None, 32, 32, 256)  0           ['stack2_block2_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_8 (TFOpLambda)     (None, 32, 32, 256)  0           ['tf.nn.relu_8[0][0]']           
                                                                                                  
 stack2_block2_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_8[0][0]']          
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block2_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block2_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block2_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block2_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block2_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block2_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block1_mlp_output[0][0]'
 )                                                               , 'stack2_block2_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block2_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block2_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_9 (TFOpLambda)      (None, 32, 32, 512)  0           ['stack2_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_9 (TFOpLambda)     (None, 32, 32, 512)  0           ['tf.nn.relu_9[0][0]']           
                                                                                                  
 stack2_block2_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_9[0][0]']          
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block2_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block2_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block2_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack2_block3_attn_ln (LayerNo  (None, 32, 32, 128)  128        ['stack2_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack2_block3_mlp_sep_1_dense   (None, 32, 32, 256)  32768      ['stack2_block3_attn_ln[0][0]']  
 (Dense)                                                                                          
                                                                                                  
 tf.nn.relu_10 (TFOpLambda)     (None, 32, 32, 256)  0           ['stack2_block3_mlp_sep_1_dense[0
                                                                 ][0]']                           
                                                                                                  
 tf.math.pow_10 (TFOpLambda)    (None, 32, 32, 256)  0           ['tf.nn.relu_10[0][0]']          
                                                                                                  
 stack2_block3_mlp_sep_star_rel  (None, 32, 32, 256)  2          ['tf.math.pow_10[0][0]']         
 u (ZeroInitGain)                                                                                 
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_p  (None, 38, 38, 256)  0          ['stack2_block3_mlp_sep_star_relu
 ad (ZeroPadding2D)                                              [0][0]']                         
                                                                                                  
 stack2_block3_mlp_sep_mid_dw_c  (None, 32, 32, 256)  12544      ['stack2_block3_mlp_sep_mid_dw_pa
 onv (DepthwiseConv2D)                                           d[0][0]']                        
                                                                                                  
 stack2_block3_mlp_sep_2_dense   (None, 32, 32, 128)  32768      ['stack2_block3_mlp_sep_mid_dw_co
 (Dense)                                                         nv[0][0]']                       
                                                                                                  
 stack2_block3_attn_output (Add  (None, 32, 32, 128)  0          ['stack2_block2_mlp_output[0][0]'
 )                                                               , 'stack2_block3_mlp_sep_2_dense[
                                                                 0][0]']                          
                                                                                                  
 stack2_block3_mlp_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack2_block3_mlp_Dense_0 (Den  (None, 32, 32, 512)  65536      ['stack2_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_11 (TFOpLambda)     (None, 32, 32, 512)  0           ['stack2_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_11 (TFOpLambda)    (None, 32, 32, 512)  0           ['tf.nn.relu_11[0][0]']          
                                                                                                  
 stack2_block3_mlp_star_relu (Z  (None, 32, 32, 512)  2          ['tf.math.pow_11[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack2_block3_mlp_Dense_1 (Den  (None, 32, 32, 128)  65536      ['stack2_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack2_block3_mlp_output (Add)  (None, 32, 32, 128)  0          ['stack2_block3_attn_output[0][0]
                                                                 ',                               
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_downsample_ln (LayerNor  (None, 32, 32, 128)  128        ['stack2_block3_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack3_downsample_pad (ZeroPad  (None, 34, 34, 128)  0          ['stack3_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack3_downsample_conv (Conv2D  (None, 16, 16, 320)  368960     ['stack3_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack3_block1_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack3_block1_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape (TFOpLambda)        (None, 256, 960)     0           ['stack3_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split (TFOpLambda)          [(None, 256, 320),   0           ['tf.reshape[0][0]']             
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_1 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][0]']               
                                                                                                  
 tf.reshape_2 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][1]']               
                                                                                                  
 tf.compat.v1.transpose (TFOpLa  (None, 10, 256, 32)  0          ['tf.reshape_1[0][0]']           
 mbda)                                                                                            
                                                                                                  
 tf.compat.v1.transpose_1 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_2[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda (Lambda)                (None, 10, 256, 256  0           ['tf.compat.v1.transpose[0][0]', 
                                )                                 'tf.compat.v1.transpose_1[0][0]'
                                                                 ]                                
                                                                                                  
 tf.math.multiply (TFOpLambda)  (None, 10, 256, 256  0           ['lambda[0][0]']                 
                                )                                                                 
                                                                                                  
 tf.reshape_3 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split[0][2]']               
                                                                                                  
 stack3_block1_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply[0][0]']       
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_2 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_3[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_1 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_2[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_3 (TFOp  (None, 256, 10, 32)  0          ['lambda_1[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_4 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_3[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block1_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack3_block1_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_4[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block1_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block1_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block1_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block1_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_12 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block1_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_12 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_12[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block1_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_12[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block1_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block1_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block1_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block2_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_5 (TFOpLambda)      (None, 256, 960)     0           ['stack3_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_1 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_5[0][0]']           
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_6 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][0]']             
                                                                                                  
 tf.reshape_7 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_4 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_6[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_5 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_7[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_2 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_4[0][0]'
                                )                                , 'tf.compat.v1.transpose_5[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_1 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_2[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_8 (TFOpLambda)      (None, 256, 10, 32)  0           ['tf.split_1[0][2]']             
                                                                                                  
 stack3_block2_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_1[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_6 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_8[0][0]']           
 Lambda)                                                                                          
                                                                                                  
 lambda_3 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_6[0][0]'
                                                                 ]                                
                                                                                                  
 tf.compat.v1.transpose_7 (TFOp  (None, 256, 10, 32)  0          ['lambda_3[0][0]']               
 Lambda)                                                                                          
                                                                                                  
 tf.reshape_9 (TFOpLambda)      (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_7[0][0]'
                                                                 ]                                
                                                                                                  
 stack3_block2_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block2_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_9[0][0]']           
 se)                                                                                              
                                                                                                  
 stack3_block2_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block2_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block2_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block2_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_13 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block2_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_13 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_13[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block2_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_13[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block2_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block2_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block2_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block3_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_10 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_2 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_10[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_11 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][0]']             
                                                                                                  
 tf.reshape_12 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_8 (TFOp  (None, 10, 256, 32)  0          ['tf.reshape_11[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 tf.compat.v1.transpose_9 (TFOp  (None, 10, 32, 256)  0          ['tf.reshape_12[0][0]']          
 Lambda)                                                                                          
                                                                                                  
 lambda_4 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_8[0][0]'
                                )                                , 'tf.compat.v1.transpose_9[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_2 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_4[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_13 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_2[0][2]']             
                                                                                                  
 stack3_block3_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_2[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_10 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_13[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_5 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_10[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_11 (TFO  (None, 256, 10, 32)  0          ['lambda_5[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_14 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_11[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block3_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_14[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block3_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block3_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block3_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block3_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_14 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block3_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_14 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_14[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block3_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_14[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block3_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block3_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block3_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block3_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block3_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block4_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block4_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_15 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block4_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_3 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_15[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_16 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][0]']             
                                                                                                  
 tf.reshape_17 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_12 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_16[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_13 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_17[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_6 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_12[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_13[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_3 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_6[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_18 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_3[0][2]']             
                                                                                                  
 stack3_block4_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_3[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_14 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_18[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_7 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block4_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_14[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_15 (TFO  (None, 256, 10, 32)  0          ['lambda_7[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_19 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_15[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block3_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block4_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_19[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block4_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block4_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block4_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block4_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block4_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block4_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_15 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block4_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_15 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_15[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block4_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_15[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block4_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block4_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block4_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block4_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block4_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block4_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block4_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block5_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block5_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_20 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block5_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_4 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_20[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_21 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][0]']             
                                                                                                  
 tf.reshape_22 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_16 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_21[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_17 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_22[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_8 (Lambda)              (None, 10, 256, 256  0           ['tf.compat.v1.transpose_16[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_17[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_4 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_8[0][0]']               
 )                              )                                                                 
                                                                                                  
 tf.reshape_23 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_4[0][2]']             
                                                                                                  
 stack3_block5_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_4[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_18 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_23[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_9 (Lambda)              (None, 10, 256, 32)  0           ['stack3_block5_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_18[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_19 (TFO  (None, 256, 10, 32)  0          ['lambda_9[0][0]']               
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_24 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_19[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block4_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block5_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_24[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block5_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block5_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block5_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block5_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block5_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block5_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_16 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block5_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_16 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_16[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block5_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_16[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block5_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block5_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block5_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block5_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block5_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block5_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block5_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block6_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block6_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_25 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block6_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_5 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_25[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_26 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][0]']             
                                                                                                  
 tf.reshape_27 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_20 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_26[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_21 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_27[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_10 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_20[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_21[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_5 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_10[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_28 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_5[0][2]']             
                                                                                                  
 stack3_block6_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_5[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_22 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_28[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_11 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block6_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_22[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_23 (TFO  (None, 256, 10, 32)  0          ['lambda_11[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_29 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_23[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block5_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block6_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_29[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block6_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block6_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block6_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block6_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block6_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block6_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_17 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block6_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_17 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_17[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block6_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_17[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block6_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block6_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block6_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block6_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block6_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block6_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block6_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block7_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block7_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_30 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block7_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_6 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_30[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_31 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][0]']             
                                                                                                  
 tf.reshape_32 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_24 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_31[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_25 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_32[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_12 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_24[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_25[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_6 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_12[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_33 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_6[0][2]']             
                                                                                                  
 stack3_block7_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_6[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_26 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_33[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_13 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block7_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_26[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_27 (TFO  (None, 256, 10, 32)  0          ['lambda_13[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_34 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_27[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block6_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block7_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_34[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block7_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block7_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block7_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block7_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block7_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block7_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_18 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block7_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_18 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_18[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block7_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_18[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block7_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block7_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block7_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block7_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block7_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block7_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block7_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block8_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block8_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_35 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block8_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_7 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_35[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_36 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][0]']             
                                                                                                  
 tf.reshape_37 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_28 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_36[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_29 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_37[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_14 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_28[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_29[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_7 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_14[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_38 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_7[0][2]']             
                                                                                                  
 stack3_block8_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_7[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_30 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_38[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_15 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block8_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_30[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_31 (TFO  (None, 256, 10, 32)  0          ['lambda_15[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_39 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_31[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block7_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block8_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_39[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block8_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block8_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block8_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block8_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block8_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block8_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_19 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block8_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_19 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_19[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block8_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_19[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block8_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block8_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block8_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block8_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block8_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block8_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block8_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_ln (LayerNo  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack3_block9_mhsa_qkv (Dense)  (None, 16, 16, 960)  307200     ['stack3_block9_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_40 (TFOpLambda)     (None, 256, 960)     0           ['stack3_block9_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_8 (TFOpLambda)        [(None, 256, 320),   0           ['tf.reshape_40[0][0]']          
                                 (None, 256, 320),                                                
                                 (None, 256, 320)]                                                
                                                                                                  
 tf.reshape_41 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][0]']             
                                                                                                  
 tf.reshape_42 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_32 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_41[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_33 (TFO  (None, 10, 32, 256)  0          ['tf.reshape_42[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_16 (Lambda)             (None, 10, 256, 256  0           ['tf.compat.v1.transpose_32[0][0]
                                )                                ',                               
                                                                  'tf.compat.v1.transpose_33[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_8 (TFOpLambda  (None, 10, 256, 256  0          ['lambda_16[0][0]']              
 )                              )                                                                 
                                                                                                  
 tf.reshape_43 (TFOpLambda)     (None, 256, 10, 32)  0           ['tf.split_8[0][2]']             
                                                                                                  
 stack3_block9_mhsa_attention_s  (None, 10, 256, 256  0          ['tf.math.multiply_8[0][0]']     
 cores (Softmax)                )                                                                 
                                                                                                  
 tf.compat.v1.transpose_34 (TFO  (None, 10, 256, 32)  0          ['tf.reshape_43[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_17 (Lambda)             (None, 10, 256, 32)  0           ['stack3_block9_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_34[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_35 (TFO  (None, 256, 10, 32)  0          ['lambda_17[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_44 (TFOpLambda)     (None, 16, 16, 320)  0           ['tf.compat.v1.transpose_35[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_attn_res_gamma (  (None, 16, 16, 320)  320        ['stack3_block8_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack3_block9_mhsa_output (Den  (None, 16, 16, 320)  102400     ['tf.reshape_44[0][0]']          
 se)                                                                                              
                                                                                                  
 stack3_block9_attn_output (Add  (None, 16, 16, 320)  0          ['stack3_block9_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack3_block9_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack3_block9_mlp_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack3_block9_mlp_Dense_0 (Den  (None, 16, 16, 1280  409600     ['stack3_block9_mlp_ln[0][0]']   
 se)                            )                                                                 
                                                                                                  
 tf.nn.relu_20 (TFOpLambda)     (None, 16, 16, 1280  0           ['stack3_block9_mlp_Dense_0[0][0]
                                )                                ']                               
                                                                                                  
 tf.math.pow_20 (TFOpLambda)    (None, 16, 16, 1280  0           ['tf.nn.relu_20[0][0]']          
                                )                                                                 
                                                                                                  
 stack3_block9_mlp_star_relu (Z  (None, 16, 16, 1280  2          ['tf.math.pow_20[0][0]']         
 eroInitGain)                   )                                                                 
                                                                                                  
 stack3_block9_mlp_res_gamma (C  (None, 16, 16, 320)  320        ['stack3_block9_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack3_block9_mlp_Dense_1 (Den  (None, 16, 16, 320)  409600     ['stack3_block9_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack3_block9_mlp_output (Add)  (None, 16, 16, 320)  0          ['stack3_block9_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_downsample_ln (LayerNor  (None, 16, 16, 320)  320        ['stack3_block9_mlp_output[0][0]'
 malization)                                                     ]                                
                                                                                                  
 stack4_downsample_pad (ZeroPad  (None, 18, 18, 320)  0          ['stack4_downsample_ln[0][0]']   
 ding2D)                                                                                          
                                                                                                  
 stack4_downsample_conv (Conv2D  (None, 8, 8, 512)   1475072     ['stack4_downsample_pad[0][0]']  
 )                                                                                                
                                                                                                  
 stack4_block1_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 rmalization)                                                                                     
                                                                                                  
 stack4_block1_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block1_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_45 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block1_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_9 (TFOpLambda)        [(None, 64, 512),    0           ['tf.reshape_45[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_46 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][0]']             
                                                                                                  
 tf.reshape_47 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][1]']             
                                                                                                  
 tf.compat.v1.transpose_36 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_46[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_37 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_47[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_18 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_36[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_37[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_9 (TFOpLambda  (None, 16, 64, 64)  0           ['lambda_18[0][0]']              
 )                                                                                                
                                                                                                  
 tf.reshape_48 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_9[0][2]']             
                                                                                                  
 stack4_block1_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_9[0][0]']     
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_38 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_48[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_19 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block1_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_38[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_39 (TFO  (None, 64, 16, 32)  0           ['lambda_19[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_49 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_39[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_downsample_conv[0][0]'] 
 ChannelAffine)                                                                                   
                                                                                                  
 stack4_block1_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_49[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block1_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block1_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block1_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block1_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block1_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block1_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_21 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block1_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_21 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_21[0][0]']          
                                                                                                  
 stack4_block1_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_21[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block1_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block1_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block1_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block1_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block1_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block1_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block1_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block2_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block2_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_50 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block2_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_10 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_50[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_51 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][0]']            
                                                                                                  
 tf.reshape_52 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_40 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_51[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_41 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_52[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_20 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_40[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_41[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_10 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_20[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_53 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_10[0][2]']            
                                                                                                  
 stack4_block2_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_10[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_42 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_53[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_21 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block2_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_42[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_43 (TFO  (None, 64, 16, 32)  0           ['lambda_21[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_54 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_43[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block1_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block2_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_54[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block2_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block2_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block2_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block2_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block2_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block2_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_22 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block2_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_22 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_22[0][0]']          
                                                                                                  
 stack4_block2_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_22[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 stack4_block2_mlp_res_gamma (C  (None, 8, 8, 512)   512         ['stack4_block2_attn_output[0][0]
 hannelAffine)                                                   ']                               
                                                                                                  
 stack4_block2_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block2_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 stack4_block2_mlp_output (Add)  (None, 8, 8, 512)   0           ['stack4_block2_mlp_res_gamma[0][
                                                                 0]',                             
                                                                  'stack4_block2_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_ln (LayerNo  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 rmalization)                                                    ]                                
                                                                                                  
 stack4_block3_mhsa_qkv (Dense)  (None, 8, 8, 1536)  786432      ['stack4_block3_attn_ln[0][0]']  
                                                                                                  
 tf.reshape_55 (TFOpLambda)     (None, 64, 1536)     0           ['stack4_block3_mhsa_qkv[0][0]'] 
                                                                                                  
 tf.split_11 (TFOpLambda)       [(None, 64, 512),    0           ['tf.reshape_55[0][0]']          
                                 (None, 64, 512),                                                 
                                 (None, 64, 512)]                                                 
                                                                                                  
 tf.reshape_56 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][0]']            
                                                                                                  
 tf.reshape_57 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][1]']            
                                                                                                  
 tf.compat.v1.transpose_44 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_56[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 tf.compat.v1.transpose_45 (TFO  (None, 16, 32, 64)  0           ['tf.reshape_57[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_22 (Lambda)             (None, 16, 64, 64)   0           ['tf.compat.v1.transpose_44[0][0]
                                                                 ',                               
                                                                  'tf.compat.v1.transpose_45[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.multiply_11 (TFOpLambd  (None, 16, 64, 64)  0           ['lambda_22[0][0]']              
 a)                                                                                               
                                                                                                  
 tf.reshape_58 (TFOpLambda)     (None, 64, 16, 32)   0           ['tf.split_11[0][2]']            
                                                                                                  
 stack4_block3_mhsa_attention_s  (None, 16, 64, 64)  0           ['tf.math.multiply_11[0][0]']    
 cores (Softmax)                                                                                  
                                                                                                  
 tf.compat.v1.transpose_46 (TFO  (None, 16, 64, 32)  0           ['tf.reshape_58[0][0]']          
 pLambda)                                                                                         
                                                                                                  
 lambda_23 (Lambda)             (None, 16, 64, 32)   0           ['stack4_block3_mhsa_attention_sc
                                                                 ores[0][0]',                     
                                                                  'tf.compat.v1.transpose_46[0][0]
                                                                 ']                               
                                                                                                  
 tf.compat.v1.transpose_47 (TFO  (None, 64, 16, 32)  0           ['lambda_23[0][0]']              
 pLambda)                                                                                         
                                                                                                  
 tf.reshape_59 (TFOpLambda)     (None, 8, 8, 512)    0           ['tf.compat.v1.transpose_47[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_attn_res_gamma (  (None, 8, 8, 512)   512         ['stack4_block2_mlp_output[0][0]'
 ChannelAffine)                                                  ]                                
                                                                                                  
 stack4_block3_mhsa_output (Den  (None, 8, 8, 512)   262144      ['tf.reshape_59[0][0]']          
 se)                                                                                              
                                                                                                  
 stack4_block3_attn_output (Add  (None, 8, 8, 512)   0           ['stack4_block3_attn_res_gamma[0]
 )                                                               [0]',                            
                                                                  'stack4_block3_mhsa_output[0][0]
                                                                 ']                               
                                                                                                  
 stack4_block3_mlp_ln (LayerNor  (None, 8, 8, 512)   512         ['stack4_block3_attn_output[0][0]
 malization)                                                     ']                               
                                                                                                  
 stack4_block3_mlp_Dense_0 (Den  (None, 8, 8, 2048)  1048576     ['stack4_block3_mlp_ln[0][0]']   
 se)                                                                                              
                                                                                                  
 tf.nn.relu_23 (TFOpLambda)     (None, 8, 8, 2048)   0           ['stack4_block3_mlp_Dense_0[0][0]
                                                                 ']                               
                                                                                                  
 tf.math.pow_23 (TFOpLambda)    (None, 8, 8, 2048)   0           ['tf.nn.relu_23[0][0]']          
                                                                                                  
 stack4_block3_mlp_star_relu (Z  (None, 8, 8, 2048)  2           ['tf.math.pow_23[0][0]']         
 eroInitGain)                                                                                     
                                                                                                  
 layer_normalization (LayerNorm  (None, 16, 16, 320)  640        ['stack3_block9_mlp_Dense_1[0][0]
 alization)                                                      ']                               
                                                                                                  
 stack4_block3_mlp_Dense_1 (Den  (None, 8, 8, 512)   1048576     ['stack4_block3_mlp_star_relu[0][
 se)                                                             0]']                             
                                                                                                  
 separable_conv2d (SeparableCon  (None, 16, 16, 320)  105600     ['layer_normalization[0][0]']    
 v2D)                                                                                             
                                                                                                  
 conv2d_4 (Conv2D)              (None, 8, 8, 320)    163840      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_5 (Conv2D)              (None, 8, 8, 320)    1474560     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 attention (Attention)          (None, 16, 16, 320)  0           ['separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]',       
                                                                  'separable_conv2d[0][0]']       
                                                                                                  
 add_2 (Add)                    (None, 8, 8, 320)    0           ['conv2d_4[0][0]',               
                                                                  'conv2d_5[0][0]']               
                                                                                                  
 add_4 (Add)                    (None, 16, 16, 320)  0           ['attention[0][0]',              
                                                                  'stack3_block9_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_1 (UpSampling2D)  (None, 16, 16, 320)  0          ['add_2[0][0]']                  
                                                                                                  
 dense (Dense)                  (None, 16, 16, 320)  102720      ['add_4[0][0]']                  
                                                                                                  
 batch_normalization_1 (BatchNo  (None, 16, 16, 320)  1280       ['up_sampling2d_1[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_1 (Dense)                (None, 16, 16, 320)  102720      ['dense[0][0]']                  
                                                                                                  
 activation_1 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_1[0][0]']  
                                                                                                  
 add_5 (Add)                    (None, 16, 16, 320)  0           ['add_4[0][0]',                  
                                                                  'dense_1[0][0]']                
                                                                                                  
 add_6 (Add)                    (None, 16, 16, 320)  0           ['activation_1[0][0]',           
                                                                  'add_5[0][0]']                  
                                                                                                  
 conv2d_8 (Conv2D)              (None, 16, 16, 320)  102720      ['add_6[0][0]']                  
                                                                                                  
 batch_normalization_2 (BatchNo  (None, 16, 16, 320)  1280       ['conv2d_8[0][0]']               
 rmalization)                                                                                     
                                                                                                  
 activation_2 (Activation)      (None, 16, 16, 320)  0           ['batch_normalization_2[0][0]']  
                                                                                                  
 conv2d (Conv2D)                (None, 8, 8, 512)    262144      ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_1 (Conv2D)              (None, 8, 8, 512)    2359296     ['stack4_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 conv2d_9 (Conv2D)              (None, 16, 16, 128)  40960       ['activation_2[0][0]']           
                                                                                                  
 conv2d_10 (Conv2D)             (None, 16, 16, 128)  368640      ['activation_2[0][0]']           
                                                                                                  
 add (Add)                      (None, 8, 8, 512)    0           ['conv2d[0][0]',                 
                                                                  'conv2d_1[0][0]']               
                                                                                                  
 layer_normalization_1 (LayerNo  (None, 32, 32, 128)  256        ['stack2_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 add_7 (Add)                    (None, 16, 16, 128)  0           ['conv2d_9[0][0]',               
                                                                  'conv2d_10[0][0]']              
                                                                                                  
 up_sampling2d (UpSampling2D)   (None, 32, 32, 512)  0           ['add[0][0]']                    
                                                                                                  
 separable_conv2d_1 (SeparableC  (None, 32, 32, 128)  17664      ['layer_normalization_1[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 up_sampling2d_2 (UpSampling2D)  (None, 32, 32, 128)  0          ['add_7[0][0]']                  
                                                                                                  
 batch_normalization (BatchNorm  (None, 32, 32, 512)  2048       ['up_sampling2d[0][0]']          
 alization)                                                                                       
                                                                                                  
 attention_1 (Attention)        (None, 32, 32, 128)  0           ['separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]',     
                                                                  'separable_conv2d_1[0][0]']     
                                                                                                  
 batch_normalization_3 (BatchNo  (None, 32, 32, 128)  512        ['up_sampling2d_2[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 activation (Activation)        (None, 32, 32, 512)  0           ['batch_normalization[0][0]']    
                                                                                                  
 add_9 (Add)                    (None, 32, 32, 128)  0           ['attention_1[0][0]',            
                                                                  'stack2_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 activation_3 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_3[0][0]']  
                                                                                                  
 conv2d_13 (Conv2D)             (None, 32, 32, 128)  65664       ['activation[0][0]']             
                                                                                                  
 dense_2 (Dense)                (None, 32, 32, 128)  16512       ['add_9[0][0]']                  
                                                                                                  
 add_11 (Add)                   (None, 32, 32, 128)  0           ['activation_3[0][0]',           
                                                                  'conv2d_13[0][0]']              
                                                                                                  
 dense_3 (Dense)                (None, 32, 32, 128)  16512       ['dense_2[0][0]']                
                                                                                                  
 conv2d_14 (Conv2D)             (None, 32, 32, 128)  16512       ['add_11[0][0]']                 
                                                                                                  
 add_10 (Add)                   (None, 32, 32, 128)  0           ['add_9[0][0]',                  
                                                                  'dense_3[0][0]']                
                                                                                                  
 add_12 (Add)                   (None, 32, 32, 128)  0           ['conv2d_14[0][0]',              
                                                                  'add_10[0][0]']                 
                                                                                                  
 conv2d_15 (Conv2D)             (None, 32, 32, 128)  16512       ['add_12[0][0]']                 
                                                                                                  
 batch_normalization_4 (BatchNo  (None, 32, 32, 128)  512        ['conv2d_15[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 layer_normalization_2 (LayerNo  (None, 64, 64, 64)  128         ['stack1_block3_mlp_Dense_1[0][0]
 rmalization)                                                    ']                               
                                                                                                  
 activation_4 (Activation)      (None, 32, 32, 128)  0           ['batch_normalization_4[0][0]']  
                                                                                                  
 separable_conv2d_2 (SeparableC  (None, 64, 64, 64)  4736        ['layer_normalization_2[0][0]']  
 onv2D)                                                                                           
                                                                                                  
 conv2d_20 (Conv2D)             (None, 32, 32, 64)   8192        ['activation_4[0][0]']           
                                                                                                  
 conv2d_21 (Conv2D)             (None, 32, 32, 64)   73728       ['activation_4[0][0]']           
                                                                                                  
 attention_2 (Attention)        (None, 64, 64, 64)   0           ['separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]',     
                                                                  'separable_conv2d_2[0][0]']     
                                                                                                  
 add_15 (Add)                   (None, 32, 32, 64)   0           ['conv2d_20[0][0]',              
                                                                  'conv2d_21[0][0]']              
                                                                                                  
 add_17 (Add)                   (None, 64, 64, 64)   0           ['attention_2[0][0]',            
                                                                  'stack1_block3_mlp_Dense_1[0][0]
                                                                 ']                               
                                                                                                  
 up_sampling2d_4 (UpSampling2D)  (None, 64, 64, 64)  0           ['add_15[0][0]']                 
                                                                                                  
 dense_4 (Dense)                (None, 64, 64, 64)   4160        ['add_17[0][0]']                 
                                                                                                  
 batch_normalization_6 (BatchNo  (None, 64, 64, 64)  256         ['up_sampling2d_4[0][0]']        
 rmalization)                                                                                     
                                                                                                  
 dense_5 (Dense)                (None, 64, 64, 64)   4160        ['dense_4[0][0]']                
                                                                                                  
 activation_6 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_6[0][0]']  
                                                                                                  
 add_18 (Add)                   (None, 64, 64, 64)   0           ['add_17[0][0]',                 
                                                                  'dense_5[0][0]']                
                                                                                                  
 add_19 (Add)                   (None, 64, 64, 64)   0           ['activation_6[0][0]',           
                                                                  'add_18[0][0]']                 
                                                                                                  
 conv2d_24 (Conv2D)             (None, 64, 64, 64)   4160        ['add_19[0][0]']                 
                                                                                                  
 conv2d_16 (Conv2D)             (None, 32, 32, 128)  16384       ['activation_4[0][0]']           
                                                                                                  
 conv2d_17 (Conv2D)             (None, 32, 32, 128)  147456      ['activation_4[0][0]']           
                                                                                                  
 batch_normalization_7 (BatchNo  (None, 64, 64, 64)  256         ['conv2d_24[0][0]']              
 rmalization)                                                                                     
                                                                                                  
 add_13 (Add)                   (None, 32, 32, 128)  0           ['conv2d_16[0][0]',              
                                                                  'conv2d_17[0][0]']              
                                                                                                  
 activation_7 (Activation)      (None, 64, 64, 64)   0           ['batch_normalization_7[0][0]']  
                                                                                                  
 up_sampling2d_3 (UpSampling2D)  (None, 256, 256, 12  0          ['add_13[0][0]']                 
                                8)                                                                
                                                                                                  
 conv2d_26 (Conv2D)             (None, 64, 64, 32)   2048        ['activation_7[0][0]']           
                                                                                                  
 conv2d_27 (Conv2D)             (None, 64, 64, 32)   18432       ['activation_7[0][0]']           
                                                                                                  
 batch_normalization_5 (BatchNo  (None, 256, 256, 12  512        ['up_sampling2d_3[0][0]']        
 rmalization)                   8)                                                                
                                                                                                  
 add_20 (Add)                   (None, 64, 64, 32)   0           ['conv2d_26[0][0]',              
                                                                  'conv2d_27[0][0]']              
                                                                                                  
 activation_5 (Activation)      (None, 256, 256, 12  0           ['batch_normalization_5[0][0]']  
                                8)                                                                
                                                                                                  
 up_sampling2d_5 (UpSampling2D)  (None, 256, 256, 32  0          ['add_20[0][0]']                 
                                )                                                                 
                                                                                                  
 conv2d_25 (Conv2D)             (None, 256, 256, 32  4128        ['activation_5[0][0]']           
                                )                                                                 
                                                                                                  
 batch_normalization_9 (BatchNo  (None, 256, 256, 32  128        ['up_sampling2d_5[0][0]']        
 rmalization)                   )                                                                 
                                                                                                  
 batch_normalization_8 (BatchNo  (None, 256, 256, 32  128        ['conv2d_25[0][0]']              
 rmalization)                   )                                                                 
                                                                                                  
 activation_9 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_9[0][0]']  
                                )                                                                 
                                                                                                  
 activation_8 (Activation)      (None, 256, 256, 32  0           ['batch_normalization_8[0][0]']  
                                )                                                                 
                                                                                                  
 add_22 (Add)                   (None, 256, 256, 32  0           ['activation_9[0][0]',           
                                )                                 'activation_8[0][0]']           
                                                                                                  
 conv2d_30 (Conv2D)             (None, 256, 256, 32  1056        ['add_22[0][0]']                 
                                )                                                                 
                                                                                                  
 batch_normalization_10 (BatchN  (None, 256, 256, 32  128        ['conv2d_30[0][0]']              
 ormalization)                  )                                                                 
                                                                                                  
 activation_10 (Activation)     (None, 256, 256, 32  0           ['batch_normalization_10[0][0]'] 
                                )                                                                 
                                                                                                  
 conv2d_31 (Conv2D)             (None, 256, 256, 1)  33          ['activation_10[0][0]']          
                                                                                                  
==================================================================================================
Total params: 28,765,713
Trainable params: 28,762,193
Non-trainable params: 3,520
__________________________________________________________________________________________________
